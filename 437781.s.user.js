// ==UserScript==
// @name         [ECUST 旧版修复] 🥇超星/学习通网课小助手|修复视频播放|自动跳转任务点|章测字体解密|自动答题|题库覆盖率高|逐渐支持更多平台
// @namespace    noshuang
// @version      4.3.1.1
// @author       noshuang
// @description  🏆 支持【超星/学习通】【知到/智慧树】平台 ✅视频自动观看，跳转下一个任务点✅章节测试自动完成，无答案保存✅作业自动完成✅考试自动完成，自动保存✅智慧树答题已经开发完成（视频正在开发）
// @license      MIT
// @icon         https://vitejs.dev/logo.svg
// @match        *://*.chaoxing.com/*
// @match        *://*.edu.cn/*
// @match        *://*.nbdlib.cn/*
// @match         *://*.hnsyu.net/*
// @match        *://*.gdhkmooc.com/*
// @match        *://*.zhihuishu.com/*
// @require      https://cdn.bootcdn.net/ajax/libs/vue/3.2.36/vue.global.prod.js
// @require      https://cdn.bootcdn.net/ajax/libs/vue-demi/0.14.0/index.iife.js
// @require      data:application/javascript,window.Vue%3DVue%3B
// @require      https://cdn.bootcdn.net/ajax/libs/element-plus/2.3.4/index.full.min.js
// @require      https://cdn.bootcdn.net/ajax/libs/pinia/2.0.35/pinia.iife.min.js
// @require      https://cdn.bootcdn.net/ajax/libs/rxjs/7.8.0/rxjs.umd.min.js
// @require      https://cdn.bootcdn.net/ajax/libs/blueimp-md5/2.19.0/js/md5.min.js
// @resource     ElementPlus  https://cdn.bootcdn.net/ajax/libs/element-plus/2.3.4/index.css
// @resource     ttf          https://www.forestpolice.org/ttf/2.0/table.json
// @connect      api.tikuhai.com
// @connect      cx.icodef.com
// @grant        GM_getResourceText
// @grant        GM_info
// @grant        GM_xmlhttpRequest
// @grant        unsafeWindow
// @run-at       document-start
// @antifeature  ads      公众号或者app辅助答题
// @antifeature  payment  付费答题
// ==/UserScript==

(e=>{let t=document.createElement("style");t.dataset.source="vite-plugin-monkey",t.textContent=e,document.head.append(t)})(" .log[data-v-d41d5897]{el-text[data-v-d41d5897] {white-space: normal;}}.setting[data-v-4489784f]{margin-top:-8px;font-size:14px}.setting[data-v-4489784f] .el-form-item[data-v-4489784f]{margin-bottom:0}.question_table[data-v-18523ca7]{width:625px}.demo-tabs[data-v-7ebed5db]{margin-right:10px}.main-page[data-v-9997d2af]{z-index:1000;position:fixed}.main-page .overlay[data-v-9997d2af]{position:fixed;top:0;left:0;right:0;bottom:0;z-index:1001}.main-page .el-card .card-header[data-v-9997d2af]{display:flex;justify-content:space-between;flex-direction:row;align-items:center;margin:0;padding:0;cursor:move}.main-page .el-card .card-header .title[data-v-9997d2af]{font-size:14px;display:flex;align-items:center;justify-content:center;font-weight:500}.main-page[data-v-9997d2af] .el-card__header{background-color:#1f71e0;color:#fff;padding:7px 10px 7px 16px;margin:0}.main-page[data-v-9997d2af] .el-card__body{padding:0 6px 20px 16px}.main-page[data-v-9997d2af] .el-tabs__nav-wrap:after{height:1px}.main-page[data-v-9997d2af] .el-tabs__active-bar{background-color:#176ae5}.main-page[data-v-9997d2af] .el-tabs__item{font-size:13px;height:34px}.main-page[data-v-9997d2af] .el-tabs__item.is-top{font-weight:400;color:#4e5969;padding:0 8px 0 12px}.main-page[data-v-9997d2af] .el-tabs__item.is-active{font-weight:500;color:#176ae5;padding:0 8px 0 12px}.content[data-v-9997d2af]{width:370px} "),((e,t,r,n,l)=>{let a=()=>{let e=document.createElement("script");e.textContent='window.addEventListener("mouseout",t=>{t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()},!0);',document.head.appendChild(e),e.remove()};function o(){let e=document.querySelectorAll(".currents");for(let t=0;t<e.length;t++)if(e[t].querySelector(".roundpointStudent.blue")||e[t].querySelector(".roundpoint.blue")){goback();break}}function i(){let e=document.querySelectorAll("h3"),t=null;for(let r=0;r<e.length;r++)if(e[r].querySelector("em.orange, em.blank")){t=e[r];break}if(t){let n=t.querySelector("a");n&&n.click()}}a(),setInterval(o,1e3),setInterval(i,1e3);let s=Object.defineProperty,u=(e,t,r)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,d=(e,t,r)=>(u(e,"symbol"!=typeof t?`${t}`:t,r),r),c=(e,t)=>{let r=e.__vccOpts||e;for(let[n,l]of t)r[n]=l;return r},h={name:"DocumentRemove"},f={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},p=e.createElementVNode("path",{fill:"currentColor",d:"M805.504 320 640 154.496V320h165.504zM832 384H576V128H192v768h640V384zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32zm192 512h320v64H352v-64z"},null,-1),$=[p];function m(t,r,n,l,a,o){return e.openBlock(),e.createElementBlock("svg",f,$)}let _=c(h,[["render",m],["__file","document-remove.vue"]]),g={name:"FullScreen"},v={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},y=e.createElementVNode("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64v.064zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64l-192 .192zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64v-.064z"},null,-1),b=[y];function S(t,r,n,l,a,o){return e.openBlock(),e.createElementBlock("svg",v,b)}let U=c(g,[["render",S],["__file","full-screen.vue"]]),w={name:"Minus"},x={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},C=e.createElementVNode("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64z"},null,-1),k=[C];function F(t,r,n,l,a,o){return e.openBlock(),e.createElementBlock("svg",x,k)}let P=c(w,[["render",F],["__file","minus.vue"]]),L={name:"Position"},T={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},B=e.createElementVNode("path",{fill:"currentColor",d:"m249.6 417.088 319.744 43.072 39.168 310.272L845.12 178.88 249.6 417.088zm-129.024 47.168a32 32 0 0 1-7.68-61.44l777.792-311.04a32 32 0 0 1 41.6 41.6l-310.336 775.68a32 32 0 0 1-61.44-7.808L512 516.992l-391.424-52.736z"},null,-1),V=[B];function I(t,r,n,l,a,o){return e.openBlock(),e.createElementBlock("svg",T,V)}let E=c(L,[["render",I],["__file","position.vue"]]),N={name:"Setting"},A={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},G=e.createElementVNode("path",{fill:"currentColor",d:"M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36-116.224-25.088-65.28 113.152 79.68 88.192-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136-79.808 88.192 65.344 113.152 116.224-25.024 22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152 24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296 116.288 25.024 65.28-113.152-79.744-88.192 1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136 79.808-88.128-65.344-113.152-116.288 24.96-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384 192 192 0 0 1 0-384zm0 64a128 128 0 1 0 0 256 128 128 0 0 0 0-256z"},null,-1),z=[G];function O(t,r,n,l,a,o){return e.openBlock(),e.createElementBlock("svg",A,z)}let D=c(N,[["render",O],["__file","setting.vue"]]),q={name:"View"},M={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},H=e.createElementVNode("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352zm0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448zm0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160z"},null,-1),R=[H];function j(t,r,n,l,a,o){return e.openBlock(),e.createElementBlock("svg",M,R)}let W=c(q,[["render",j],["__file","view.vue"]]),Q={name:"Warning"},X={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},J=e.createElementVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 832a384 384 0 0 0 0-768 384 384 0 0 0 0 768zm48-176a48 48 0 1 1-96 0 48 48 0 0 1 96 0zm-48-464a32 32 0 0 1 32 32v288a32 32 0 0 1-64 0V288a32 32 0 0 1 32-32z"},null,-1),K=[J];function Y(t,r,n,l,a,o){return e.openBlock(),e.createElementBlock("svg",X,K)}let Z=c(Q,[["render",Y],["__file","warning.vue"]]),ee="undefined"!=typeof GM_getResourceText?GM_getResourceText:void 0,et="undefined"!=typeof GM_info?GM_info:void 0,er="undefined"!=typeof GM_xmlhttpRequest?GM_xmlhttpRequest:void 0,en="undefined"!=typeof unsafeWindow?unsafeWindow:void 0,el=()=>({name:et.script.name,namespace:et.script.namespace,version:et.script.version,description:et.script.description}),ea=t.defineStore("configStore",{state(){let e=el(),t={version:e.version,isMinus:!1,position:{x:"800px",y:"200px"},menuIndex:"0",platformName:"cx",platformParams:{cx:{name:"超星网课助手",parts:[{name:"章节设置",params:[{name:"章节作业自动提交",value:!0,type:"boolean"},{name:"是否自动下一章节",value:!0,type:"boolean"},{name:"只答题，不做其他",value:!1,type:"boolean"}]},{name:"考试设置",params:[{name:"是否自动切换",value:!0,type:"boolean"}]}]},zhs:{name:"智慧树网课助手",parts:[{name:"答题设置",params:[{name:"是否自动切换",value:!0,type:"boolean"}]}]},unknown:{name:"未知平台",parts:[{name:"答题设置",params:[{name:"是否自动切换",value:!0,type:"boolean"}]}]}},otherParams:{name:"其他参数",params:[{name:"切换、答题间隔，单位秒",value:3,type:"number"},{name:"正确率达到多少自动提交",value:85,type:"number"}]},queryApis:[{name:"海量题库",token:"",url:"http://api.tikuhai.com"}]},r=t,n=localStorage.getItem("config");if(n)try{let l=JSON.parse(n);e.version===l.version&&(r=l)}catch(a){console.error(a)}return localStorage.setItem("globalConfig",JSON.stringify(r)),r},actions:{}}),eo=e=>{e.getFullYear(),e.getMonth(),e.getDate();let t=e.getHours(),r;return`${ei(t)}:${ei(e.getMinutes())}:${ei(e.getSeconds())}`},ei=e=>e<10?`0${e}`:e.toString(),es=()=>{let e=new Date;return eo(e)},eu=t.defineStore("logStore",{state:()=>({logList:[]}),actions:{addLog(e,t){let r={message:e,time:es(),type:t};this.logList.push(r)}}}),ed=t.defineStore("questionStore",{state:()=>({questionList:[]}),actions:{addQuestion(e){this.questionList.push(e)},clearQuestion(){this.questionList=[]}}}),ec=e.createTextVNode(" "),eh=e.defineComponent({name:"index",props:{logList:{type:Array,required:!0}},setup:({logList:t})=>(r,n)=>{let l=e.resolveComponent("el-text"),a=e.resolveComponent("el-divider"),o=e.resolveComponent("el-scrollbar");return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(o,{always:"",class:"log","max-height":"230px"},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t,({time:t,type:r,message:n},o)=>(e.openBlock(),e.createElementBlock("div",{key:o},[e.createVNode(l,{size:"small",style:{"font-weight":"normal"},type:"info"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t),1)]),_:2},1024),e.createVNode(l,null,{default:e.withCtx(()=>[ec]),_:1}),e.createVNode(l,{type:r||"primary",size:"small",innerHTML:n},null,8,["type","innerHTML"]),e.createVNode(a,{"border-style":"dashed",style:{margin:"0"}})]))),128))]),_:1})])}}),ef=(e,t)=>{let r=e.__vccOpts||e;for(let[n,l]of t)r[n]=l;return r},ep=ef(eh,[["__scopeId","data-v-d41d5897"]]),e$={class:"setting"},e0={style:{"font-size":"13px"}},em={style:{"font-size":"13px"}},e_=e.defineComponent({name:"index",props:{globalConfig:{type:Object,required:!0}},setup:({globalConfig:t})=>(r,n)=>{let l=e.resolveComponent("el-divider"),a=e.resolveComponent("el-checkbox"),o=e.resolveComponent("el-input-number"),i=e.resolveComponent("el-form-item");return e.openBlock(),e.createElementBlock("div",e$,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.platformParams[t.platformName].parts,({name:t,params:r},n)=>(e.openBlock(),e.createElementBlock("div",{key:n},[e.createVNode(l,{"border-style":"dashed"},{default:e.withCtx(()=>[e.createElementVNode("span",e0,e.toDisplayString(t),1)]),_:2},1024),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r,(t,r)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,["boolean"===t.type?(e.openBlock(),e.createBlock(a,{style:{"margin-bottom":"6px"},key:r,modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,label:t.name,size:"small"},null,8,["modelValue","onUpdate:modelValue","label"])):(e.openBlock(),e.createBlock(i,{key:1,label:t.name,required:""},{default:e.withCtx(()=>[e.createVNode(o,{modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,min:3e3,step:1e3,"controls-position":"right",size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]))],64))),256))]))),128)),e.createElementVNode("div",null,[e.createVNode(l,{"border-style":"dashed"},{default:e.withCtx(()=>[e.createElementVNode("span",em,e.toDisplayString(t.otherParams.name),1)]),_:1}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.otherParams.params,(t,r)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:r},["boolean"===t.type?(e.openBlock(),e.createBlock(a,{key:0,modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,size:"small"},null,8,["modelValue","onUpdate:modelValue"])):(e.openBlock(),e.createBlock(i,{key:1,style:{"margin-top":"6px"},label:t.name,required:"",size:"small"},{default:e.withCtx(()=>[e.createVNode(o,{modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,min:3,max:100,step:1,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]))],64))),128))])])}}),eg=ef(e_,[["__scopeId","data-v-4489784f"]]),ev=e.createTextVNode("密钥"),ey={class:"question_table"},eb=["innerHTML"],e2=e.defineComponent({name:"QuestionTable",props:{questionList:{type:Array,required:!0}},setup({questionList:t}){let r=ea();return(n,l)=>{let a=e.resolveComponent("el-button"),o=e.resolveComponent("el-input"),i=e.resolveComponent("el-table-column"),s=e.resolveComponent("el-table"),u=e.resolveComponent("el-empty");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(o,{style:{"font-size":"12px"},modelValue:e.unref(r).queryApis[0].token,"onUpdate:modelValue":l[0]||(l[0]=t=>e.unref(r).queryApis[0].token=t),placeholder:"获取的密钥的密钥填到这里即可，题库问题与脚本无关，确定能搜到再获取"},{prepend:e.withCtx(()=>[e.createVNode(a,{style:{"border-radius":"0"}},{default:e.withCtx(()=>[ev]),_:1})]),_:1},8,["modelValue"]),e.withDirectives(e.createElementVNode("div",ey,[e.createVNode(s,{stripe:"",data:t,"max-height":"400",style:{"font-size":"12px"}},{default:e.withCtx(()=>[e.createVNode(i,{type:"index",width:"40"}),e.createVNode(i,{prop:"title",label:"题目",width:"370"}),e.createVNode(i,{style:{"background-color":"red"},prop:"answer",label:"答案",width:"215"},{default:e.withCtx(({row:t})=>[e.createElementVNode("div",{innerHTML:t.answer.join()},null,8,eb)]),_:1})]),_:1},8,["data"])],512),[[e.vShow,t.length]]),e.withDirectives(e.createElementVNode("div",null,[e.createVNode(u,{description:"该页面无需答题"})],512),[[e.vShow,!t.length]])],64)}}}),eS=ef(e2,[["__scopeId","data-v-18523ca7"]]),eU={},e1={style:{"font-size":"12px"}},ew=e.createTextVNode(" 开源地址："),ex=e.createElementVNode("a",null,"点击查看",-1),e8=[ew,ex];function e4(t,r){return e.openBlock(),e.createElementBlock("div",e1,e8)}let e6=ef(eU,[["render",e4]]),eC={},ek=e.createElementVNode("p",null,"1、本脚本仅供学习和研究目的使用，并应在24小时内删除。脚本的使用不应违反任何法律法规及学术道德标准。",-1),e3=e.createElementVNode("br",null,null,-1),eF=e.createElementVNode("p",null,"2、用户在使用脚本时，必须遵守所有适用的法律法规。任何由于使用脚本而引起的违法行为或不当行为，其产生的一切后果由用户自行承担。",-1),e7=e.createElementVNode("br",null,null,-1),eP=e.createElementVNode("p",null,"3、开发者不对用户使用脚本所产生的任何直接或间接后果负责。用户应自行评估使用脚本的风险，并对任何可能的负面影响承担全责。",-1),e5=e.createElementVNode("br",null,null,-1),eL=e.createElementVNode("p",null,"4、本声明的目的在于提醒用户注意相关法律法规与风险，确保用户在明智、合法的前提下使用脚本。",-1),eT=e.createElementVNode("br",null,null,-1),eB=e.createElementVNode("p",null,"5、如用户在使用脚本的过程中有任何疑问，建议立即停止使用，并删除所有相关文件。",-1),eV=e.createElementVNode("br",null,null,-1),eI=e.createElementVNode("p",null,"6、本免责声明的最终解释权归脚本开发者所有。",-1),eE=[ek,e3,eF,e7,eP,e5,eL,eT,eB,eV,eI];function eN(t,r){return e.openBlock(),e.createElementBlock("div",null,eE)}let eA=ef(eC,[["render",eN]]);function eG(e){return"function"==typeof e}function ez(e){return eG(null==e?void 0:e.lift)}function eO(e){return t=>{if(ez(t))return t.lift(function(t){try{return e(t,this)}catch(r){this.error(r)}});throw TypeError("Unable to lift unknown Observable type")}}let eD=(e,t)=>(eD=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&((e,t)=>{e.__proto__=t})||((e,t)=>{for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t);function eq(e,t){if("function"!=typeof t&&null!==t)throw TypeError(`Class extends value ${String(t)} is not a constructor or null`);function r(){this.constructor=e}eD(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function eM(e,t,r,n){return new(r||(r=Promise))((l,a)=>{function o(e){try{s(n.next(e))}catch(t){a(t)}}function i(e){try{s(n.throw(e))}catch(t){a(t)}}function s({done:e,value:t}){var n;e?l(t):((n=t)instanceof r?n:new r(e=>{e(n)})).then(o,i)}s((n=n.apply(e,t||[])).next())})}function e9(e,t){let r={label:0,sent(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},n,l,a,o;return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return s=>(function i(s){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(r=0)),r;)try{if(n=1,l&&(a=2&s[0]?l.return:s[0]?l.throw||((a=l.return)&&a.call(l),0):l.next)&&!(a=a.call(l,s[1])).done)return a;switch(l=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,l=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===s[0]||2===s[0])){r=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){r.label=s[1];break}if(6===s[0]&&r.label<a[1]){r.label=a[1],a=s;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(s);break}a[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(u){s=[6,u],l=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([i,s])}}function eH(e){let t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:()=>(e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e})};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function eR(e,t){let r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;let n=r.call(e),l,a=[],o;try{for(;(void 0===t||t-- >0)&&!(l=n.next()).done;)a.push(l.value)}catch(i){o={error:i}}finally{try{l&&!l.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}function ej(e,t,r){if(r||2===arguments.length)for(var n,l=0,a=t.length;l<a;l++)!n&&l in t||(n||(n=Array.prototype.slice.call(t,0,l)),n[l]=t[l]);return e.concat(n||Array.prototype.slice.call(t))}function eW(e){return this instanceof eW?(this.v=e,this):new eW(e)}function eQ(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");let n=r.apply(e,t||[]),l,a=[];return l={},o("next"),o("throw"),o("return"),l[Symbol.asyncIterator]=function(){return this},l;function o(e){n[e]&&(l[e]=t=>new Promise((r,n)=>{a.push([e,t,r,n])>1||i(e,t)}))}function i(e,t){try{var r;r=n[e](t),r.value instanceof eW?Promise.resolve(r.value.v).then(s,u):d(a[0][2],r)}catch(l){d(a[0][3],l)}}function s(e){i("next",e)}function u(e){i("throw",e)}function d(e,t){e(t),a.shift(),a.length&&i(a[0][0],a[0][1])}}function eX(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");let t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=eH(e),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(t){r[t]=e[t]&&(r=>new Promise((n,l)=>{(function e(t,r,n,l){Promise.resolve(l).then(e=>{t({value:e,done:n})},r)})(n,l,(r=e[t](r)).done,r.value)}))}}let eJ=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function eK(e){return eG(null==e?void 0:e.then)}function eY(e){let t=e=>{Error.call(e),e.stack=Error().stack},r=e(t);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}let eZ=eY(e=>function t(r){e(this),this.message=r?`${r.length} errors occurred during unsubscription:
${r.map((e,t)=>`${t+1}) ${e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=r});function te(e,t){if(e){let r=e.indexOf(t);0<=r&&e.splice(r,1)}}let tt=(()=>{class e{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e,t,r,n,l;if(!this.closed){this.closed=!0;let a=this._parentage;if(a){if(this._parentage=null,Array.isArray(a))try{for(var o=eH(a),i=o.next();!i.done;i=o.next()){let s=i.value;s.remove(this)}}catch(u){e={error:u}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this)}let d=this.initialTeardown;if(eG(d))try{d()}catch(c){l=c instanceof eZ?c.errors:[c]}let h=this._finalizers;if(h){this._finalizers=null;try{for(var f=eH(h),p=f.next();!p.done;p=f.next()){let $=p.value;try{tn($)}catch(m){l=null!=l?l:[],m instanceof eZ?l=ej(ej([],eR(l)),eR(m.errors)):l.push(m)}}}catch(_){r={error:_}}finally{try{p&&!p.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}}if(l)throw new eZ(l)}}add(t){let r;if(t&&t!==this){if(this.closed)tn(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}}}_hasParent(e){let t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&te(t,e)}remove(t){let r=this._finalizers;r&&te(r,t),t instanceof e&&t._removeParent(this)}}return e.EMPTY=(()=>{let t=new e;return t.closed=!0,t})(),e})();function tr(e){return e instanceof tt||e&&"closed"in e&&eG(e.remove)&&eG(e.add)&&eG(e.unsubscribe)}function tn(e){eG(e)?e():e.unsubscribe()}tt.EMPTY;let tl={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ta={setTimeout(e,t){let r=[];for(let n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setTimeout.apply(void 0,ej([e,t],eR(r)))},clearTimeout:e=>clearTimeout(e),delegate:void 0};function to(e){ta.setTimeout(()=>{throw e})}function ti(){}function ts(e){e()}let tu=(e=>{eq(t,e);class t{constructor(t){let r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,tr(t)&&t.add(r)):r.destination=t0,r}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}return t.create=(e,t,r)=>new tf(e,t,r),t})(tt),td=Function.prototype.bind;function tc(e,t){return td.call(e,t)}let th=(()=>{class e{constructor(e){this.partialObserver=e}next(e){let t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){tp(r)}}error(e){let t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){tp(r)}else tp(e)}complete(){let e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){tp(t)}}}return e})();var tf=(e=>{function t(t,r,n){let l=e.call(this)||this,a;if(eG(t)||!t)a={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0};else{let o;l&&tl.useDeprecatedNextContext?((o=Object.create(t)).unsubscribe=()=>l.unsubscribe(),a={next:t.next&&tc(t.next,o),error:t.error&&tc(t.error,o),complete:t.complete&&tc(t.complete,o)}):a=t}return l.destination=new th(a),l}return eq(t,e),t})(tu);function tp(e){to(e)}function t$(e){throw e}var t0={closed:!0,next:ti,error:t$,complete:ti};let tm="function"==typeof Symbol&&Symbol.observable||"@@observable";function t_(e){return e}function tg(e){return 0===e.length?t_:1===e.length?e[0]:function t(r){return e.reduce((e,t)=>t(e),r)}}let tv=(()=>{class e{constructor(e){e&&(this._subscribe=e)}lift(t){let r=new e;return r.source=this,r.operator=t,r}subscribe(e,t,r){let n=this,l=t2(e)?e:new tf(e,t,r);return ts(()=>{let e=n,t=e.operator,r=e.source;l.add(t?t.call(l,r):r?n._subscribe(l):n._trySubscribe(l))}),l}_trySubscribe(e){try{return this._subscribe(e)}catch(t){e.error(t)}}forEach(e,t){let r=this;return new(t=ty(t))((t,n)=>{let l=new tf({next(t){try{e(t)}catch(r){n(r),l.unsubscribe()}},error:n,complete:t});r.subscribe(l)})}_subscribe(e){let t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)}pipe(...e){let t=[];for(let r=0;r<e.length;r++)t[r]=e[r];return tg(t)(this)}toPromise(e){let t=this;return new(e=ty(e))((e,r)=>{let n;t.subscribe(e=>n=e,e=>r(e),()=>e(n))})}}return e.prototype[tm]=function(){return this},e.create=t=>new e(t),e})();function ty(e){let t;return null!==(t=null!=e?e:tl.Promise)&&void 0!==t?t:Promise}function tb(e){return e&&eG(e.next)&&eG(e.error)&&eG(e.complete)}function t2(e){return e&&e instanceof tu||tb(e)&&tr(e)}function tS(e){return eG(e[tm])}function tU(e){return Symbol.asyncIterator&&eG(null==e?void 0:e[Symbol.asyncIterator])}function t1(e){return TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function tw(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}let tx=tw();function t8(e){return eG(null==e?void 0:e[tx])}function t4(e){return eQ(this,arguments,function t(){let r,n,l,a;return e9(this,t=>{switch(t.label){case 0:r=e.getReader(),t.label=1;case 1:t.trys.push([1,,9,10]),t.label=2;case 2:return[4,eW(r.read())];case 3:if(l=(n=t.sent()).value,!(a=n.done))return[3,5];return[4,eW(void 0)];case 4:return[2,t.sent()];case 5:return[4,eW(l)];case 6:return[4,t.sent()];case 7:return t.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function t6(e){return eG(null==e?void 0:e.getReader)}function tC(e){if(e instanceof tv)return e;if(null!=e){if(tS(e))return tk(e);if(eJ(e))return t3(e);if(eK(e))return tF(e);if(tU(e))return tP(e);if(t8(e))return t7(e);if(t6(e))return t5(e)}throw t1(e)}function tk(e){return new tv(t=>{let r=e[tm]();if(eG(r.subscribe))return r.subscribe(t);throw TypeError("Provided object does not correctly implement Symbol.observable")})}function t3(e){return new tv(t=>{for(let r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()})}function tF(e){return new tv(t=>{e.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,to)})}function t7(e){return new tv(t=>{let r,n;try{for(var l=eH(e),a=l.next();!a.done;a=l.next()){let o=a.value;if(t.next(o),t.closed)return}}catch(i){r={error:i}}finally{try{a&&!a.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}t.complete()})}function tP(e){return new tv(t=>{tL(e,t).catch(e=>t.error(e))})}function t5(e){return tP(t4(e))}function tL(e,t){let r,n,l,a;return eM(this,void 0,void 0,function(){let o,i;return e9(this,s=>{switch(s.label){case 0:s.trys.push([0,5,6,11]),r=eX(e),s.label=1;case 1:return[4,r.next()];case 2:if((n=s.sent()).done)return[3,4];if(o=n.value,t.next(o),t.closed)return[2];s.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return l={error:i=s.sent()},[3,11];case 6:if(s.trys.push([6,,9,10]),!(n&&!n.done&&(a=r.return)))return[3,8];return[4,a.call(r)];case 7:s.sent(),s.label=8;case 8:return[3,10];case 9:if(l)throw l.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function tT(e,t,r,n,l){return new tB(e,t,r,n,l)}var tB=(e=>{eq(t,e);class t{constructor(t,r,n,l,a,o){let i=e.call(this,t)||this;return i.onFinalize=a,i.shouldUnsubscribe=o,i._next=r?e=>{try{r(e)}catch(n){t.error(n)}}:e.prototype._next,i._error=l?function(e){try{l(e)}catch(r){t.error(r)}finally{this.unsubscribe()}}:e.prototype._error,i._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,i}unsubscribe(){let t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let r=this.closed;e.prototype.unsubscribe.call(this),r||null===(t=this.onFinalize)||void 0===t||t.call(this)}}}return t})(tu);function tV(e,t,r,n,l){void 0===n&&(n=0),void 0===l&&(l=!1);let a=t.schedule(function(){r(),l?e.add(this.schedule(null,n)):this.unsubscribe()},n);if(e.add(a),!l)return a}function tI(e,t){return eO((r,n)=>{let l=0;r.subscribe(tT(n,r=>{n.next(e.call(t,r,l++))}))})}function tE(e,t,r,n,l,a,o,i){let s=[],u=0,d=0,c=!1,h=()=>{!c||s.length||u||t.complete()},f=e=>u<n?p(e):s.push(e);var p=e=>{a&&t.next(e),u++;let i=!1;tC(r(e,d++)).subscribe(tT(t,e=>{null==l||l(e),a?f(e):t.next(e)},()=>{i=!0},void 0,()=>{if(i)try{u--;let e=()=>{let e=s.shift();o?tV(t,o,()=>p(e)):p(e)};for(;s.length&&u<n;)e();h()}catch(r){t.error(r)}}))};return e.subscribe(tT(t,f,()=>{c=!0,h()})),()=>{null==i||i()}}function tN(e,t,r){return(void 0===r&&(r=1/0),eG(t))?tN((r,n)=>tI((e,l)=>t(r,e,n,l))(tC(e(r,n))),r):("number"==typeof t&&(r=t),eO((t,n)=>tE(t,n,e,r)))}function tA(e){return void 0===e&&(e=1/0),tN(t_,e)}function tG(){return tA(1)}function tz(e,t){return eG(t)?tN(e,t,1):tN(e,1)}class tO{static getIframes(e){return Array.from(e.querySelectorAll("iframe"))}static getAllNestedIframes(e){let t=tO.getIframes(e);return 0===t.length?r.of([]):r.from(t).pipe(tN(e=>new r.Observable(t=>{if(e.contentDocument&&"complete"===e.contentDocument.readyState){let n=e.contentDocument,l=tO.getAllNestedIframes(n.documentElement);l.subscribe(r=>{t.next([e,...r]),t.complete()})}else r.fromEvent(e,"load").pipe(tI(()=>e.contentDocument?e.contentDocument.documentElement:document.createElement("div")),tI(e=>tO.getAllNestedIframes(e)),tG()).subscribe(r=>{t.next([e,...r]),t.complete()})})),tG(),r.toArray())}}class tD{constructor(e,t){d(this,"xhr"),d(this,"originalOpen"),d(this,"callback"),this.xhr=new XMLHttpRequest,this.originalOpen=this.xhr.open,this.callback=t,this.intercept(e)}intercept(e){let t=this;XMLHttpRequest.prototype.open=function(r,n,l,a,o){return e.some(e=>n.includes(e))&&t.callback(r,n),t.originalOpen.apply(this,[r,n,l,a,o])}}}let tq={},tM={};tM.parse=e=>{let t=tM._bin,r=new Uint8Array(e),n=t.readASCII(r,0,4);if("ttcf"!=n)return[tM._readFont(r,0)];{let l=4;t.readUshort(r,l),l+=2,t.readUshort(r,l),l+=2;let a=t.readUint(r,l);l+=4;let o=[];for(let i=0;i<a;i++){let s=t.readUint(r,l);l+=4,o.push(tM._readFont(r,s))}return o}},tM._readFont=(e,t)=>{let r=tM._bin,n=t;r.readFixed(e,t),t+=4;let l=r.readUshort(e,t);t+=2,r.readUshort(e,t),t+=2,r.readUshort(e,t),t+=2,r.readUshort(e,t),t+=2;let a=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG ",],o={_data:e,_offset:n},i={};for(var s=0;s<l;s++){let u=r.readASCII(e,t,4);t+=4,r.readUint(e,t),t+=4;let d=r.readUint(e,t);t+=4;let c=r.readUint(e,t);t+=4,i[u]={offset:d,length:c}}for(var s=0;s<a.length;s++){let h=a[s];i[h]&&(o[h.trim()]=tM[h.trim()].parse(e,i[h].offset,i[h].length,o))}return o},tM._tabOffset=(e,t,r)=>{let n=tM._bin,l=n.readUshort(e,r+4),a=r+12;for(let o=0;o<l;o++){let i=n.readASCII(e,a,4);a+=4,n.readUint(e,a),a+=4;let s=n.readUint(e,a);if(a+=4,n.readUint(e,a),a+=4,i==t)return s}return 0},tM._bin={readFixed:(e,t)=>(e[t]<<8|e[t+1])+(e[t+2]<<8|e[t+3])/65540,readF2dot14(e,t){let r=tM._bin.readShort(e,t);return r/16384},readInt:(e,t)=>tM._bin._view(e).getInt32(t),readInt8:(e,t)=>tM._bin._view(e).getInt8(t),readShort:(e,t)=>tM._bin._view(e).getInt16(t),readUshort:(e,t)=>tM._bin._view(e).getUint16(t),readUshorts(e,t,r){let n=[];for(let l=0;l<r;l++)n.push(tM._bin.readUshort(e,t+2*l));return n},readUint:(e,t)=>tM._bin._view(e).getUint32(t),readUint64:(e,t)=>4294967296*tM._bin.readUint(e,t)+tM._bin.readUint(e,t+4),readASCII(e,t,r){let n="";for(let l=0;l<r;l++)n+=String.fromCharCode(e[t+l]);return n},readUnicode(e,t,r){let n="";for(let l=0;l<r;l++){let a=e[t++]<<8|e[t++];n+=String.fromCharCode(a)}return n},_tdec:"undefined"!=typeof window&&window.TextDecoder?new window.TextDecoder:null,readUTF8(e,t,r){let n=tM._bin._tdec;return n&&0==t&&r==e.length?n.decode(e):tM._bin.readASCII(e,t,r)},readBytes(e,t,r){let n=[];for(let l=0;l<r;l++)n.push(e[t+l]);return n},readASCIIArray(e,t,r){let n=[];for(let l=0;l<r;l++)n.push(String.fromCharCode(e[t+l]));return n},_view:e=>e._dataView||(e._dataView=e.buffer?new DataView(e.buffer,e.byteOffset,e.byteLength):new DataView(new Uint8Array(e).buffer))},tM._lctf={},tM._lctf.parse=(e,t,r,n,l)=>{let a=tM._bin,o={},i=t;a.readFixed(e,t),t+=4;let s=a.readUshort(e,t);t+=2;let u=a.readUshort(e,t);t+=2;let d=a.readUshort(e,t);return t+=2,o.scriptList=tM._lctf.readScriptList(e,i+s),o.featureList=tM._lctf.readFeatureList(e,i+u),o.lookupList=tM._lctf.readLookupList(e,i+d,l),o},tM._lctf.readLookupList=(e,t,r)=>{let n=tM._bin,l=t,a=[],o=n.readUshort(e,t);t+=2;for(let i=0;i<o;i++){let s=n.readUshort(e,t);t+=2;let u=tM._lctf.readLookupTable(e,l+s,r);a.push(u)}return a},tM._lctf.readLookupTable=(e,t,r)=>{let n=tM._bin,l=t,a={tabs:[]};a.ltype=n.readUshort(e,t),t+=2,a.flag=n.readUshort(e,t),t+=2;let o=n.readUshort(e,t);t+=2;let i=a.ltype;for(let s=0;s<o;s++){let u=n.readUshort(e,t);t+=2;let d=r(e,i,l+u,a);a.tabs.push(d)}return a},tM._lctf.numOfOnes=e=>{let t=0;for(let r=0;r<32;r++)(e>>>r&1)!=0&&t++;return t},tM._lctf.readClassDef=(e,t)=>{let r=tM._bin,n=[],l=r.readUshort(e,t);if(t+=2,1==l){let a=r.readUshort(e,t);t+=2;let o=r.readUshort(e,t);t+=2;for(var i=0;i<o;i++)n.push(a+i),n.push(a+i),n.push(r.readUshort(e,t)),t+=2}if(2==l){let s=r.readUshort(e,t);t+=2;for(var i=0;i<s;i++)n.push(r.readUshort(e,t)),t+=2,n.push(r.readUshort(e,t)),t+=2,n.push(r.readUshort(e,t)),t+=2}return n},tM._lctf.getInterval=(e,t)=>{for(let r=0;r<e.length;r+=3){let n=e[r],l=e[r+1];if(e[r+2],n<=t&&t<=l)return r}return -1},tM._lctf.readCoverage=(e,t)=>{let r=tM._bin,n={};n.fmt=r.readUshort(e,t),t+=2;let l=r.readUshort(e,t);return t+=2,1==n.fmt&&(n.tab=r.readUshorts(e,t,l)),2==n.fmt&&(n.tab=r.readUshorts(e,t,3*l)),n},tM._lctf.coverageIndex=(e,t)=>{let r=e.tab;if(1==e.fmt)return r.indexOf(t);if(2==e.fmt){let n=tM._lctf.getInterval(r,t);if(-1!=n)return r[n+2]+(t-r[n])}return -1},tM._lctf.readFeatureList=(e,t)=>{let r=tM._bin,n=t,l=[],a=r.readUshort(e,t);t+=2;for(let o=0;o<a;o++){let i=r.readASCII(e,t,4);t+=4;let s=r.readUshort(e,t);t+=2;let u=tM._lctf.readFeatureTable(e,n+s);u.tag=i.trim(),l.push(u)}return l},tM._lctf.readFeatureTable=(e,t)=>{let r=tM._bin,n=t,l={},a=r.readUshort(e,t);t+=2,a>0&&(l.featureParams=n+a);let o=r.readUshort(e,t);t+=2,l.tab=[];for(let i=0;i<o;i++)l.tab.push(r.readUshort(e,t+2*i));return l},tM._lctf.readScriptList=(e,t)=>{let r=tM._bin,n=t,l={},a=r.readUshort(e,t);t+=2;for(let o=0;o<a;o++){let i=r.readASCII(e,t,4);t+=4;let s=r.readUshort(e,t);t+=2,l[i.trim()]=tM._lctf.readScriptTable(e,n+s)}return l},tM._lctf.readScriptTable=(e,t)=>{let r=tM._bin,n=t,l={},a=r.readUshort(e,t);t+=2,l.default=tM._lctf.readLangSysTable(e,n+a);let o=r.readUshort(e,t);t+=2;for(let i=0;i<o;i++){let s=r.readASCII(e,t,4);t+=4;let u=r.readUshort(e,t);t+=2,l[s.trim()]=tM._lctf.readLangSysTable(e,n+u)}return l},tM._lctf.readLangSysTable=(e,t)=>{let r=tM._bin,n={};r.readUshort(e,t),t+=2,n.reqFeature=r.readUshort(e,t),t+=2;let l=r.readUshort(e,t);return t+=2,n.features=r.readUshorts(e,t,l),n},tM.CFF={},tM.CFF.parse=(e,t,r)=>{let n=tM._bin;(e=new Uint8Array(e.buffer,t,r))[t=0],e[++t],e[++t],e[++t],t++;let l=[];t=tM.CFF.readIndex(e,t,l);let a=[];for(var o=0;o<l.length-1;o++)a.push(n.readASCII(e,t+l[o],l[o+1]-l[o]));t+=l[l.length-1];let i=[];t=tM.CFF.readIndex(e,t,i);let s=[];for(var o=0;o<i.length-1;o++)s.push(tM.CFF.readDict(e,t+i[o],t+i[o+1]));t+=i[i.length-1];let u=s[0];var d=[];t=tM.CFF.readIndex(e,t,d);let c=[];for(var o=0;o<d.length-1;o++)c.push(n.readASCII(e,t+d[o],d[o+1]-d[o]));if(t+=d[d.length-1],tM.CFF.readSubrs(e,t,u),u.CharStrings){t=u.CharStrings;var d=[];t=tM.CFF.readIndex(e,t,d);let h=[];for(var o=0;o<d.length-1;o++)h.push(n.readBytes(e,t+d[o],d[o+1]-d[o]));u.CharStrings=h}if(u.ROS){t=u.FDArray;let f=[];t=tM.CFF.readIndex(e,t,f),u.FDArray=[];for(var o=0;o<f.length-1;o++){let p=tM.CFF.readDict(e,t+f[o],t+f[o+1]);tM.CFF._readFDict(e,p,c),u.FDArray.push(p)}t+=f[f.length-1],t=u.FDSelect,u.FDSelect=[];let $=e[t];if(t++,3==$){let m=n.readUshort(e,t);t+=2;for(var o=0;o<m+1;o++)u.FDSelect.push(n.readUshort(e,t),e[t+2]),t+=3}else throw $}return u.Encoding&&(u.Encoding=tM.CFF.readEncoding(e,u.Encoding,u.CharStrings.length)),u.charset&&(u.charset=tM.CFF.readCharset(e,u.charset,u.CharStrings.length)),tM.CFF._readFDict(e,u,c),u},tM.CFF._readFDict=(e,t,r)=>{let n;for(let l in t.Private&&(n=t.Private[1],t.Private=tM.CFF.readDict(e,n,n+t.Private[0]),t.Private.Subrs&&tM.CFF.readSubrs(e,n+t.Private.Subrs,t.Private)),t)["FamilyName","FontName","FullName","Notice","version","Copyright"].includes(l)&&(t[l]=r[t[l]-426+35])},tM.CFF.readSubrs=(e,t,r)=>{let n=tM._bin,l=[];t=tM.CFF.readIndex(e,t,l);let a,o=l.length;a=o<1240?107:o<33900?1131:32768,r.Bias=a,r.Subrs=[];for(let i=0;i<l.length-1;i++)r.Subrs.push(n.readBytes(e,t+l[i],l[i+1]-l[i]))},tM.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],tM.CFF.glyphByUnicode=({charset:e},t)=>{for(let r=0;r<e.length;r++)if(e[r]==t)return r;return -1},tM.CFF.glyphBySE=(e,t)=>t<0||t>255?-1:tM.CFF.glyphByUnicode(e,tM.CFF.tableSE[t]),tM.CFF.readEncoding=(e,t,r)=>{tM._bin;let n=[".notdef"],l=e[t];if(t++,0==l){let a=e[t];t++;for(let o=0;o<a;o++)n.push(e[t+o])}else throw`error: unknown encoding format: ${l}`;return n},tM.CFF.readCharset=(e,t,r)=>{let n=tM._bin,l=[".notdef"],a=e[t];if(t++,0==a)for(var o=0;o<r;o++){var i=n.readUshort(e,t);t+=2,l.push(i)}else if(1==a||2==a)for(;l.length<r;){var i=n.readUshort(e,t);t+=2;let s=0;1==a?(s=e[t],t++):(s=n.readUshort(e,t),t+=2);for(var o=0;o<=s;o++)l.push(i),i++}else throw`error: format: ${a}`;return l},tM.CFF.readIndex=(e,t,r)=>{let n=tM._bin,l=n.readUshort(e,t)+1;t+=2;let a=e[t];if(t++,1==a)for(var o=0;o<l;o++)r.push(e[t+o]);else if(2==a)for(var o=0;o<l;o++)r.push(n.readUshort(e,t+2*o));else if(3==a)for(var o=0;o<l;o++)r.push(16777215&n.readUint(e,t+3*o-1));else if(1!=l)throw`unsupported offset size: ${a}, count: ${l}`;return(t+=l*a)-1},tM.CFF.getCharString=(e,t,r)=>{let n=tM._bin,l=e[t],a=e[t+1];e[t+2],e[t+3],e[t+4];let o=1,i=null,s=null;l<=20&&(i=l,o=1),12==l&&(i=100*l+a,o=2),21<=l&&l<=27&&(i=l,o=1),28==l&&(s=n.readShort(e,t+1),o=3),29<=l&&l<=31&&(i=l,o=1),32<=l&&l<=246&&(s=l-139,o=1),247<=l&&l<=250&&(s=(l-247)*256+a+108,o=2),251<=l&&l<=254&&(s=-(256*(l-251))-a-108,o=2),255==l&&(s=n.readInt(e,t+1)/65535,o=5),r.val=null!=s?s:`o${i}`,r.size=o},tM.CFF.readCharString=(e,t,r)=>{let n=t+r,l=tM._bin,a=[];for(;t<n;){let o=e[t],i=e[t+1];e[t+2],e[t+3],e[t+4];let s=1,u=null,d=null;o<=20&&(u=o,s=1),12==o&&(u=100*o+i,s=2),(19==o||20==o)&&(u=o,s=2),21<=o&&o<=27&&(u=o,s=1),28==o&&(d=l.readShort(e,t+1),s=3),29<=o&&o<=31&&(u=o,s=1),32<=o&&o<=246&&(d=o-139,s=1),247<=o&&o<=250&&(d=(o-247)*256+i+108,s=2),251<=o&&o<=254&&(d=-(256*(o-251))-i-108,s=2),255==o&&(d=l.readInt(e,t+1)/65535,s=5),a.push(null!=d?d:`o${u}`),t+=s}return a},tM.CFF.readDict=(e,t,r)=>{let n=tM._bin,l={},a=[];for(;t<r;){let o=e[t],i=e[t+1];e[t+2],e[t+3],e[t+4];let s=1,u=null,d=null;if(28==o&&(d=n.readShort(e,t+1),s=3),29==o&&(d=n.readInt(e,t+1),s=5),32<=o&&o<=246&&(d=o-139,s=1),247<=o&&o<=250&&(d=(o-247)*256+i+108,s=2),251<=o&&o<=254&&(d=-(256*(o-251))-i-108,s=2),255==o)throw d=n.readInt(e,t+1)/65535,s=5,"unknown number";if(30==o){let c=[];for(s=1;;){let h=e[t+s];s++;let f=h>>4,p=15&h;if(15!=f&&c.push(f),15!=p&&c.push(p),15==p)break}let $="",m=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"];for(let _=0;_<c.length;_++)$+=m[c[_]];d=parseFloat($)}if(o<=21){var g=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"];if(u=g[o],s=1,12==o){var g=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"];u=g[i],s=2}}null!=u?(l[u]=1==a.length?a[0]:a,a=[]):a.push(d),t+=s}return l},tM.cmap={},tM.cmap.parse=(e,t,r)=>{e=new Uint8Array(e.buffer,t,r),t=0;let n=tM._bin,l={};n.readUshort(e,t),t+=2;let a=n.readUshort(e,t);t+=2;let o=[];l.tables=[];for(let i=0;i<a;i++){let s=n.readUshort(e,t);t+=2;let u=n.readUshort(e,t);t+=2;let d=n.readUint(e,t);t+=4;let c=`p${s}e${u}`,h=o.indexOf(d);if(-1==h){h=l.tables.length;let f;o.push(d);let p=n.readUshort(e,d);0==p?f=tM.cmap.parse0(e,d):4==p?f=tM.cmap.parse4(e,d):6==p?f=tM.cmap.parse6(e,d):12==p?f=tM.cmap.parse12(e,d):console.warn(`unknown format: ${p}`,s,u,d),l.tables.push(f)}if(null!=l[c])throw"multiple tables for one platform+encoding";l[c]=h}return l},tM.cmap.parse0=(e,t)=>{let r=tM._bin,n={};n.format=r.readUshort(e,t),t+=2;let l=r.readUshort(e,t);t+=2,r.readUshort(e,t),t+=2,n.map=[];for(let a=0;a<l-6;a++)n.map.push(e[t+a]);return n},tM.cmap.parse4=(e,t)=>{let r=tM._bin,n=t,l={};l.format=r.readUshort(e,t),t+=2;let a=r.readUshort(e,t);t+=2,r.readUshort(e,t),t+=2;let o=r.readUshort(e,t);t+=2;let i=o/2;l.searchRange=r.readUshort(e,t),t+=2,l.entrySelector=r.readUshort(e,t),t+=2,l.rangeShift=r.readUshort(e,t),t+=2,l.endCount=r.readUshorts(e,t,i),t+=2*i,t+=2,l.startCount=r.readUshorts(e,t,i),t+=2*i,l.idDelta=[];for(let s=0;s<i;s++)l.idDelta.push(r.readShort(e,t)),t+=2;for(l.idRangeOffset=r.readUshorts(e,t,i),t+=2*i,l.glyphIdArray=[];t<n+a;)l.glyphIdArray.push(r.readUshort(e,t)),t+=2;return l},tM.cmap.parse6=(e,t)=>{let r=tM._bin,n={};n.format=r.readUshort(e,t),t+=2,r.readUshort(e,t),t+=2,r.readUshort(e,t),t+=2,n.firstCode=r.readUshort(e,t),t+=2;let l=r.readUshort(e,t);t+=2,n.glyphIdArray=[];for(let a=0;a<l;a++)n.glyphIdArray.push(r.readUshort(e,t)),t+=2;return n},tM.cmap.parse12=(e,t)=>{let r=tM._bin,n={};n.format=r.readUshort(e,t),t+=2,t+=2,r.readUint(e,t),t+=4,r.readUint(e,t),t+=4;let l=r.readUint(e,t);t+=4,n.groups=[];for(let a=0;a<l;a++){let o=t+12*a,i=r.readUint(e,o+0),s=r.readUint(e,o+4),u=r.readUint(e,o+8);n.groups.push([i,s,u])}return n},tM.glyf={},tM.glyf.parse=(e,t,r,{maxp:n})=>{let l=[];for(let a=0;a<n.numGlyphs;a++)l.push(null);return l},tM.glyf._parseGlyf=({_data:e,_offset:t,loca:r},n)=>{let l=tM._bin,a=e,o=tM._tabOffset(a,"glyf",t)+r[n];if(r[n]==r[n+1])return null;let i={};if(i.noc=l.readShort(a,o),o+=2,i.xMin=l.readShort(a,o),o+=2,i.yMin=l.readShort(a,o),o+=2,i.xMax=l.readShort(a,o),o+=2,i.yMax=l.readShort(a,o),o+=2,i.xMin>=i.xMax||i.yMin>=i.yMax)return null;if(i.noc>0){i.endPts=[];for(var s=0;s<i.noc;s++)i.endPts.push(l.readUshort(a,o)),o+=2;let u=l.readUshort(a,o);if(o+=2,a.length-o<u)return null;i.instructions=l.readBytes(a,o,u),o+=u;let d=i.endPts[i.noc-1]+1;i.flags=[];for(var s=0;s<d;s++){let c=a[o];if(o++,i.flags.push(c),(8&c)!=0){let h=a[o];o++;for(let f=0;f<h;f++)i.flags.push(c),s++}}i.xs=[];for(var s=0;s<d;s++){var p=(2&i.flags[s])!=0,$=(16&i.flags[s])!=0;p?(i.xs.push($?a[o]:-a[o]),o++):$?i.xs.push(0):(i.xs.push(l.readShort(a,o)),o+=2)}i.ys=[];for(var s=0;s<d;s++){var p=(4&i.flags[s])!=0,$=(32&i.flags[s])!=0;p?(i.ys.push($?a[o]:-a[o]),o++):$?i.ys.push(0):(i.ys.push(l.readShort(a,o)),o+=2)}let m=0,_=0;for(var s=0;s<d;s++)m+=i.xs[s],_+=i.ys[s],i.xs[s]=m,i.ys[s]=_}else{i.parts=[];let g;do{g=l.readUshort(a,o),o+=2;let v={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(i.parts.push(v),v.glyphIndex=l.readUshort(a,o),o+=2,1&g){var y=l.readShort(a,o);o+=2;var b=l.readShort(a,o);o+=2}else{var y=l.readInt8(a,o);o++;var b=l.readInt8(a,o);o++}2&g?(v.m.tx=y,v.m.ty=b):(v.p1=y,v.p2=b),8&g?(v.m.a=v.m.d=l.readF2dot14(a,o),o+=2):64&g?(v.m.a=l.readF2dot14(a,o),o+=2,v.m.d=l.readF2dot14(a,o),o+=2):128&g&&(v.m.a=l.readF2dot14(a,o),o+=2,v.m.b=l.readF2dot14(a,o),o+=2,v.m.c=l.readF2dot14(a,o),o+=2,v.m.d=l.readF2dot14(a,o),o+=2)}while(32&g);if(256&g){let S=l.readUshort(a,o);o+=2,i.instr=[];for(var s=0;s<S;s++)i.instr.push(a[o]),o++}}return i},tM.GPOS={},tM.GPOS.parse=(e,t,r,n)=>tM._lctf.parse(e,t,r,n,tM.GPOS.subt),tM.GPOS.subt=(e,t,r,n)=>{let l=tM._bin,a=r,o={};if(o.fmt=l.readUshort(e,r),r+=2,1==t||2==t||3==t||7==t||8==t&&o.fmt<=2){let i=l.readUshort(e,r);r+=2,o.coverage=tM._lctf.readCoverage(e,i+a)}if(1==t&&1==o.fmt){var s=l.readUshort(e,r);r+=2;var u=tM._lctf.numOfOnes(s);0!=s&&(o.pos=tM.GPOS.readValueRecord(e,r,s))}else if(2==t&&o.fmt>=1&&o.fmt<=2){var s=l.readUshort(e,r);r+=2;let d=l.readUshort(e,r);r+=2;var u=tM._lctf.numOfOnes(s);let c=tM._lctf.numOfOnes(d);if(1==o.fmt){o.pairsets=[];let h=l.readUshort(e,r);r+=2;for(var f=0;f<h;f++){let p=a+l.readUshort(e,r);r+=2;let $=l.readUshort(e,p);p+=2;let m=[];for(var _,g,v=0;v<$;v++){let y=l.readUshort(e,p);p+=2,0!=s&&(_=tM.GPOS.readValueRecord(e,p,s),p+=2*u),0!=d&&(g=tM.GPOS.readValueRecord(e,p,d),p+=2*c),m.push({gid2:y,val1:_,val2:g})}o.pairsets.push(m)}}if(2==o.fmt){let b=l.readUshort(e,r);r+=2;let S=l.readUshort(e,r);r+=2;let U=l.readUshort(e,r);r+=2;let w=l.readUshort(e,r);r+=2,o.classDef1=tM._lctf.readClassDef(e,a+b),o.classDef2=tM._lctf.readClassDef(e,a+S),o.matrix=[];for(var f=0;f<U;f++){let x=[];for(var v=0;v<w;v++){var _=null,g=null;0!=s&&(_=tM.GPOS.readValueRecord(e,r,s),r+=2*u),0!=d&&(g=tM.GPOS.readValueRecord(e,r,d),r+=2*c),x.push({val1:_,val2:g})}o.matrix.push(x)}}}else if(9==t&&1==o.fmt){let C=l.readUshort(e,r);r+=2;let k=l.readUint(e,r);if(r+=4,9==n.ltype)n.ltype=C;else if(n.ltype!=C)throw"invalid extension substitution";return tM.GPOS.subt(e,n.ltype,a+k)}else console.warn("unsupported GPOS table LookupType",t,"format",o.fmt);return o},tM.GPOS.readValueRecord=(e,t,r)=>{let n=tM._bin,l=[];return l.push(1&r?n.readShort(e,t):0),t+=1&r?2:0,l.push(2&r?n.readShort(e,t):0),t+=2&r?2:0,l.push(4&r?n.readShort(e,t):0),t+=4&r?2:0,l.push(8&r?n.readShort(e,t):0),t+=8&r?2:0,l},tM.GSUB={},tM.GSUB.parse=(e,t,r,n)=>tM._lctf.parse(e,t,r,n,tM.GSUB.subt),tM.GSUB.subt=(e,t,r,n)=>{let l=tM._bin,a=r,o={};if(o.fmt=l.readUshort(e,r),r+=2,1!=t&&4!=t&&5!=t&&6!=t)return null;if(1==t||4==t||5==t&&o.fmt<=2||6==t&&o.fmt<=2){let i=l.readUshort(e,r);r+=2,o.coverage=tM._lctf.readCoverage(e,a+i)}if(1==t&&o.fmt>=1&&o.fmt<=2){if(1==o.fmt)o.delta=l.readShort(e,r),r+=2;else if(2==o.fmt){var s=l.readUshort(e,r);r+=2,o.newg=l.readUshorts(e,r,s),r+=2*o.newg.length}}else if(4==t){o.vals=[];var s=l.readUshort(e,r);r+=2;for(var u=0;u<s;u++){let d=l.readUshort(e,r);r+=2,o.vals.push(tM.GSUB.readLigatureSet(e,a+d))}}else if(5==t&&2==o.fmt){if(2==o.fmt){let c=l.readUshort(e,r);r+=2,o.cDef=tM._lctf.readClassDef(e,a+c),o.scset=[];let h=l.readUshort(e,r);r+=2;for(var u=0;u<h;u++){let f=l.readUshort(e,r);r+=2,o.scset.push(0==f?null:tM.GSUB.readSubClassSet(e,a+f))}}}else if(6==t&&3==o.fmt){if(3==o.fmt){for(var u=0;u<3;u++){var s=l.readUshort(e,r);r+=2;let p=[];for(let $=0;$<s;$++)p.push(tM._lctf.readCoverage(e,a+l.readUshort(e,r+2*$)));r+=2*s,0==u&&(o.backCvg=p),1==u&&(o.inptCvg=p),2==u&&(o.ahedCvg=p)}var s=l.readUshort(e,r);r+=2,o.lookupRec=tM.GSUB.readSubstLookupRecords(e,r,s)}}else if(7==t&&1==o.fmt){let m=l.readUshort(e,r);r+=2;let _=l.readUint(e,r);if(r+=4,9==n.ltype)n.ltype=m;else if(n.ltype!=m)throw"invalid extension substitution";return tM.GSUB.subt(e,n.ltype,a+_)}else console.warn("unsupported GSUB table LookupType",t,"format",o.fmt);return o},tM.GSUB.readSubClassSet=(e,t)=>{let r=tM._bin.readUshort,n=t,l=[],a=r(e,t);t+=2;for(let o=0;o<a;o++){let i=r(e,t);t+=2,l.push(tM.GSUB.readSubClassRule(e,n+i))}return l},tM.GSUB.readSubClassRule=(e,t)=>{let r=tM._bin.readUshort,n={},l=r(e,t);t+=2;let a=r(e,t);t+=2,n.input=[];for(let o=0;o<l-1;o++)n.input.push(r(e,t)),t+=2;return n.substLookupRecords=tM.GSUB.readSubstLookupRecords(e,t,a),n},tM.GSUB.readSubstLookupRecords=(e,t,r)=>{let n=tM._bin.readUshort,l=[];for(let a=0;a<r;a++)l.push(n(e,t),n(e,t+2)),t+=4;return l},tM.GSUB.readChainSubClassSet=(e,t)=>{let r=tM._bin,n=t,l=[],a=r.readUshort(e,t);t+=2;for(let o=0;o<a;o++){let i=r.readUshort(e,t);t+=2,l.push(tM.GSUB.readChainSubClassRule(e,n+i))}return l},tM.GSUB.readChainSubClassRule=(e,t)=>{let r=tM._bin,n={},l=["backtrack","input","lookahead"];for(let a=0;a<l.length;a++){var o=r.readUshort(e,t);t+=2,1==a&&o--,n[l[a]]=r.readUshorts(e,t,o),t+=2*n[l[a]].length}var o=r.readUshort(e,t);return t+=2,n.subst=r.readUshorts(e,t,2*o),t+=2*n.subst.length,n},tM.GSUB.readLigatureSet=(e,t)=>{let r=tM._bin,n=t,l=[],a=r.readUshort(e,t);t+=2;for(let o=0;o<a;o++){let i=r.readUshort(e,t);t+=2,l.push(tM.GSUB.readLigature(e,n+i))}return l},tM.GSUB.readLigature=(e,t)=>{let r=tM._bin,n={chain:[]};n.nglyph=r.readUshort(e,t),t+=2;let l=r.readUshort(e,t);t+=2;for(let a=0;a<l-1;a++)n.chain.push(r.readUshort(e,t)),t+=2;return n},tM.head={},tM.head.parse=(e,t,r)=>{let n=tM._bin,l={};return n.readFixed(e,t),t+=4,l.fontRevision=n.readFixed(e,t),t+=4,n.readUint(e,t),t+=4,n.readUint(e,t),t+=4,l.flags=n.readUshort(e,t),t+=2,l.unitsPerEm=n.readUshort(e,t),t+=2,l.created=n.readUint64(e,t),t+=8,l.modified=n.readUint64(e,t),t+=8,l.xMin=n.readShort(e,t),t+=2,l.yMin=n.readShort(e,t),t+=2,l.xMax=n.readShort(e,t),t+=2,l.yMax=n.readShort(e,t),t+=2,l.macStyle=n.readUshort(e,t),t+=2,l.lowestRecPPEM=n.readUshort(e,t),t+=2,l.fontDirectionHint=n.readShort(e,t),t+=2,l.indexToLocFormat=n.readShort(e,t),t+=2,l.glyphDataFormat=n.readShort(e,t),t+=2,l},tM.hhea={},tM.hhea.parse=(e,t,r)=>{let n=tM._bin,l={};return n.readFixed(e,t),t+=4,l.ascender=n.readShort(e,t),t+=2,l.descender=n.readShort(e,t),t+=2,l.lineGap=n.readShort(e,t),t+=2,l.advanceWidthMax=n.readUshort(e,t),t+=2,l.minLeftSideBearing=n.readShort(e,t),t+=2,l.minRightSideBearing=n.readShort(e,t),t+=2,l.xMaxExtent=n.readShort(e,t),t+=2,l.caretSlopeRise=n.readShort(e,t),t+=2,l.caretSlopeRun=n.readShort(e,t),t+=2,l.caretOffset=n.readShort(e,t),t+=2,t+=8,l.metricDataFormat=n.readShort(e,t),t+=2,l.numberOfHMetrics=n.readUshort(e,t),t+=2,l},tM.hmtx={},tM.hmtx.parse=(e,t,r,{maxp:n,hhea:l})=>{let a=tM._bin,o={};o.aWidth=[],o.lsBearing=[];let i=0,s=0;for(let u=0;u<n.numGlyphs;u++)u<l.numberOfHMetrics&&(i=a.readUshort(e,t),t+=2,s=a.readShort(e,t),t+=2),o.aWidth.push(i),o.lsBearing.push(s);return o},tM.kern={},tM.kern.parse=(e,t,r,n)=>{let l=tM._bin,a=l.readUshort(e,t);if(t+=2,1==a)return tM.kern.parseV1(e,t-2,r,n);let o=l.readUshort(e,t);t+=2;let i={glyph1:[],rval:[]};for(let s=0;s<o;s++){t+=2;var r=l.readUshort(e,t);t+=2;let u=l.readUshort(e,t);t+=2;let d=u>>>8;if(0==(d&=15))t=tM.kern.readFormat0(e,t,i);else throw`unknown kern table format: ${d}`}return i},tM.kern.parseV1=(e,t,r,n)=>{let l=tM._bin;l.readFixed(e,t),t+=4;let a=l.readUint(e,t);t+=4;let o={glyph1:[],rval:[]};for(let i=0;i<a;i++){l.readUint(e,t),t+=4;let s=l.readUshort(e,t);t+=2,l.readUshort(e,t),t+=2;let u=s>>>8;if(0==(u&=15))t=tM.kern.readFormat0(e,t,o);else throw`unknown kern table format: ${u}`}return o},tM.kern.readFormat0=(e,t,r)=>{let n=tM._bin,l=-1,a=n.readUshort(e,t);t+=2,n.readUshort(e,t),t+=2,n.readUshort(e,t),t+=2,n.readUshort(e,t),t+=2;for(let o=0;o<a;o++){let i=n.readUshort(e,t);t+=2;let s=n.readUshort(e,t);t+=2;let u=n.readShort(e,t);t+=2,i!=l&&(r.glyph1.push(i),r.rval.push({glyph2:[],vals:[]}));let d=r.rval[r.rval.length-1];d.glyph2.push(s),d.vals.push(u),l=i}return t},tM.loca={},tM.loca.parse=(e,t,r,{head:n,maxp:l})=>{let a=tM._bin,o=[],i=n.indexToLocFormat,s=l.numGlyphs+1;if(0==i)for(var u=0;u<s;u++)o.push(a.readUshort(e,t+(u<<1))<<1);if(1==i)for(var u=0;u<s;u++)o.push(a.readUint(e,t+(u<<2)));return o},tM.maxp={},tM.maxp.parse=(e,t,r)=>{let n=tM._bin,l={},a=n.readUint(e,t);return t+=4,l.numGlyphs=n.readUshort(e,t),t+=2,65536==a&&(l.maxPoints=n.readUshort(e,t),t+=2,l.maxContours=n.readUshort(e,t),t+=2,l.maxCompositePoints=n.readUshort(e,t),t+=2,l.maxCompositeContours=n.readUshort(e,t),t+=2,l.maxZones=n.readUshort(e,t),t+=2,l.maxTwilightPoints=n.readUshort(e,t),t+=2,l.maxStorage=n.readUshort(e,t),t+=2,l.maxFunctionDefs=n.readUshort(e,t),t+=2,l.maxInstructionDefs=n.readUshort(e,t),t+=2,l.maxStackElements=n.readUshort(e,t),t+=2,l.maxSizeOfInstructions=n.readUshort(e,t),t+=2,l.maxComponentElements=n.readUshort(e,t),t+=2,l.maxComponentDepth=n.readUshort(e,t),t+=2),l},tM.name={},tM.name.parse=(e,t,r)=>{let n=tM._bin,l={};n.readUshort(e,t),t+=2;let a=n.readUshort(e,t);t+=2,n.readUshort(e,t),t+=2;let o=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],i=t;for(let s=0;s<a;s++){let u=n.readUshort(e,t);t+=2;let d=n.readUshort(e,t);t+=2;let c=n.readUshort(e,t);t+=2;let h=n.readUshort(e,t);t+=2;let f=n.readUshort(e,t);t+=2;let p=n.readUshort(e,t);t+=2;let $=o[h],m=i+12*a+p,_;if(0==u)_=n.readUnicode(e,m,f/2);else if(3==u&&0==d)_=n.readUnicode(e,m,f/2);else if(0==d)_=n.readASCII(e,m,f);else if(1==d)_=n.readUnicode(e,m,f/2);else if(3==d)_=n.readUnicode(e,m,f/2);else if(1==u)_=n.readASCII(e,m,f),console.warn(`reading unknown MAC encoding ${d} as ASCII`);else throw`unknown encoding ${d}, platformID: ${u}`;let g=`p${u},${c.toString(16)}`;null==l[g]&&(l[g]={}),l[g][void 0!==$?$:h]=_,l[g]._lang=c}for(var v in l)if(null!=l[v].postScriptName&&1033==l[v]._lang)return l[v];for(var v in l)if(null!=l[v].postScriptName&&0==l[v]._lang)return l[v];for(var v in l)if(null!=l[v].postScriptName&&3084==l[v]._lang)return l[v];for(var v in l)if(null!=l[v].postScriptName)return l[v];let y;for(var v in l){y=v;break}return console.warn(`returning name table with languageID ${l[y]._lang}`),l[y]},tM["OS/2"]={},tM["OS/2"].parse=(e,t,r)=>{let n=tM._bin,l=n.readUshort(e,t);t+=2;let a={};if(0==l)tM["OS/2"].version0(e,t,a);else if(1==l)tM["OS/2"].version1(e,t,a);else if(2==l||3==l||4==l)tM["OS/2"].version2(e,t,a);else if(5==l)tM["OS/2"].version5(e,t,a);else throw`unknown OS/2 table version: ${l}`;return a},tM["OS/2"].version0=(e,t,r)=>{let n=tM._bin;return r.xAvgCharWidth=n.readShort(e,t),t+=2,r.usWeightClass=n.readUshort(e,t),t+=2,r.usWidthClass=n.readUshort(e,t),t+=2,r.fsType=n.readUshort(e,t),t+=2,r.ySubscriptXSize=n.readShort(e,t),t+=2,r.ySubscriptYSize=n.readShort(e,t),t+=2,r.ySubscriptXOffset=n.readShort(e,t),t+=2,r.ySubscriptYOffset=n.readShort(e,t),t+=2,r.ySuperscriptXSize=n.readShort(e,t),t+=2,r.ySuperscriptYSize=n.readShort(e,t),t+=2,r.ySuperscriptXOffset=n.readShort(e,t),t+=2,r.ySuperscriptYOffset=n.readShort(e,t),t+=2,r.yStrikeoutSize=n.readShort(e,t),t+=2,r.yStrikeoutPosition=n.readShort(e,t),t+=2,r.sFamilyClass=n.readShort(e,t),t+=2,r.panose=n.readBytes(e,t,10),t+=10,r.ulUnicodeRange1=n.readUint(e,t),t+=4,r.ulUnicodeRange2=n.readUint(e,t),t+=4,r.ulUnicodeRange3=n.readUint(e,t),t+=4,r.ulUnicodeRange4=n.readUint(e,t),t+=4,r.achVendID=[n.readInt8(e,t),n.readInt8(e,t+1),n.readInt8(e,t+2),n.readInt8(e,t+3)],t+=4,r.fsSelection=n.readUshort(e,t),t+=2,r.usFirstCharIndex=n.readUshort(e,t),t+=2,r.usLastCharIndex=n.readUshort(e,t),t+=2,r.sTypoAscender=n.readShort(e,t),t+=2,r.sTypoDescender=n.readShort(e,t),t+=2,r.sTypoLineGap=n.readShort(e,t),t+=2,r.usWinAscent=n.readUshort(e,t),t+=2,r.usWinDescent=n.readUshort(e,t),t+=2},tM["OS/2"].version1=(e,t,r)=>{let n=tM._bin;return t=tM["OS/2"].version0(e,t,r),r.ulCodePageRange1=n.readUint(e,t),t+=4,r.ulCodePageRange2=n.readUint(e,t),t+=4},tM["OS/2"].version2=(e,t,r)=>{let n=tM._bin;return t=tM["OS/2"].version1(e,t,r),r.sxHeight=n.readShort(e,t),t+=2,r.sCapHeight=n.readShort(e,t),t+=2,r.usDefault=n.readUshort(e,t),t+=2,r.usBreak=n.readUshort(e,t),t+=2,r.usMaxContext=n.readUshort(e,t),t+=2},tM["OS/2"].version5=(e,t,r)=>{let n=tM._bin;return t=tM["OS/2"].version2(e,t,r),r.usLowerOpticalPointSize=n.readUshort(e,t),t+=2,r.usUpperOpticalPointSize=n.readUshort(e,t),t+=2},tM.post={},tM.post.parse=(e,t,r)=>{let n=tM._bin,l={};return l.version=n.readFixed(e,t),t+=4,l.italicAngle=n.readFixed(e,t),t+=4,l.underlinePosition=n.readShort(e,t),t+=2,l.underlineThickness=n.readShort(e,t),t+=2,l},tM.SVG={},tM.SVG.parse=(e,t,r)=>{let n=tM._bin,l={entries:[]},a=t;n.readUshort(e,t),t+=2;let o=n.readUint(e,t);t+=4,n.readUint(e,t),t+=4,t=o+a;let i=n.readUshort(e,t);t+=2;for(let s=0;s<i;s++){let u=n.readUshort(e,t);t+=2;let d=n.readUshort(e,t);t+=2;let c=n.readUint(e,t);t+=4;let h=n.readUint(e,t);t+=4;let f=new Uint8Array(e.buffer,a+c+o,h),p=n.readUTF8(f,0,f.length);for(let $=u;$<=d;$++)l.entries[$]=p}return l},tM.SVG.toPath=e=>{let t={cmds:[],crds:[]};if(null==e)return t;let r=new DOMParser,n=r.parseFromString(e,"image/svg+xml"),l=n.firstChild;for(;"svg"!=l.tagName;)l=l.nextSibling;let a=l.getAttribute("viewBox");a=a?a.trim().split(" ").map(parseFloat):[0,0,1e3,1e3],tM.SVG._toPath(l.children,t);for(let o=0;o<t.crds.length;o+=2){let i=t.crds[o],s=t.crds[o+1];i-=a[0],s-=a[1],s=-s,t.crds[o]=i,t.crds[o+1]=s}return t},tM.SVG._toPath=(e,t,r)=>{for(let n=0;n<e.length;n++){let l=e[n],a=l.tagName,o=l.getAttribute("fill");if(null==o&&(o=r),"g"==a)tM.SVG._toPath(l.children,t,o);else if("path"==a){t.cmds.push(o||"#000000");let i=l.getAttribute("d"),s=tM.SVG._tokens(i);tM.SVG._toksToPath(s,t),t.cmds.push("X")}else"defs"==a||console.warn(a,l)}},tM.SVG._tokens=e=>{let t=[],r=0,n=!1,l="";for(;r<e.length;){let a=e.charCodeAt(r),o=e.charAt(r);r++;let i=48<=a&&a<=57||"."==o||"-"==o;n?"-"==o?(t.push(parseFloat(l)),l=o):i?l+=o:(t.push(parseFloat(l)),","!=o&&" "!=o&&t.push(o),n=!1):i?(l=o,n=!0):","!=o&&" "!=o&&t.push(o)}return n&&t.push(parseFloat(l)),t},tM.SVG._toksToPath=(e,t)=>{let r=0,n=0,l=0,a=0,o=0,i={M:2,L:2,H:1,V:1,S:4,C:6},s=t.cmds,u=t.crds;for(;r<e.length;){let d=e[r];if(r++,"z"==d)s.push("Z"),n=a,l=o;else{let c=d.toUpperCase(),h=i[c],f=tM.SVG._reps(e,r,h);for(let p=0;p<f;p++){let $=0,m=0;if(d!=c&&($=n,m=l),"M"==c)n=$+e[r++],l=m+e[r++],s.push("M"),u.push(n,l),a=n,o=l;else if("L"==c)n=$+e[r++],l=m+e[r++],s.push("L"),u.push(n,l);else if("H"==c)n=$+e[r++],s.push("L"),u.push(n,l);else if("V"==c)l=m+e[r++],s.push("L"),u.push(n,l);else if("C"==c){var _=$+e[r++],g=m+e[r++],v=$+e[r++],y=m+e[r++],b=$+e[r++],S=m+e[r++];s.push("C"),u.push(_,g,v,y,b,S),n=b,l=S}else if("S"==c){let U=Math.max(u.length-4,0);var _=n+n-u[U],g=l+l-u[U+1],v=$+e[r++],y=m+e[r++],b=$+e[r++],S=m+e[r++];s.push("C"),u.push(_,g,v,y,b,S),n=b,l=S}else console.warn(`Unknown SVG command ${d}`)}}}},tM.SVG._reps=(e,t,r)=>{let n=t;for(;n<e.length&&"string"!=typeof e[n];)n+=r;return(n-t)/r},null==tM&&(tM={}),null==tM.U&&(tM.U={}),tM.U.codeToGlyph=(e,t)=>{let r=e.cmap,n=-1;if(null!=r.p0e4?n=r.p0e4:null!=r.p3e1?n=r.p3e1:null!=r.p1e0?n=r.p1e0:null!=r.p0e3&&(n=r.p0e3),-1==n)throw"no familiar platform and encoding!";let l=r.tables[n];if(0==l.format)return t>=l.map.length?0:l.map[t];if(4==l.format){let a=-1;for(var o=0;o<l.endCount.length;o++)if(t<=l.endCount[o]){a=o;break}if(-1==a||l.startCount[a]>t)return 0;let i=0;return 65535&(i=0!=l.idRangeOffset[a]?l.glyphIdArray[t-l.startCount[a]+(l.idRangeOffset[a]>>1)-(l.idRangeOffset.length-a)]:t+l.idDelta[a])}if(12==l.format){if(t>l.groups[l.groups.length-1][1])return 0;for(var o=0;o<l.groups.length;o++){let s=l.groups[o];if(s[0]<=t&&t<=s[1])return s[2]+(t-s[0])}return 0}throw`unknown cmap table format ${l.format}`},tM.U.glyphToPath=(e,t)=>{let r={cmds:[],crds:[]};if(e.SVG&&e.SVG.entries[t]){let n=e.SVG.entries[t];return null==n?r:("string"==typeof n&&(n=tM.SVG.toPath(n),e.SVG.entries[t]=n),n)}if(e.CFF){let l={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:e.CFF.Private?e.CFF.Private.defaultWidthX:0,open:!1},a=e.CFF,o=e.CFF.Private;if(a.ROS){let i=0;for(;a.FDSelect[i+2]<=t;)i+=2;o=a.FDArray[a.FDSelect[i+1]].Private}tM.U._drawCFF(e.CFF.CharStrings[t],l,a,o,r)}else e.glyf&&tM.U._drawGlyf(t,e,r);return r},tM.U._drawGlyf=(e,t,r)=>{let n=t.glyf[e];null==n&&(n=t.glyf[e]=tM.glyf._parseGlyf(t,e)),null!=n&&(n.noc>-1?tM.U._simpleGlyph(n,r):tM.U._compoGlyph(n,t,r))},tM.U._simpleGlyph=(e,t)=>{for(let r=0;r<e.noc;r++){let n=0==r?0:e.endPts[r-1]+1,l=e.endPts[r];for(let a=n;a<=l;a++){let o=a==n?l:a-1,i=a==l?n:a+1,s=1&e.flags[a],u=1&e.flags[o],d=1&e.flags[i],c=e.xs[a],h=e.ys[a];if(a==n){if(s){if(u)tM.U.P.moveTo(t,e.xs[o],e.ys[o]);else{tM.U.P.moveTo(t,c,h);continue}}else u?tM.U.P.moveTo(t,e.xs[o],e.ys[o]):tM.U.P.moveTo(t,(e.xs[o]+c)/2,(e.ys[o]+h)/2)}s?u&&tM.U.P.lineTo(t,c,h):d?tM.U.P.qcurveTo(t,c,h,e.xs[i],e.ys[i]):tM.U.P.qcurveTo(t,c,h,(c+e.xs[i])/2,(h+e.ys[i])/2)}tM.U.P.closePath(t)}},tM.U._compoGlyph=({parts:e},t,{crds:r,cmds:n})=>{for(let l=0;l<e.length;l++){let a={cmds:[],crds:[]},o=e[l];tM.U._drawGlyf(o.glyphIndex,t,a);let i=o.m;for(var s=0;s<a.crds.length;s+=2){let u=a.crds[s],d=a.crds[s+1];r.push(u*i.a+d*i.b+i.tx),r.push(u*i.c+d*i.d+i.ty)}for(var s=0;s<a.cmds.length;s++)n.push(a.cmds[s])}},tM.U._getGlyphClass=(e,t)=>{let r=tM._lctf.getInterval(t,e);return -1==r?0:t[r+2]},tM.U.getPairAdjustment=(e,t,r)=>{let n=!1;if(e.GPOS){let l=e.GPOS,a=l.lookupList,o=l.featureList,i=[];for(var s=0;s<o.length;s++){let u=o[s];if("kern"==u.tag){n=!0;for(let d=0;d<u.tab.length;d++){if(i[u.tab[d]])continue;i[u.tab[d]]=!0;let c=a[u.tab[d]];for(let h=0;h<c.tabs.length;h++){if(null==c.tabs[h])continue;let f=c.tabs[h],p;if(!f.coverage||-1!=(p=tM._lctf.coverageIndex(f.coverage,t))){if(1==c.ltype);else if(2==c.ltype){let $=null;if(1==f.fmt){let m=f.pairsets[p];for(var s=0;s<m.length;s++)m[s].gid2==r&&($=m[s])}else if(2==f.fmt){let _=tM.U._getGlyphClass(t,f.classDef1),g=tM.U._getGlyphClass(r,f.classDef2);$=f.matrix[_][g]}if($){let v=0;return $.val1&&$.val1[2]&&(v+=$.val1[2]),$.val2&&$.val2[0]&&(v+=$.val2[0]),v}}}}}}}}if(e.kern&&!n){let y=e.kern.glyph1.indexOf(t);if(-1!=y){let b=e.kern.rval[y].glyph2.indexOf(r);if(-1!=b)return e.kern.rval[y].vals[b]}}return 0},tM.U.stringToGlyphs=(e,t)=>{let r=[];for(var n=0;n<t.length;n++){var l=t.codePointAt(n);l>65535&&n++,r.push(tM.U.codeToGlyph(e,l))}for(var n=0;n<t.length;n++){var l=t.codePointAt(n);if(2367==l){let a=r[n-1];r[n-1]=r[n],r[n]=a}l>65535&&n++}let o=e.GSUB;if(null==o)return r;let i=o.lookupList,s=o.featureList,u=["rlig","liga","mset","isol","init","fina","medi","half","pres","blws"],d=[];for(let c=0;c<s.length;c++){let h=s[c];if(u.includes(h.tag))for(let f=0;f<h.tab.length;f++){if(d[h.tab[f]])continue;d[h.tab[f]]=!0;let p=i[h.tab[f]];for(let $=0;$<r.length;$++){let m=tM.U._getWPfeature(t,$);"isol,init,fina,medi".includes(h.tag)&&h.tag!=m||tM.U._applySubs(r,$,p,i)}}}return r},tM.U._getWPfeature=(e,t)=>{let r='\n	" ,.:;!?()  ،',n="آأؤإاةدذرزوٱٲٳٵٶٷڈډڊڋڌڍڎڏڐڑڒړڔڕږڗژڙۀۃۄۅۆۇۈۉۊۋۍۏےۓەۮۯܐܕܖܗܘܙܞܨܪܬܯݍݙݚݛݫݬݱݳݴݸݹࡀࡆࡇࡉࡔࡧࡩࡪࢪࢫࢬࢮࢱࢲࢹૅેૉ૊૎૏ૐ૑૒૝ૡ૤૯஁ஃ஄அஉ஌எஏ஑னப஫஬",l="ꡲ્૗",a=0==t||r.includes(e[t-1]),o=t==e.length-1||r.includes(e[t+1]);!a&&n.includes(e[t-1])&&(a=!0),!o&&n.includes(e[t])&&(o=!0),!o&&l.includes(e[t+1])&&(o=!0),!a&&l.includes(e[t])&&(a=!0);let i=null;return a?o?"isol":"init":o?"fina":"medi"},tM.U._applySubs=(e,t,{tabs:r,ltype:n},l)=>{let a=e.length-t-1;for(let o=0;o<r.length;o++){if(null==r[o])continue;let i=r[o],s;if(!i.coverage||-1!=(s=tM._lctf.coverageIndex(i.coverage,e[t]))){if(1==n)e[t],1==i.fmt?e[t]=e[t]+i.delta:e[t]=i.newg[s];else if(4==n){let u=i.vals[s];for(var d=0;d<u.length;d++){let c=u[d],h=c.chain.length;if(h>a)continue;var f=!0;let p=0;for(var $=0;$<h;$++){for(;-1==e[t+p+(1+$)];)p++;c.chain[$]!=e[t+p+(1+$)]&&(f=!1)}if(f){e[t]=c.nglyph;for(var $=0;$<h+p;$++)e[t+$+1]=-1;break}}}else if(5==n&&2==i.fmt){var m=tM._lctf.getInterval(i.cDef,e[t]);let _=i.cDef[m+2],g=i.scset[_];for(var v=0;v<g.length;v++){let y=g[v],b=y.input;if(b.length>a)continue;for(var f=!0,$=0;$<b.length;$++){let S=tM._lctf.getInterval(i.cDef,e[t+1+$]);if(-1==m&&i.cDef[S+2]!=b[$]){f=!1;break}}if(!f)continue;let U=y.substLookupRecords;for(var d=0;d<U.length;d+=2)U[d],U[d+1]}}else if(6==n&&3==i.fmt){if(!tM.U._glsCovered(e,i.backCvg,t-i.backCvg.length)||!tM.U._glsCovered(e,i.inptCvg,t)||!tM.U._glsCovered(e,i.ahedCvg,t+i.inptCvg.length))continue;let w=i.lookupRec;for(var v=0;v<w.length;v+=2){let x=w[v],C=l[w[v+1]];tM.U._applySubs(e,t+x,C,l)}}}}},tM.U._glsCovered=(e,t,r)=>{for(let n=0;n<t.length;n++){let l=tM._lctf.coverageIndex(t[n],e[r+n]);if(-1==l)return!1}return!0},tM.U.glyphsToPath=(e,t,r)=>{let n={cmds:[],crds:[]},l=0;for(let a=0;a<t.length;a++){let o=t[a];if(-1==o)continue;let i=a<t.length-1&&-1!=t[a+1]?t[a+1]:0,s=tM.U.glyphToPath(e,o);for(var u=0;u<s.crds.length;u+=2)n.crds.push(s.crds[u]+l),n.crds.push(s.crds[u+1]);r&&n.cmds.push(r);for(var u=0;u<s.cmds.length;u++)n.cmds.push(s.cmds[u]);r&&n.cmds.push("X"),l+=e.hmtx.aWidth[o],a<t.length-1&&(l+=tM.U.getPairAdjustment(e,o,i))}return n},tM.U.pathToSVG=({cmds:e,crds:t},r)=>{null==r&&(r=5);let n=[],l=0,a={M:2,L:2,Q:4,C:6};for(let o=0;o<e.length;o++){let i=e[o],s=l+(a[i]?a[i]:0);for(n.push(i);l<s;){let u=t[l++];n.push(parseFloat(u.toFixed(r))+(l==s?"":" "))}}return n.join("")},tM.U.pathToContext=(e,t)=>{let r=0,n=e.crds;for(let l=0;l<e.cmds.length;l++){let a=e.cmds[l];"M"==a?(t.moveTo(n[r],n[r+1]),r+=2):"L"==a?(t.lineTo(n[r],n[r+1]),r+=2):"C"==a?(t.bezierCurveTo(n[r],n[r+1],n[r+2],n[r+3],n[r+4],n[r+5]),r+=6):"Q"==a?(t.quadraticCurveTo(n[r],n[r+1],n[r+2],n[r+3]),r+=4):"#"==a.charAt(0)?(t.beginPath(),t.fillStyle=a):"Z"==a?t.closePath():"X"==a&&t.fill()}},tM.U.P={},tM.U.P.moveTo=({cmds:e,crds:t},r,n)=>{e.push("M"),t.push(r,n)},tM.U.P.lineTo=({cmds:e,crds:t},r,n)=>{e.push("L"),t.push(r,n)},tM.U.P.curveTo=({cmds:e,crds:t},r,n,l,a,o,i)=>{e.push("C"),t.push(r,n,l,a,o,i)},tM.U.P.qcurveTo=({cmds:e,crds:t},r,n,l,a)=>{e.push("Q"),t.push(r,n,l,a)},tM.U.P.closePath=({cmds:e})=>{e.push("Z")},tM.U._drawCFF=(e,t,r,n,l)=>{let a=t.stack,o=t.nStems,i=t.haveWidth,s=t.width,u=t.open,d=0,c=t.x,h=t.y,f=0,p=0,$=0,m=0,_=0,g=0,v=0,y=0,b=0,S=0,U={val:0,size:0};for(;d<e.length;){tM.CFF.getCharString(e,d,U);let w=U.val;if(d+=U.size,"o1"==w||"o18"==w)(x=a.length%2!=0)&&!i&&(s=a.shift()+n.nominalWidthX),o+=a.length>>1,a.length=0,i=!0;else if("o3"==w||"o23"==w)(x=a.length%2!=0)&&!i&&(s=a.shift()+n.nominalWidthX),o+=a.length>>1,a.length=0,i=!0;else if("o4"==w)a.length>1&&!i&&(s=a.shift()+n.nominalWidthX,i=!0),u&&tM.U.P.closePath(l),h+=a.pop(),tM.U.P.moveTo(l,c,h),u=!0;else if("o5"==w)for(;a.length>0;)c+=a.shift(),h+=a.shift(),tM.U.P.lineTo(l,c,h);else if("o6"==w||"o7"==w){var x,C=a.length;let k="o6"==w;for(let F=0;F<C;F++){let P=a.shift();k?c+=P:h+=P,k=!k,tM.U.P.lineTo(l,c,h)}}else if("o8"==w||"o24"==w){for(var C=a.length,L=0;L+6<=C;)f=c+a.shift(),p=h+a.shift(),$=f+a.shift(),m=p+a.shift(),c=$+a.shift(),h=m+a.shift(),tM.U.P.curveTo(l,f,p,$,m,c,h),L+=6;"o24"==w&&(c+=a.shift(),h+=a.shift(),tM.U.P.lineTo(l,c,h))}else if("o11"==w)break;else if("o1234"==w||"o1235"==w||"o1236"==w||"o1237"==w)"o1234"==w&&(f=c+a.shift(),p=h,$=f+a.shift(),m=p+a.shift(),b=$+a.shift(),S=m,_=b+a.shift(),g=m,v=_+a.shift(),y=h,c=v+a.shift(),tM.U.P.curveTo(l,f,p,$,m,b,S),tM.U.P.curveTo(l,_,g,v,y,c,h)),"o1235"==w&&(f=c+a.shift(),p=h+a.shift(),$=f+a.shift(),m=p+a.shift(),b=$+a.shift(),S=m+a.shift(),_=b+a.shift(),g=S+a.shift(),v=_+a.shift(),y=g+a.shift(),c=v+a.shift(),h=y+a.shift(),a.shift(),tM.U.P.curveTo(l,f,p,$,m,b,S),tM.U.P.curveTo(l,_,g,v,y,c,h)),"o1236"==w&&(f=c+a.shift(),p=h+a.shift(),$=f+a.shift(),m=p+a.shift(),b=$+a.shift(),S=m,_=b+a.shift(),g=m,v=_+a.shift(),y=g+a.shift(),c=v+a.shift(),tM.U.P.curveTo(l,f,p,$,m,b,S),tM.U.P.curveTo(l,_,g,v,y,c,h)),"o1237"==w&&(f=c+a.shift(),p=h+a.shift(),$=f+a.shift(),m=p+a.shift(),b=$+a.shift(),S=m+a.shift(),_=b+a.shift(),g=S+a.shift(),Math.abs((v=_+a.shift())-c)>Math.abs((y=g+a.shift())-h)?c=v+a.shift():h=y+a.shift(),tM.U.P.curveTo(l,f,p,$,m,b,S),tM.U.P.curveTo(l,_,g,v,y,c,h));else if("o14"==w){if(a.length>0&&!i&&(s=a.shift()+r.nominalWidthX,i=!0),4==a.length){let T=a.shift(),B=a.shift(),V=a.shift(),I=a.shift(),E=tM.CFF.glyphBySE(r,V),N=tM.CFF.glyphBySE(r,I);tM.U._drawCFF(r.CharStrings[E],t,r,n,l),t.x=T,t.y=B,tM.U._drawCFF(r.CharStrings[N],t,r,n,l)}u&&(tM.U.P.closePath(l),u=!1)}else if("o19"==w||"o20"==w)(x=a.length%2!=0)&&!i&&(s=a.shift()+n.nominalWidthX),o+=a.length>>1,a.length=0,i=!0,d+=o+7>>3;else if("o21"==w)a.length>2&&!i&&(s=a.shift()+n.nominalWidthX,i=!0),h+=a.pop(),c+=a.pop(),u&&tM.U.P.closePath(l),tM.U.P.moveTo(l,c,h),u=!0;else if("o22"==w)a.length>1&&!i&&(s=a.shift()+n.nominalWidthX,i=!0),c+=a.pop(),u&&tM.U.P.closePath(l),tM.U.P.moveTo(l,c,h),u=!0;else if("o25"==w){for(;a.length>6;)c+=a.shift(),h+=a.shift(),tM.U.P.lineTo(l,c,h);f=c+a.shift(),p=h+a.shift(),$=f+a.shift(),m=p+a.shift(),c=$+a.shift(),h=m+a.shift(),tM.U.P.curveTo(l,f,p,$,m,c,h)}else if("o26"==w)for(a.length%2&&(c+=a.shift());a.length>0;)f=c,p=h+a.shift(),$=f+a.shift(),m=p+a.shift(),c=$,h=m+a.shift(),tM.U.P.curveTo(l,f,p,$,m,c,h);else if("o27"==w)for(a.length%2&&(h+=a.shift());a.length>0;)f=c+a.shift(),p=h,$=f+a.shift(),m=p+a.shift(),c=$+a.shift(),h=m,tM.U.P.curveTo(l,f,p,$,m,c,h);else if("o10"==w||"o29"==w){let A="o10"==w?n:r;if(0==a.length)console.warn("error: empty stack");else{let G=a.pop(),z=A.Subrs[G+A.Bias];t.x=c,t.y=h,t.nStems=o,t.haveWidth=i,t.width=s,t.open=u,tM.U._drawCFF(z,t,r,n,l),c=t.x,h=t.y,o=t.nStems,i=t.haveWidth,s=t.width,u=t.open}}else if("o30"==w||"o31"==w){let O=a.length,D=a.length;var L=0;let q="o31"==w;for(O=-3&D,L+=D-O;L<O;)q?(f=c+a.shift(),p=h,$=f+a.shift(),h=(m=p+a.shift())+a.shift(),O-L==5?(c=$+a.shift(),L++):c=$,q=!1):(f=c,p=h+a.shift(),$=f+a.shift(),m=p+a.shift(),c=$+a.shift(),O-L==5?(h=m+a.shift(),L++):h=m,q=!0),tM.U.P.curveTo(l,f,p,$,m,c,h),L+=4}else if("o"==`${w}`.charAt(0))throw console.warn(`Unknown operation: ${w}`,e),w;else a.push(w)}t.x=c,t.y=h,t.nStems=o,t.haveWidth=i,t.width=s,t.open=u},tq.Typr=tM;let t9,tH=tq,tR={aalt:"Access All Alternates",abvf:"Above-base Forms",abvm:"Above - base Mark Positioning",abvs:"Above - base Substitutions",afrc:"Alternative Fractions",akhn:"Akhands",blwf:"Below - base Forms",blwm:"Below - base Mark Positioning",blws:"Below - base Substitutions",calt:"Contextual Alternates",case:"Case - Sensitive Forms",ccmp:"Glyph Composition / Decomposition",cfar:"Conjunct Form After Ro",cjct:"Conjunct Forms",clig:"Contextual Ligatures",cpct:"Centered CJK Punctuation",cpsp:"Capital Spacing",cswh:"Contextual Swash",curs:"Cursive Positioning",c2pc:"Petite Capitals From Capitals",c2sc:"Small Capitals From Capitals",dist:"Distances",dlig:"Discretionary Ligatures",dnom:"Denominators",dtls:"Dotless Forms",expt:"Expert Forms",falt:"Final Glyph on Line Alternates",fin2:"Terminal Forms #2",fin3:"Terminal Forms #3",fina:"Terminal Forms",flac:"Flattened accent forms",frac:"Fractions",fwid:"Full Widths",half:"Half Forms",haln:"Halant Forms",halt:"Alternate Half Widths",hist:"Historical Forms",hkna:"Horizontal Kana Alternates",hlig:"Historical Ligatures",hngl:"Hangul",hojo:"Hojo Kanji Forms(JIS X 0212 - 1990 Kanji Forms)",hwid:"Half Widths",init:"Initial Forms",isol:"Isolated Forms",ital:"Italics",jalt:"Justification Alternates",jp78:"JIS78 Forms",jp83:"JIS83 Forms",jp90:"JIS90 Forms",jp04:"JIS2004 Forms",kern:"Kerning",lfbd:"Left Bounds",liga:"Standard Ligatures",ljmo:"Leading Jamo Forms",lnum:"Lining Figures",locl:"Localized Forms",ltra:"Left - to - right alternates",ltrm:"Left - to - right mirrored forms",mark:"Mark Positioning",med2:"Medial Forms #2",medi:"Medial Forms",mgrk:"Mathematical Greek",mkmk:"Mark to Mark Positioning",mset:"Mark Positioning via Substitution",nalt:"Alternate Annotation Forms",nlck:"NLC Kanji Forms",nukt:"Nukta Forms",numr:"Numerators",onum:"Oldstyle Figures",opbd:"Optical Bounds",ordn:"Ordinals",ornm:"Ornaments",palt:"Proportional Alternate Widths",pcap:"Petite Capitals",pkna:"Proportional Kana",pnum:"Proportional Figures",pref:"Pre - Base Forms",pres:"Pre - base Substitutions",pstf:"Post - base Forms",psts:"Post - base Substitutions",pwid:"Proportional Widths",qwid:"Quarter Widths",rand:"Randomize",rclt:"Required Contextual Alternates",rkrf:"Rakar Forms",rlig:"Required Ligatures",rphf:"Reph Forms",rtbd:"Right Bounds",rtla:"Right - to - left alternates",rtlm:"Right - to - left mirrored forms",ruby:"Ruby Notation Forms",rvrn:"Required Variation Alternates",salt:"Stylistic Alternates",sinf:"Scientific Inferiors",size:"Optical size",smcp:"Small Capitals",smpl:"Simplified Forms",ssty:"Math script style alternates",stch:"Stretching Glyph Decomposition",subs:"Subscript",sups:"Superscript",swsh:"Swash",titl:"Titling",tjmo:"Trailing Jamo Forms",tnam:"Traditional Name Forms",tnum:"Tabular Figures",trad:"Traditional Forms",twid:"Third Widths",unic:"Unicase",valt:"Alternate Vertical Metrics",vatu:"Vattu Variants",vert:"Vertical Writing",vhal:"Alternate Vertical Half Metrics",vjmo:"Vowel Jamo Forms",vkna:"Vertical Kana Alternates",vkrn:"Vertical Kerning",vpal:"Proportional Alternate Vertical Metrics",vrt2:"Vertical Alternates and Rotation",vrtr:"Vertical Alternates for Rotation",zero:"Slashed Zero"},tj=(()=>{class e{constructor(e){let t=tH.Typr.parse(e);if(!t.length||"object"!=typeof t[0]||"function"!=typeof t[0].hasOwnProperty)throw"unable to parse font";for(let r in t[0])this[r]=t[0][r];this.enabledGSUB={}}getFamilyName(){return this.name&&(this.name.typoFamilyName||this.name.fontFamily)||""}getSubFamilyName(){return this.name&&(this.name.typoSubfamilyName||this.name.fontSubfamily)||""}glyphToPath(e){return tH.Typr.U.glyphToPath(this,e)}getPairAdjustment(e,t){return tH.Typr.U.getPairAdjustment(this,e,t)}stringToGlyphs(e){return tH.Typr.U.stringToGlyphs(this,e)}glyphsToPath(e){return tH.Typr.U.glyphsToPath(this,e)}pathToSVG(e,t){return tH.Typr.U.pathToSVG(e,t)}pathToContext(e,t){return tH.Typr.U.pathToContext(e,t)}lookupFriendlyName(e,t){if(void 0!==this[e]){let r=this[e],n=r.featureList[t];return this.featureFriendlyName(n)}return""}featureFriendlyName({tag:e,featureParams:t}){if(tR[e])return tR[e];if(e.match(/ss[0-2][0-9]/)){let r=`Stylistic Set ${Number(e.substr(2,2)).toString()}`;if(t){let n=tH.Typr._bin.readUshort(this._data,t);if(0===n){let l=tH.Typr._bin.readUshort(this._data,t+2);if(this.name&&void 0!==this.name[l])return`${r} - ${this.name[l]}`}}return r}return e.match(/cv[0-9][0-9]/)?`Character Variant ${Number(e.substr(2,2)).toString()}`:""}enableGSUB(e){if(this.GSUB){let t=this.GSUB.featureList[e];if(t)for(let r=0;r<t.tab.length;++r)this.enabledGSUB[t.tab[r]]=(this.enabledGSUB[t.tab[r]]||0)+1}}disableGSUB(e){if(this.GSUB){let t=this.GSUB.featureList[e];if(t)for(let r=0;r<t.tab.length;++r)this.enabledGSUB[t.tab[r]]>1?--this.enabledGSUB[t.tab[r]]:delete this.enabledGSUB[t.tab[r]]}}codeToGlyph(e){let t=tH.Typr.U.codeToGlyph(this,e);if(this.GSUB){let r=[t];for(let n in this.enabledGSUB){let l=this.GSUB.lookupList[n];tH.Typr.U._applySubs(r,0,l,this.GSUB.lookupList)}if(1===r.length)return r[0]}return t}}return e})();function tW(e){let t,r,l,a=e.querySelectorAll("style"),o;for(let i=0;i<a.length;i++)if(null==(t=a[i].textContent)?void 0:t.includes("font-cxsecret")){o=a[i];break}if(!o)return;let s=null==(l=null==(r=o.textContent)?void 0:r.match(/base64,([\w\W]+?)'/))?void 0:l[1];if(!s)return;let u=function e(t){let r=window.atob(t),n=new Uint8Array(r.length);for(let l=0;l<r.length;++l)n[l]=r.charCodeAt(l);return n}(s),d=new t9(u),c=JSON.parse(ee("ttf")),h={};for(let f=19968;f<40870;f++){let p=d.codeToGlyph(f);if(!p)continue;let $=d.glyphToPath(p),m=n(JSON.stringify($)).slice(24);h[f]=c[m]}let _=e.querySelectorAll(".font-cxsecret");for(let g of _){let v=g.innerHTML;for(let y in h){let b=String.fromCharCode(h[y]),S=RegExp(String.fromCharCode(Number(y)),"g");v=v.replace(S,b)}g.innerHTML=v,g.classList.remove("font-cxsecret")}}t9=tj;let tQ=e=>new Promise(t=>setTimeout(t,1e3*e)),tX={单选题:"0",多选题:"1",填空题:"2",判断题:"3",简答题:"4",名词解释:"5",论述题:"6",计算题:"7"};class tJ{constructor(){d(this,"_document",document),d(this,"_window",en),d(this,"addLog"),d(this,"addQuestion"),d(this,"questions",[]),d(this,"correctRate",0),d(this,"parseHtml",()=>{throw Error("请使用继承类的重写方法")}),d(this,"fillQuestion",e=>{throw Error("请使用继承类的重写方法")}),d(this,"removeHtml",e=>null==e?"":e.replace(/<((?!img|sub|sup|br)[^>]+)>/g,"").replace(/&nbsp;/g," ").replace(/\s+/g," ").replace(/<br\s*\/?>/g,"\n").replace(/<img.*?src="(.*?)".*?>/g,'<img src="$1"/>').trim());let e=eu(),t=ed();this.addLog=e.addLog,this.addQuestion=t.addQuestion}}let tK=e=>({code:-1,data:{answer:[],num:"",usenum:""},msg:e}),tY=async e=>{let t,r=ea(),n={"Content-Type":"application/json",referer:e.refer},l=JSON.stringify({question:e.title,options:Object.keys(e.options),type:tX[e.type],questionData:e.element.outerHTML,workType:e.workType,id:(null==(t=e.refer.match(/courseId=(\d+)/))?void 0:t[1])||"",key:r.queryApis[0].token});return await tQ(r.otherParams.params[0].value),new Promise(e=>{er({url:"http://api.tikuhai.com/search",method:"POST",headers:n,data:l,timeout:5e3,onload({responseText:t}){try{let r=JSON.parse(t);e(r)}catch(n){e(tK("解析出错"))}},onerror:()=>e(tK("请求出错")),ontimeout:()=>e(tK("请求超时"))})})};class tZ extends tJ{constructor(e,t){super(),d(this,"type"),d(this,"init",async()=>{if(this.questions=[],this.parseHtml(),this.questions.length)for(let[e,t]of(this.addLog(`成功解析到${this.questions.length}个题目`,"primary"),this.questions.entries())){let r=await tY(t);200===r.code?(t.answer=r.data.answer,this.fillQuestion(t),this.addLog(`第${e+1}道题搜索成功`,"success"),this.addLog(`剩余次数:${r.data.num}`,"primary"),this.correctRate+=1/this.questions.length*100):-1===r.code&&(this.addLog(`第${e+1}道题搜索失败，点击上方答题查看原因`,"danger"),t.answer[0]=`${r.msg}<a style="font-weight: bold">，或可以关注公众号“高校工具箱”查题</a>`),this.addQuestion(t)}else this.addLog("未解析到题目","danger");return Promise.resolve(this.correctRate)}),d(this,"parseHtml",()=>{if(!this._document)return[];if(["zj","zj_new"].includes(this.type)){let e=this._document.querySelectorAll(".TiMu");this.addQuestions(e)}else if(["zy","ks"].includes(this.type)){let t=this._document.querySelectorAll(".questionLi");this.addQuestions(t)}}),d(this,"fillQuestion",e=>{let t,r;if(this._window){if("单选题"===e.type||"多选题"===e.type)e.answer.forEach(t=>{for(let r in e.options)if(r===this.removeHtml(t)){if(["zj"].includes(this.type)){let n=e.options[r].querySelector("input");if(null==n?void 0:n.getAttribute("checked"))return;null==n||n.click()}else if(["zj_new","zy"].includes(this.type)){let l=e.options[r];if("true"===l.getAttribute("aria-checked"))return;null==l||l.click()}else if(["ks"].includes(this.type)){let a=e.options[r];if(a.querySelector(".check_answer"))return;null==a||a.click()}}});else if("填空题"===e.type){let n=e.element.querySelectorAll("textarea");if(0===n.length)return;n.forEach((t,r)=>{try{let n=this._window.UE.getEditor(t.name);n.setContent(e.answer[r])}catch(l){t.value=""}})}else if("判断题"===e.type){let l="true";e.answer[0].match(/(^|,)(正确|是|对|√|T|ri|right|true)(,|$)/)?l="true":e.answer[0].match(/(^|,)(错误|否|错|×|F|wr|wrong|false)(,|$)/)&&(l="false");let a={true:"对",false:"错"};for(let o in e.options)if(["zj"].includes(this.type)){let i=e.options[o].querySelector(`input[value='${l}']`);if(null==i?void 0:i.getAttribute("checked"))return;null==i||i.click()}else if(["zj_new","zy"].includes(this.type)){if(null==(t=e.options[o].getAttribute("aria-label"))?void 0:t.includes(`${a[l]}选择`)){if("true"===e.options[o].getAttribute("aria-checked"))return;null==(r=e.options[o])||r.click()}}else if(["ks"].includes(this.type)){let s=e.options[o].querySelector(`span[data='${l}']`);if(null==s?void 0:s.querySelector(".check_answer"))return;null==s||s.click()}}else if("简答题"===e.type){let u=e.element.querySelector("textarea");if(!u)return;let d=this._window.UE.getEditor(u.name);d.setContent(e.answer[0])}}}),this.type=e,t&&(this._document=t.contentDocument,this._window=t.contentWindow)}extractOptions(e,t){let r={};return e.forEach(e=>{let n,l=this.removeHtml((null==(n=e.querySelector(t))?void 0:n.innerHTML)||"");r[l]=e}),r}addQuestions(e){e.forEach(e=>{let t,r,n,l="",a="",o,i={};if(["zy","ks"].includes(this.type)){let s=(null==(t=null==e?void 0:e.querySelector("h3"))?void 0:t.innerHTML)||"",u=(null==(r=e.querySelector(".colorShallow"))?void 0:r.outerHTML)||"";["zy"].includes(this.type)?a=(null==e?void 0:e.getAttribute("typename"))||"":["ks"].includes(this.type)&&(a=this.removeHtml(u).slice(1,4)||""),l=this.removeHtml(s.split(u||"")[1]||""),o=e.querySelectorAll(".answerBg"),i=this.extractOptions(o,".answer_p")}else["zj","zj_new"].includes(this.type)&&(a=(l=this.removeHtml((null==(n=e.querySelector(".fontLabel"))?void 0:n.innerHTML)||"")).slice(1,4)||"",o=e.querySelectorAll('[class*="before-after"]'),i=this.extractOptions(o,".fl.after"),l=l.replace(`【${a}】`,""));this.questions.push({element:e,type:a,title:l,options:i,answer:[],workType:["zj_new"].includes(this.type)?"zj":this.type,refer:this._window.location.href})})}}let re=()=>{let e=eu(),t=()=>{let t=window.location.href;t.includes("&mooc2=1")||(window.location.href=`${t}&mooc2=1`),e.addLog(`检测到用户进入到章节学习页面`,"primary"),e.addLog(`正在解析任务点，请稍等5-10秒（如果长时间没有反应，请刷新页面）`,"warning")},n=ea(),l=e=>{let t=document.documentElement,r=t.querySelector("iframe");if(!r){console.warn("No iframe found.");return}"WATCH"===e&&o(t),r.addEventListener("load",()=>{o(t)})},a=()=>{let e=()=>{l("INIT")};new tD(["schoolCourseInfo"],e)},o=t=>{tO.getAllNestedIframes(t).subscribe(l=>{r.from(l).pipe(tz(e=>c(e))).subscribe({async complete(){if(e.addLog(`本页任务点已全部完成，正前往下一章节`,"success"),n.platformParams.cx.parts[0].params[1].value){let r=t.querySelector("#prevNextFocusNext");(null==r?void 0:r.getAttribute("onclick"))?(await tQ(n.otherParams.params[0].value),document.querySelector(".jb_btn.jb_btn_92.fr.fs14.nextChapter").click()):e.addLog(`当前是最后一个任务点`,"success")}else e.addLog(`已经关闭自动下一章节，在设置里可更改`,"danger")}})})},i=async(t,{documentElement:r})=>new Promise(l=>{e.addLog(`发现一个${t}，正在解析`,"warning"),e.addLog(`正在尝试播放${t}，请稍等5s`,"primary");let a=!1,o=setInterval(async()=>{let i=r.querySelector(t);if(i&&!a){e.addLog("播放成功","success"),await i.pause(),i.muted=!0,await i.play();let s=async()=>{await tQ(n.otherParams.params[0].value),await i.play()};i.addEventListener("pause",s),i.addEventListener("ended",()=>{e.addLog(`${t}已播放完成`,"success"),i.removeEventListener("pause",s),l()}),a=!0,clearInterval(o)}},2500)}),s=async(t,r,l)=>(e.addLog("发现一个作业，正在解析","warning"),new Promise(async a=>{if(!r)return a();if(r.documentElement.innerText.includes("已完成")||r.documentElement.innerText.includes("待批阅"))return e.addLog("作业已经完成，跳过","success"),a();tW(r),e.addLog(`题目列表获取成功`,"primary");let o;o=t.src.includes("mooc2")?"zj_new":"zj";let i=await new tZ(o,t).init();n.platformParams.cx.parts[0].params[0].value?(e.addLog("自动提交已开启，尝试提交","primary"),i<Number(n.otherParams.params[1].value)?(e.addLog(`正确率小于${n.otherParams.params[1].value}%，暂存`,"danger"),await l.noSubmit()):(e.addLog(`正确率大于${n.otherParams.params[1].value}%，提交`,"success"),await l.btnBlueSubmit(),await tQ(n.otherParams.params[0].value),await l.submitCheckTimes(),e.addLog("提交成功","success"))):(e.addLog("未开启自动提交，暂存","primary"),l.alert=()=>{},await l.noSubmit()),e.addLog("作业已完成","success"),a()})),u=async t=>{let r=t.document.querySelector("#panView").contentWindow;return e.addLog("发现一个PPT，正在解析","warning"),await r.scrollTo({top:r.document.body.scrollHeight,behavior:"smooth"}),e.addLog("阅读完成","success"),Promise.resolve()},d=async({contentDocument:e})=>new Promise(t=>{let r=setInterval(async()=>{let n;e&&(null==(n=e)?void 0:n.readyState)=="complete"&&(t(),clearInterval(r))},500)}),c=async t=>{let r,l,a=t.src,o=t.contentDocument,c=t.contentWindow;if(!o||!c)return Promise.resolve();await d(t);let h=(null==(r=t.parentElement)?void 0:r.className)||"";if(h.includes("ans-job-finished"))e.addLog("发现一个已完成任务点","success");else{if(a.includes("api/work"))return s(t,o,c);if(n.platformParams.cx.parts[0].params[2].value)a.includes("api/work")&&e.addLog("只答题，不做其他已开启","primary");else{let f=null==(l=t.parentElement)?void 0:l.querySelector(".ans-job-icon");if(f){if(a.includes("video"))return i("video",o);if(a.includes("audio"))return i("audio",o);if(["ppt","doc","pptx","docx","pdf"].some(e=>a.includes(`modules/${e}`)))return u(c)}}}return Promise.resolve()};t(),l("WATCH"),a()},rt=async()=>{let e=eu();ea(),e.addLog(`进入新版作业页面，开始准备答题`,"primary"),e.addLog(`正在解析题目, 请等待5s`,"warning"),await new tZ("zy").init()},rr=async()=>{let e=eu(),t=ea();e.addLog(`进入新版考试页面，开始准备答题`,"primary"),e.addLog(`正在解析题目, 请等待5s`,"warning"),await new tZ("ks").init(),t.platformParams.cx.parts[1].params[0].value?(e.addLog("自动切换已开启，正在前往下一题","success"),await tQ(t.otherParams.params[0].value),document.querySelector(".jb_btn.jb_btn_92.fs14").click()):e.addLog("已经关闭自动切换，在设置里可更改","danger")};class rn extends tJ{constructor(){super(),d(this,"init",async()=>{let e;if(this.questions=[],this.parseHtml(),this.questions.length)for(let[t,r]of(this.addLog(`成功解析到${this.questions.length}个题目`,"primary"),this.questions.entries())){let n=await tY(r);200===n.code?(r.answer=n.data.answer,this.fillQuestion(r),this.addLog(`第${t+1}道题搜索成功`,"success"),this.addLog(`剩余次数:${n.data.num}`,"primary")):-1===n.code&&(this.addLog(`第${t+1}道题搜索失败，点击上方答题查看原因`,"danger"),r.answer[0]=`${n.msg}<a style="font-weight: bold">，或可以关注公众号“高校工具箱”查题</a>`),this.addQuestion(r),await (null==(e=this._document)?void 0:e.querySelectorAll(".switch-btn-box > button")[1]).click()}else this.addLog("未解析到题目，正在重试","danger")}),d(this,"parseHtml",()=>{if(!this._document)return[];let e=this._document.querySelectorAll(".examPaper_subject");this.addQuestions(e)}),d(this,"fillQuestion",e=>{if(this._window){if("单选题"===e.type||"多选题"===e.type)e.answer.forEach(t=>{for(let r in e.options)r===this.removeHtml(t)&&e.options[r].click()});else if("判断题"===e.type){let t="对";for(let r in e.answer[0].match(/(^|,)(正确|是|对|√|T|ri|right|true)(,|$)/)?t="对":e.answer[0].match(/(^|,)(错误|否|错|×|F|wr|wrong|false)(,|$)/)&&(t="错"),e.options)r===t&&e.options[r].click()}}})}extractOptions(e,t){let r={};return e.forEach(e=>{let n,l=this.removeHtml((null==(n=e.querySelector(t))?void 0:n.innerHTML)||"");r[l]=e}),r}addQuestions(e){e.forEach(e=>{let t,r,n=(null==e?void 0:e.querySelector(".subject_describe div,.smallStem_describe p")).__Ivue__._data.shadowDom.textContent,l=(null==(r=null==(t=null==e?void 0:e.querySelector(".subject_type span"))?void 0:t.textContent)?void 0:r.slice(1,4))||"",a=this.extractOptions(null==e?void 0:e.querySelectorAll(".label"),".node_detail");this.questions.push({element:e,type:l,title:n,options:a,answer:[],workType:"zhs",refer:this._window.location.href})})}}let rl=()=>{console.log("hookError");let e=en.setInterval,t=en.setTimeout;en.setInterval=function(...t){let r=Error("");return r.stack&&r.stack.includes("checkoutNotTrustScript")?-1:e.call(this,...t)},en.setTimeout=function(...e){let r=Error("");return r.stack&&r.stack.includes("checkoutNotTrustScript")?-1:t.call(this,...e)}},ra=async()=>{rl();let e=eu();ea(),e.addLog(`进入答题页面，开始准备答题`,"primary"),e.addLog(`正在解析题目, 请等待5s`,"warning"),new tD(["gateway/t/v1/student"],async()=>{await new rn().init()})},ro=e.defineComponent({name:"Index",emits:["customEvent"],setup(t,{emit:r}){let n,l=e.ref("310px"),a=e.ref(!1);null==(n=document.querySelector("a.experience:not([onclick])"))||n.click();let o=ea(),i=eu(),s=ed(),u=window.location.href;"1"===o.menuIndex?l.value="630px":l.value="310px",e.watch(()=>o.menuIndex,e=>{"1"===e?l.value="630px":l.value="310px"},{deep:!0}),i.addLog("脚本加载成功，正在解析网页","primary"),i.addLog("请不要多个脚本同时使用，会有脚本冲突问题","warning"),i.addLog("如果脚本出现异常，请用谷歌、火狐等浏览器","warning");let d=[{keyword:"/mycourse/studentstudy",logic:re},{keyword:"/mooc2/work/dowork",logic:rt},{keyword:"/exam-ans/exam",logic:rr},{keyword:"mycourse/stu?courseid",logic(){i.addLog("该页面无任务，请进入章节或答题页面使用","error")}},{keyword:"/stuExamWeb.html",logic:ra}];(e=>{for(let{keyword:t,logic:r}of d)if(e.includes(t)){r(),a.value=!0;return}a.value=!1})(u),r("customEvent",a.value);let c=[{label:"首页",icon:E,component:ep,props:{"log-list":i.logList}},{label:"答题",icon:_,component:eS,props:{"question-list":s.questionList}},{label:"设置",icon:D,component:eg,props:{"global-config":o}},{label:"代码",icon:W,component:e6},{label:"说明",icon:W,component:eA}];return(t,r)=>{let n=e.resolveComponent("el-tab-pane"),a=e.resolveComponent("el-tabs");return e.openBlock(),e.createElementBlock("div",{style:e.normalizeStyle({width:l.value}),class:"card_content"},[e.createVNode(a,{modelValue:e.unref(o).menuIndex,"onUpdate:modelValue":r[0]||(r[0]=t=>e.unref(o).menuIndex=t),class:"demo-tabs"},{default:e.withCtx(()=>[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(c,({label:t,component:r,props:l})=>e.createVNode(n,{key:t,label:t},{default:e.withCtx(()=>[r?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(r),e.normalizeProps(e.mergeProps({key:0},l)),null,16)):e.createCommentVNode("",!0)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])],4)}}}),ri=ef(ro,[["__scopeId","data-v-7ebed5db"]]),rs=e.defineComponent({name:"ZoomButtons",emits:["toggleZoom"],setup(t,{emit:r}){let n=e=>{r("toggleZoom",e)};return(t,r)=>{let l=e.resolveComponent("el-icon");return e.openBlock(),e.createElementBlock("div",{onMousedown:r[2]||(r[2]=e.withModifiers(()=>{},["stop"]))},[e.createVNode(l,{onClick:r[0]||(r[0]=e=>n(!0)),size:"small",style:{cursor:"pointer"}},{default:e.withCtx(()=>[e.createVNode(e.unref(P))]),_:1}),e.createVNode(l,{onClick:r[1]||(r[1]=e=>n(!1)),size:"small",style:{cursor:"pointer","margin-left":"8px"}},{default:e.withCtx(()=>[e.createVNode(e.unref(U))]),_:1})],32)}}}),ru={class:"overlay"},rd={class:"title"},rc=e.defineComponent({name:"layout",setup(t){let r=e.ref(!1),n=ea();e.watch(n,e=>{localStorage.setItem("config",JSON.stringify(e))},{deep:!0});let l=e.ref(!1),a=e.ref(0),o=e.ref(0),i=e.ref({left:n.position.x,top:n.position.y}),s=({clientX:e,target:t,clientY:r})=>{l.value=!0,a.value=e-t.getBoundingClientRect().left,o.value=r-t.getBoundingClientRect().top,document.addEventListener("mousemove",u),document.addEventListener("mouseup",d)},u=({clientX:e,clientY:t})=>{if(!l.value)return;let r=e-a.value,s=t-o.value;i.value={left:`${r-11}px`,top:`${s-11}px`},n.position.x=`${r-11}px`,n.position.y=`${s-11}px`,r<0&&(i.value.left="0px",n.position.x="0px"),s<0&&(i.value.top="0px",n.position.y="0px"),r>window.innerWidth-334&&(i.value.left=`${window.innerWidth-334}px`,n.position.x=`${window.innerWidth-334}px`),s>window.innerHeight-35&&(i.value.top=`${window.innerHeight-35}px`,n.position.y=`${window.innerHeight-35}px`)},d=()=>{l.value=!1,document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",d)};return(t,a)=>{let o=e.resolveComponent("el-icon"),u=e.resolveComponent("el-tooltip"),d=e.resolveComponent("el-card");return e.withDirectives((e.openBlock(),e.createElementBlock("div",{style:e.normalizeStyle(i.value),class:"main-page"},[e.withDirectives(e.createElementVNode("div",ru,null,512),[[e.vShow,l.value]]),e.createVNode(d,{style:{border:"0"},"close-on-click-modal":!1,"lock-scroll":!1,modal:!1,"show-close":!1,"modal-class":"modal"},{header:e.withCtx(()=>[e.createElementVNode("div",{class:"card-header",onMousedown:s},[e.withDirectives(e.createElementVNode("div",rd,[e.createElementVNode("span",null,e.toDisplayString(e.unref(n).platformParams[e.unref(n).platformName].name),1),r.value&&!e.unref(n).isMinus?(e.openBlock(),e.createBlock(u,{key:0,teleported:"",effect:"dark",placement:"top-start",content:"<span>注意事项：<br/>请尽量使用新版，不要使用旧版。<br/></span>","raw-content":""},{default:e.withCtx(()=>[e.createVNode(o,{style:{"margin-left":"5px"},size:"small"},{default:e.withCtx(()=>[e.createVNode(e.unref(Z))]),_:1})]),_:1})):e.createCommentVNode("",!0)],512),[[e.vShow,!e.unref(n).isMinus]]),e.createVNode(rs,{onToggleZoom:a[0]||(a[0]=t=>e.unref(n).isMinus=t)})],32)]),default:e.withCtx(()=>[e.withDirectives(e.createVNode(ri,{onCustomEvent:a[1]||(a[1]=e=>r.value=e)},null,512),[[e.vShow,!e.unref(n).isMinus]])]),_:1})],4)),[[e.vShow,r.value]])}}}),rh=ef(rc,[["__scopeId","data-v-9997d2af"]]),rf=e.defineComponent({name:"App",setup(t){let r=ea(),n=window.location.href;return n.includes("chaoxing")?r.platformName="cx":n.includes("zhihuishu")&&(r.platformName="zhs"),(t,r)=>(e.openBlock(),e.createBlock(rh))}}),rp=e=>{let t=GM_getResourceText(e),r=document.createElement("style");return r.innerText=t,document.head.append(r),t};rp("ElementPlus");let r$=()=>{let e=en.Function.prototype.call;en.Function.prototype.call=function(...t){let r,n,l=e.apply(this,t);if((null==(n=null==(r=t[0])?void 0:r.a)?void 0:n.version)==="2.5.0"){let a=t[1].exports.a.install;t[1].exports.a.install=function(...e){return e[0].mixin({mounted(){this.$el.__Ivue__=this}}),a.apply(this,e)}}return l}},r0=en.location.href;r0.includes("zhihuishu.com")&&r$();let rm=setInterval(()=>{if("complete"===document.readyState){clearInterval(rm);let r=e.createApp(rf),n=t.createPinia();r.use(n),r.use(l),r.mount((()=>{let e=document.createElement("div");return document.body.appendChild(e),e})())}},100)})(Vue,Pinia,rxjs,md5,ElementPlus);
