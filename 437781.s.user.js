// ==UserScript==
// @name         [ECUST 旧版修复] 🥇超星学习通｜知到智慧树--网课小助手|修复视频播放|自动跳转任务点|自动答题|超高题库覆盖率|逐渐支持更多平台
// @namespace    noshuang
// @version      0.1.0.E
// @author       noshuang
// @description  🏆 目前已经具有的功能包括：▶️视频自动观看，跳转下一个任务点，📄章节测试、作业自动完成，无答案自动保存💯考试自动完成，自动切换、保存。使用脚本请进入对应平台的页面。目前已经支持的平台：【超星学习通「功能基本完成」】【知到智慧树「目前只支持答题」】
// @license      MIT
// @icon         https://vitejs.dev/logo.svg
// @match        *://*.chaoxing.com/*
// @match        *://*.edu.cn/*
// @require      https://cdn.bootcdn.net/ajax/libs/vue/3.2.36/vue.global.prod.js
// @require      https://cdn.bootcdn.net/ajax/libs/vue-demi/0.14.0/index.iife.js
// @require      data:application/javascript,window.Vue%3DVue%3B
// @require      https://cdn.bootcdn.net/ajax/libs/element-plus/2.3.4/index.full.min.js
// @require      https://cdn.bootcdn.net/ajax/libs/pinia/2.0.35/pinia.iife.min.js
// @require      https://cdn.bootcdn.net/ajax/libs/rxjs/7.8.0/rxjs.umd.min.js
// @require      https://cdn.bootcdn.net/ajax/libs/blueimp-md5/2.19.0/js/md5.min.js
// @resource     ElementPlus  https://cdn.bootcdn.net/ajax/libs/element-plus/2.3.4/index.css
// @resource     ttf          https://www.forestpolice.org/ttf/2.0/table.json
// @connect      www.tiku.me
// @connect      cx.icodef.com
// @grant        GM_getResourceText
// @grant        GM_getValue
// @grant        GM_info
// @grant        GM_setValue
// @grant        GM_xmlhttpRequest
// @grant        unsafeWindow
// @run-at       document-start
// @antifeature  ads      公众号或者app辅助答题
// @antifeature  payment  付费答题
// ==/UserScript==

(e=>{let t=document.createElement("style");t.dataset.source="vite-plugin-monkey",t.textContent=e,document.head.append(t)})(" .log[data-v-d41d5897]{el-text[data-v-d41d5897] {white-space: normal;}}.setting[data-v-4489784f]{margin-top:-8px;font-size:14px}.setting[data-v-4489784f] .el-form-item[data-v-4489784f]{margin-bottom:0}.question_table[data-v-18523ca7]{width:625px}.demo-tabs[data-v-c0593cc2]{margin-right:10px}.main-page[data-v-911a285c]{z-index:100003;position:fixed}.main-page .overlay[data-v-911a285c]{position:fixed;top:0;left:0;right:0;bottom:0;z-index:1001}.main-page .el-card .card-header[data-v-911a285c]{display:flex;justify-content:space-between;flex-direction:row;align-items:center;margin:0;padding:0;cursor:move}.main-page .el-card .card-header .title[data-v-911a285c]{font-size:14px;display:flex;align-items:center;justify-content:center;font-weight:500}.main-page[data-v-911a285c] .el-card__header{background-color:#1f71e0;color:#fff;padding:7px 10px 7px 16px;margin:0}.main-page[data-v-911a285c] .el-card__body{padding:0 6px 20px 16px}.main-page[data-v-911a285c] .el-tabs__nav-wrap:after{height:1px}.main-page[data-v-911a285c] .el-tabs__active-bar{background-color:#176ae5}.main-page[data-v-911a285c] .el-tabs__item{font-size:13px;height:34px}.main-page[data-v-911a285c] .el-tabs__item.is-top{font-weight:400;color:#4e5969;padding:0 8px 0 12px}.main-page[data-v-911a285c] .el-tabs__item.is-active{font-weight:500;color:#176ae5;padding:0 8px 0 12px}.content[data-v-911a285c]{width:370px} "),function(e,t,r,n,a){"use strict";(()=>{let e=document.createElement("script");e.textContent='window.addEventListener("mouseout",t=>{t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()},!0);',document.head.appendChild(e),e.remove()})(),setInterval(function e(){let t=document.querySelectorAll(".currents");for(let r=0;r<t.length;r++)if(t[r].querySelector(".roundpointStudent.blue")||t[r].querySelector(".roundpoint.blue")){goback();break}},1e3),setInterval(function e(){let t=document.querySelectorAll("h3"),r=null;for(let n=0;n<t.length;n++)if(t[n].querySelector("em.orange, em.blank")){r=t[n];break}if(r){let a=r.querySelector("a");a&&a.click()}},1e3);var o=Object.defineProperty,i=(e,t,r)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,s=(e,t,r)=>(i(e,"symbol"!=typeof t?t+"":t,r),r),l=(e,t)=>{let r=e.__vccOpts||e;for(let[n,a]of t)r[n]=a;return r},u={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},c=[e.createElementVNode("path",{fill:"currentColor",d:"M805.504 320 640 154.496V320h165.504zM832 384H576V128H192v768h640V384zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32zm192 512h320v64H352v-64z"},null,-1)],d=l({name:"DocumentRemove"},[["render",function t(r,n,a,o,i,s){return e.openBlock(),e.createElementBlock("svg",u,c)}],["__file","document-remove.vue"],]),f={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},h=[e.createElementVNode("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64v.064zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64l-192 .192zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64v-.064z"},null,-1)],p=l({name:"FullScreen"},[["render",function t(r,n,a,o,i,s){return e.openBlock(),e.createElementBlock("svg",f,h)}],["__file","full-screen.vue"],]),$={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},v=[e.createElementVNode("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64z"},null,-1)],m=l({name:"Minus"},[["render",function t(r,n,a,o,i,s){return e.openBlock(),e.createElementBlock("svg",$,v)}],["__file","minus.vue"],]),_={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},g=[e.createElementVNode("path",{fill:"currentColor",d:"m249.6 417.088 319.744 43.072 39.168 310.272L845.12 178.88 249.6 417.088zm-129.024 47.168a32 32 0 0 1-7.68-61.44l777.792-311.04a32 32 0 0 1 41.6 41.6l-310.336 775.68a32 32 0 0 1-61.44-7.808L512 516.992l-391.424-52.736z"},null,-1)],y=l({name:"Position"},[["render",function t(r,n,a,o,i,s){return e.openBlock(),e.createElementBlock("svg",_,g)}],["__file","position.vue"],]),b={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},S=[e.createElementVNode("path",{fill:"currentColor",d:"M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36-116.224-25.088-65.28 113.152 79.68 88.192-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136-79.808 88.192 65.344 113.152 116.224-25.024 22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152 24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296 116.288 25.024 65.28-113.152-79.744-88.192 1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136 79.808-88.128-65.344-113.152-116.288 24.96-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384 192 192 0 0 1 0-384zm0 64a128 128 0 1 0 0 256 128 128 0 0 0 0-256z"},null,-1)],U=l({name:"Setting"},[["render",function t(r,n,a,o,i,s){return e.openBlock(),e.createElementBlock("svg",b,S)}],["__file","setting.vue"],]),w={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},x=[e.createElementVNode("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352zm0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448zm0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160z"},null,-1)],C=l({name:"View"},[["render",function t(r,n,a,o,i,s){return e.openBlock(),e.createElementBlock("svg",w,x)}],["__file","view.vue"],]),k={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},F=[e.createElementVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 832a384 384 0 0 0 0-768 384 384 0 0 0 0 768zm48-176a48 48 0 1 1-96 0 48 48 0 0 1 96 0zm-48-464a32 32 0 0 1 32 32v288a32 32 0 0 1-64 0V288a32 32 0 0 1 32-32z"},null,-1)],P=l({name:"Warning"},[["render",function t(r,n,a,o,i,s){return e.openBlock(),e.createElementBlock("svg",k,F)}],["__file","warning.vue"],]),L="undefined"!=typeof GM_getResourceText?GM_getResourceText:void 0,T="undefined"!=typeof GM_getValue?GM_getValue:void 0,B="undefined"!=typeof GM_info?GM_info:void 0,V="undefined"!=typeof GM_setValue?GM_setValue:void 0,I="undefined"!=typeof GM_xmlhttpRequest?GM_xmlhttpRequest:void 0,N="undefined"!=typeof unsafeWindow?unsafeWindow:void 0;let E=()=>({name:B.script.name,namespace:B.script.namespace,version:B.script.version,description:B.script.description}),A=t.defineStore("configStore",{state(){let e=E(),t={version:e.version,isMinus:!1,position:{x:"800px",y:"200px"},menuIndex:"0",platformName:"cx",platformParams:{cx:{name:"超星网课助手",parts:[{name:"章节设置",params:[{name:"章节作业自动提交",value:!0,type:"boolean"},{name:"是否自动下一章节",value:!0,type:"boolean"},{name:"只答题，不做其他",value:!1,type:"boolean"},]},{name:"考试设置",params:[{name:"是否自动切换",value:!0,type:"boolean"},]},]},zhs:{name:"智慧树网课助手",parts:[{name:"答题设置",params:[{name:"是否自动切换",value:!0,type:"boolean"},]},]},unknown:{name:"未知平台",parts:[{name:"答题设置",params:[{name:"是否自动切换",value:!0,type:"boolean"},]},]}},otherParams:{name:"其他参数",params:[{name:"切换、答题间隔，单位秒",value:3,type:"number"},{name:"正确率达到多少自动提交",value:85,type:"number"},]},queryApis:[{name:"题库",token:"",url:"http://www.tiku.me"}]},r=t,n=T("config");if(n)try{let a=JSON.parse(n);e.version===a.version&&(r=a)}catch(o){console.error(o)}return V("globalConfig",JSON.stringify(r)),r},actions:{}}),G=e=>{e.getFullYear(),e.getMonth(),e.getDate();let t=e.getHours(),r;return`${O(t)}:${O(e.getMinutes())}:${O(e.getSeconds())}`},O=e=>e<10?"0"+e:e.toString(),z=()=>{let e=new Date;return G(e)},D=t.defineStore("logStore",{state:()=>({logList:[]}),actions:{addLog(e,t){let r={message:e,time:z(),type:t};this.logList.push(r)}}}),q=t.defineStore("questionStore",{state:()=>({questionList:[]}),actions:{addQuestion(e){this.questionList.push(e)},clearQuestion(){this.questionList=[]}}}),M=e.createTextVNode("\xa0"),H=e.defineComponent({name:"index",props:{logList:{type:Array,required:!0}},setup:t=>(r,n)=>{let a=e.resolveComponent("el-text"),o=e.resolveComponent("el-divider"),i=e.resolveComponent("el-scrollbar");return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(i,{always:"",class:"log","max-height":"230px"},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.logList,(t,r)=>(e.openBlock(),e.createElementBlock("div",{key:r},[e.createVNode(a,{size:"small",style:{"font-weight":"normal"},type:"info"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.time),1)]),_:2},1024),e.createVNode(a,null,{default:e.withCtx(()=>[M]),_:1}),e.createVNode(a,{type:t.type?t.type:"primary",size:"small",innerHTML:t.message},null,8,["type","innerHTML"]),e.createVNode(o,{"border-style":"dashed",style:{margin:"0"}}),]))),128)),]),_:1}),])}}),R=(e,t)=>{let r=e.__vccOpts||e;for(let[n,a]of t)r[n]=a;return r},j=R(H,[["__scopeId","data-v-d41d5897"]]),W={class:"setting"},Q={style:{"font-size":"13px"}},X={style:{"font-size":"13px"}},Y=e.defineComponent({name:"index",props:{globalConfig:{type:Object,required:!0}},setup:t=>(r,n)=>{let a=e.resolveComponent("el-divider"),o=e.resolveComponent("el-checkbox"),i=e.resolveComponent("el-input-number"),s=e.resolveComponent("el-form-item");return e.openBlock(),e.createElementBlock("div",W,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.globalConfig.platformParams[t.globalConfig.platformName].parts,(t,r)=>(e.openBlock(),e.createElementBlock("div",{key:r},[e.createVNode(a,{"border-style":"dashed"},{default:e.withCtx(()=>[e.createElementVNode("span",Q,e.toDisplayString(t.name),1)]),_:2},1024),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.params,(t,r)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,["boolean"===t.type?(e.openBlock(),e.createBlock(o,{style:{"margin-bottom":"6px"},key:r,modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,label:t.name,size:"small"},null,8,["modelValue","onUpdate:modelValue","label"])):(e.openBlock(),e.createBlock(s,{key:1,label:t.name,required:""},{default:e.withCtx(()=>[e.createVNode(i,{modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,min:3e3,step:1e3,"controls-position":"right",size:"small"},null,8,["modelValue","onUpdate:modelValue"]),]),_:2},1032,["label"])),],64))),256)),]))),128)),e.createElementVNode("div",null,[e.createVNode(a,{"border-style":"dashed"},{default:e.withCtx(()=>[e.createElementVNode("span",X,e.toDisplayString(t.globalConfig.otherParams.name),1)]),_:1}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.globalConfig.otherParams.params,(t,r)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:r},["boolean"===t.type?(e.openBlock(),e.createBlock(o,{key:0,modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,size:"small"},null,8,["modelValue","onUpdate:modelValue"])):(e.openBlock(),e.createBlock(s,{key:1,style:{"margin-top":"6px"},label:t.name,required:"",size:"small"},{default:e.withCtx(()=>[e.createVNode(i,{modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,min:3,max:100,step:1,size:"small"},null,8,["modelValue","onUpdate:modelValue"]),]),_:2},1032,["label"])),],64))),128)),]),])}}),J=R(Y,[["__scopeId","data-v-4489784f"]]),K=e.createTextVNode("密钥"),Z={class:"question_table"},ee=["innerHTML"],et=e.defineComponent({name:"QuestionTable",props:{questionList:{type:Array,required:!0}},setup(t){let r=A();return(n,a)=>{let o=e.resolveComponent("el-button"),i=e.resolveComponent("el-input"),s=e.resolveComponent("el-table-column"),l=e.resolveComponent("el-table"),u=e.resolveComponent("el-empty");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(i,{style:{"font-size":"12px"},modelValue:e.unref(r).queryApis[0].token,"onUpdate:modelValue":a[0]||(a[0]=t=>e.unref(r).queryApis[0].token=t),placeholder:"获取的密钥的密钥填到这里即可，题库问题与脚本无关，确定能搜到再获取"},{prepend:e.withCtx(()=>[e.createVNode(o,{style:{"border-radius":"0"}},{default:e.withCtx(()=>[K]),_:1}),]),_:1},8,["modelValue"]),e.withDirectives(e.createElementVNode("div",Z,[e.createVNode(l,{stripe:"",data:t.questionList,"max-height":"400",style:{"font-size":"12px"}},{default:e.withCtx(()=>[e.createVNode(s,{type:"index",width:"40"}),e.createVNode(s,{prop:"title",label:"题目",width:"370"}),e.createVNode(s,{style:{"background-color":"red"},prop:"answer",label:"答案",width:"215"},{default:e.withCtx(t=>[e.createElementVNode("div",{innerHTML:t.row.answer.join()},null,8,ee),]),_:1}),]),_:1},8,["data"]),],512),[[e.vShow,t.questionList.length]]),e.withDirectives(e.createElementVNode("div",null,[e.createVNode(u,{description:"该页面无需答题"})],512),[[e.vShow,!t.questionList.length]]),],64)}}}),er=R(et,[["__scopeId","data-v-18523ca7"]]),en={style:{"font-size":"12px"}},ea=e.createTextVNode(" 开源地址："),eo=e.createElementVNode("a",null,"点击查看",-1),ei=[ea,eo],es=R({},[["render",function t(r,n){return e.openBlock(),e.createElementBlock("div",en,ei)}]]),el=e.createElementVNode("p",null,"1、本脚本仅供学习和研究目的使用，并应在24小时内删除。脚本的使用不应违反任何法律法规及学术道德标准。",-1),eu=e.createElementVNode("br",null,null,-1),ec=e.createElementVNode("p",null,"2、用户在使用脚本时，必须遵守所有适用的法律法规。任何由于使用脚本而引起的违法行为或不当行为，其产生的一切后果由用户自行承担。",-1),ed=e.createElementVNode("br",null,null,-1),ef=e.createElementVNode("p",null,"3、开发者不对用户使用脚本所产生的任何直接或间接后果负责。用户应自行评估使用脚本的风险，并对任何可能的负面影响承担全责。",-1),eh=e.createElementVNode("br",null,null,-1),ep=e.createElementVNode("p",null,"4、本声明的目的在于提醒用户注意相关法律法规与风险，确保用户在明智、合法的前提下使用脚本。",-1),e$=e.createElementVNode("br",null,null,-1),ev=e.createElementVNode("p",null,"5、如用户在使用脚本的过程中有任何疑问，建议立即停止使用，并删除所有相关文件。",-1),e0=e.createElementVNode("br",null,null,-1),em=e.createElementVNode("p",null,"6、本免责声明的最终解释权归脚本开发者所有。",-1),e_=[el,eu,ec,ed,ef,eh,ep,e$,ev,e0,em],eg=R({},[["render",function t(r,n){return e.openBlock(),e.createElementBlock("div",null,e_)}]]);function ey(e){return"function"==typeof e}function eb(e){return function(t){var r;if(ey(null==(r=t)?void 0:r.lift))return t.lift(function(t){try{return e(t,this)}catch(r){this.error(r)}});throw TypeError("Unable to lift unknown Observable type")}}var e2=function(e,t){return(e2=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function eS(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}e2(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function eU(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function s(l){if(r)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(r=1,n&&(a=2&l[0]?n.return:l[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,l[1])).done)return a;switch(n=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(u){l=[6,u],n=0}finally{r=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([s,l])}}}function ew(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function e1(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,o=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(s){a={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(a)throw a.error}}return i}function ex(e,t,r){if(r||2===arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}function e8(e){return this instanceof e8?(this.v=e,this):new e8(e)}var e6,e4,eC=((e4=(e6=function(e){return function t(r){e(this),this.message=r?r.length+" errors occurred during unsubscription:\n"+r.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=r}})(function(e){Error.call(e),e.stack=Error().stack})).prototype=Object.create(Error.prototype),e4.prototype.constructor=e4,e4);function e3(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var ek=function(){var e;function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e,t,r,n,a,o=this._parentage;if(o){if(this._parentage=null,Array.isArray(o))try{for(var i=ew(o),s=i.next();!s.done;s=i.next())s.value.remove(this)}catch(l){e={error:l}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}else o.remove(this)}var u=this.initialTeardown;if(ey(u))try{u()}catch(c){a=c instanceof eC?c.errors:[c]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=ew(d),h=f.next();!h.done;h=f.next()){var p=h.value;try{eP(p)}catch($){a=null!=a?a:[],$ instanceof eC?a=ex(ex([],e1(a)),e1($.errors)):a.push($)}}}catch(v){r={error:v}}finally{try{h&&!h.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}}if(a)throw new eC(a)}},t.prototype.add=function(e){var r;if(e&&e!==this){if(this.closed)eP(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(e)}}},t.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},t.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},t.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&e3(t,e)},t.prototype.remove=function(e){var r=this._finalizers;r&&e3(r,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t}();function eF(e){return e instanceof ek||e&&"closed"in e&&ey(e.remove)&&ey(e.add)&&ey(e.unsubscribe)}function eP(e){ey(e)?e():e.unsubscribe()}ek.EMPTY;var e7={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},eL={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setTimeout.apply(void 0,ex([e,t],e1(r)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function e5(e){eL.setTimeout(function(){throw e})}function eT(){}function eB(e){e()}var eV=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,eF(t)&&t.add(r)):r.destination=eO,r}return eS(t,e),t.create=function(e,t,r){return new eA(e,t,r)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(ek),eI=Function.prototype.bind;function eN(e,t){return eI.call(e,t)}var eE=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t,r=this.partialObserver;if(r.next)try{r.next(e)}catch(n){t=n,e5(t)}},e.prototype.error=function(e){var t,r,n=this.partialObserver;if(n.error)try{n.error(e)}catch(a){t=a,e5(t)}else{r=e,e5(r)}},e.prototype.complete=function(){var e,t=this.partialObserver;if(t.complete)try{t.complete()}catch(r){e=r,e5(e)}},e}(),eA=function(e){function t(t,r,n){var a,o,i=e.call(this)||this;return ey(t)||!t?a={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:i&&e7.useDeprecatedNextContext?((o=Object.create(t)).unsubscribe=function(){return i.unsubscribe()},a={next:t.next&&eN(t.next,o),error:t.error&&eN(t.error,o),complete:t.complete&&eN(t.complete,o)}):a=t,i.destination=new eE(a),i}return eS(t,e),t}(eV);function eG(e){e5(e)}var eO={closed:!0,next:eT,error:function e(t){throw t},complete:eT},ez="function"==typeof Symbol&&Symbol.observable||"@@observable";function eD(e){return e}var eq=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n,a,o,i=this,s=(n=e,n&&n instanceof eV||(a=n)&&ey(a.next)&&ey(a.error)&&ey(a.complete)&&eF(n))?e:new eA(e,t,r);return(o=function(){var e=i,t=e.operator,r=e.source;s.add(t?t.call(s,r):r?i._subscribe(s):i._trySubscribe(s))})(),s},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=eM(t))(function(t,n){var a=new eA({next:function(t){try{e(t)}catch(r){n(r),a.unsubscribe()}},error:n,complete:t});r.subscribe(a)})},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[ez]=function(){return this},e.prototype.pipe=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(0===(e=t).length?eD:1===e.length?e[0]:function t(r){return e.reduce(function(e,t){return t(e)},r)})(this)},e.prototype.toPromise=function(e){var t=this;return new(e=eM(e))(function(e,r){var n;t.subscribe(function(e){return n=e},function(e){return r(e)},function(){return e(n)})})},e.create=function(t){return new e(t)},e}();function eM(e){var t;return null!==(t=null!=e?e:e7.Promise)&&void 0!==t?t:Promise}var eH="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function eR(e){var t,r,n,a,o,i,s,l,u,c,d,f;if(e instanceof eq)return e;if(null!=e){if(ey((t=e)[ez])){return l=e,new eq(function(e){var t=l[ez]();if(ey(t.subscribe))return t.subscribe(e);throw TypeError("Provided object does not correctly implement Symbol.observable")})}if((r=e)&&"number"==typeof r.length&&"function"!=typeof r){return u=e,new eq(function(e){for(var t=0;t<u.length&&!e.closed;t++)e.next(u[t]);e.complete()})}if(ey(null==(n=e)?void 0:n.then)){return c=e,new eq(function(e){c.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,e5)})}if(a=e,Symbol.asyncIterator&&ey(null==a?void 0:a[Symbol.asyncIterator]))return ej(e);if(ey(null==(o=e)?void 0:o[eH])){return d=e,new eq(function(e){var t,r;try{for(var n=ew(d),a=n.next();!a.done;a=n.next()){var o=a.value;if(e.next(o),e.closed)return}}catch(i){t={error:i}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}e.complete()})}if(ey(null==(i=e)?void 0:i.getReader)){return f=e,ej(function e(t){return function e(t,r,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var a,o=n.apply(t,r||[]),i=[];return a={},s("next"),s("throw"),s("return"),a[Symbol.asyncIterator]=function(){return this},a;function s(e){o[e]&&(a[e]=function(t){return new Promise(function(r,n){i.push([e,t,r,n])>1||l(e,t)})})}function l(e,t){try{var r;r=o[e](t),r.value instanceof e8?Promise.resolve(r.value.v).then(u,c):d(i[0][2],r)}catch(n){d(i[0][3],n)}}function u(e){l("next",e)}function c(e){l("throw",e)}function d(e,t){e(t),i.shift(),i.length&&l(i[0][0],i[0][1])}}(this,arguments,function e(){var r,n,a,o;return eU(this,function(e){switch(e.label){case 0:r=t.getReader(),e.label=1;case 1:e.trys.push([1,,9,10]),e.label=2;case 2:return[4,e8(r.read())];case 3:if(a=(n=e.sent()).value,!(o=n.done))return[3,5];return[4,e8(void 0)];case 4:return[2,e.sent()];case 5:return[4,e8(a)];case 6:return[4,e.sent()];case 7:return e.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}(f))}}throw TypeError("You provided "+(null!==(s=e)&&"object"==typeof s?"an invalid object":"'"+s+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function ej(e){return new eq(function(t){(function e(t,r){var n,a,o,i,s,l,u,c;return s=this,l=void 0,u=void 0,c=function(){var e,s;return eU(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=function e(t){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,n=t[Symbol.asyncIterator];return n?n.call(t):(t=ew(t),r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r);function a(e){r[e]=t[e]&&function(r){return new Promise(function(n,a){(function e(t,r,n,a){Promise.resolve(a).then(function(e){t({value:e,done:n})},r)})(n,a,(r=t[e](r)).done,r.value)})}}}(t),l.label=1;case 1:return[4,n.next()];case 2:if((a=l.sent()).done)return[3,4];if(e=a.value,r.next(e),r.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o={error:s=l.sent()},[3,11];case 6:if(l.trys.push([6,,9,10]),!(a&&!a.done&&(i=n.return)))return[3,8];return[4,i.call(n)];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return r.complete(),[2]}})},new(u||(u=Promise))(function(e,t){function r(e){try{a(c.next(e))}catch(r){t(r)}}function n(e){try{a(c.throw(e))}catch(r){t(r)}}function a(t){var a;t.done?e(t.value):((a=t.value)instanceof u?a:new u(function(e){e(a)})).then(r,n)}a((c=c.apply(s,l||[])).next())})})(e,t).catch(function(e){return t.error(e)})})}function eW(e,t,r,n,a){return new e9(e,t,r,n,a)}var e9=function(e){function t(t,r,n,a,o,i){var s=e.call(this,t)||this;return s.onFinalize=o,s.shouldUnsubscribe=i,s._next=r?function(e){try{r(e)}catch(n){t.error(n)}}:e.prototype._next,s._error=a?function(e){try{a(e)}catch(r){t.error(r)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return eS(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),r||null===(t=this.onFinalize)||void 0===t||t.call(this)}},t}(eV);function eQ(e,t){return eb(function(r,n){var a=0;r.subscribe(eW(n,function(r){n.next(e.call(t,r,a++))}))})}function eX(e,t,r){return(void 0===r&&(r=1/0),ey(t))?eX(function(r,n){return eQ(function(e,a){return t(r,e,n,a)})(eR(e(r,n)))},r):("number"==typeof t&&(r=t),eb(function(t,n){var a,o,i,s,l,u,c,d,f,h,p,$,v,m,_;return a=t,o=n,i=e,s=r,f=[],h=0,p=0,$=!1,v=function(){!$||f.length||h||o.complete()},m=function(e){return h<s?_(e):f.push(e)},_=function(e){u&&o.next(e),h++;var t=!1;eR(i(e,p++)).subscribe(eW(o,function(e){null==l||l(e),u?m(e):o.next(e)},function(){t=!0},void 0,function(){if(t)try{for(h--;f.length&&h<s;)!function(){var e=f.shift();c?function e(t,r,n,a,o){void 0===a&&(a=0),void 0===o&&(o=!1);var i=r.schedule(function(){n(),o?t.add(this.schedule(null,a)):this.unsubscribe()},a);if(t.add(i),!o)return i}(o,c,function(){return _(e)}):_(e)}();v()}catch(e){o.error(e)}}))},a.subscribe(eW(o,m,function(){$=!0,v()})),function(){null==d||d()}}))}function eY(){var e=1;return void 0===e&&(e=1/0),eX(eD,e)}class eJ{static getIframes(e){return Array.from(e.querySelectorAll("iframe"))}static getAllNestedIframes(e){let t=eJ.getIframes(e);return 0===t.length?r.of([]):r.from(t).pipe(eX(e=>new r.Observable(t=>{if(e.contentDocument&&"complete"===e.contentDocument.readyState){let n=e.contentDocument,a=eJ.getAllNestedIframes(n.documentElement);a.subscribe(r=>{t.next([e,...r]),t.complete()})}else r.fromEvent(e,"load").pipe(eQ(()=>e.contentDocument?e.contentDocument.documentElement:document.createElement("div")),eQ(e=>eJ.getAllNestedIframes(e)),eY()).subscribe(r=>{t.next([e,...r]),t.complete()})})),eY(),r.toArray())}}class eK{constructor(e,t){s(this,"xhr"),s(this,"originalOpen"),s(this,"callback"),this.xhr=new XMLHttpRequest,this.originalOpen=this.xhr.open,this.callback=t,this.intercept(e)}intercept(e){let t=this;XMLHttpRequest.prototype.open=function(r,n,a,o,i){return e.some(e=>n.includes(e))&&t.callback(r,n),t.originalOpen.apply(this,[r,n,a,o,i])}}}var eZ={},te={};te.parse=function(e){var t=te._bin,r=new Uint8Array(e);if("ttcf"!=t.readASCII(r,0,4))return[te._readFont(r,0)];var n=4;t.readUshort(r,n),n+=2,t.readUshort(r,n),n+=2;var a=t.readUint(r,n);n+=4;for(var o=[],i=0;i<a;i++){var s=t.readUint(r,n);n+=4,o.push(te._readFont(r,s))}return o},te._readFont=function(e,t){var r=te._bin,n=t;r.readFixed(e,t),t+=4;var a=r.readUshort(e,t);t+=2,r.readUshort(e,t),t+=2,r.readUshort(e,t),t+=2,r.readUshort(e,t),t+=2;for(var o=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG ",],i={_data:e,_offset:n},s={},l=0;l<a;l++){var u=r.readASCII(e,t,4);t+=4,r.readUint(e,t),t+=4;var c=r.readUint(e,t);t+=4;var d=r.readUint(e,t);t+=4,s[u]={offset:c,length:d}}for(var l=0;l<o.length;l++){var f=o[l];s[f]&&(i[f.trim()]=te[f.trim()].parse(e,s[f].offset,s[f].length,i))}return i},te._tabOffset=function(e,t,r){for(var n=te._bin,a=n.readUshort(e,r+4),o=r+12,i=0;i<a;i++){var s=n.readASCII(e,o,4);o+=4,n.readUint(e,o),o+=4;var l=n.readUint(e,o);if(o+=4,n.readUint(e,o),o+=4,s==t)return l}return 0},te._bin={readFixed:function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<8|e[t+3])/65540},readF2dot14:function(e,t){return te._bin.readShort(e,t)/16384},readInt:function(e,t){return te._bin._view(e).getInt32(t)},readInt8:function(e,t){return te._bin._view(e).getInt8(t)},readShort:function(e,t){return te._bin._view(e).getInt16(t)},readUshort:function(e,t){return te._bin._view(e).getUint16(t)},readUshorts:function(e,t,r){for(var n=[],a=0;a<r;a++)n.push(te._bin.readUshort(e,t+2*a));return n},readUint:function(e,t){return te._bin._view(e).getUint32(t)},readUint64:function(e,t){return 4294967296*te._bin.readUint(e,t)+te._bin.readUint(e,t+4)},readASCII:function(e,t,r){for(var n="",a=0;a<r;a++)n+=String.fromCharCode(e[t+a]);return n},readUnicode:function(e,t,r){for(var n="",a=0;a<r;a++)n+=String.fromCharCode(e[t++]<<8|e[t++]);return n},_tdec:"undefined"!=typeof window&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(e,t,r){var n=te._bin._tdec;return n&&0==t&&r==e.length?n.decode(e):te._bin.readASCII(e,t,r)},readBytes:function(e,t,r){for(var n=[],a=0;a<r;a++)n.push(e[t+a]);return n},readASCIIArray:function(e,t,r){for(var n=[],a=0;a<r;a++)n.push(String.fromCharCode(e[t+a]));return n},_view:function(e){return e._dataView||(e._dataView=e.buffer?new DataView(e.buffer,e.byteOffset,e.byteLength):new DataView(new Uint8Array(e).buffer))}},te._lctf={},te._lctf.parse=function(e,t,r,n,a){var o=te._bin,i={},s=t;o.readFixed(e,t),t+=4;var l=o.readUshort(e,t);t+=2;var u=o.readUshort(e,t);t+=2;var c=o.readUshort(e,t);return t+=2,i.scriptList=te._lctf.readScriptList(e,s+l),i.featureList=te._lctf.readFeatureList(e,s+u),i.lookupList=te._lctf.readLookupList(e,s+c,a),i},te._lctf.readLookupList=function(e,t,r){var n=te._bin,a=t,o=[],i=n.readUshort(e,t);t+=2;for(var s=0;s<i;s++){var l=n.readUshort(e,t);t+=2;var u=te._lctf.readLookupTable(e,a+l,r);o.push(u)}return o},te._lctf.readLookupTable=function(e,t,r){var n=te._bin,a=t,o={tabs:[]};o.ltype=n.readUshort(e,t),t+=2,o.flag=n.readUshort(e,t),t+=2;var i=n.readUshort(e,t);t+=2;for(var s=o.ltype,l=0;l<i;l++){var u=n.readUshort(e,t);t+=2;var c=r(e,s,a+u,o);o.tabs.push(c)}return o},te._lctf.numOfOnes=function(e){for(var t=0,r=0;r<32;r++)(e>>>r&1)!=0&&t++;return t},te._lctf.readClassDef=function(e,t){var r=te._bin,n=[],a=r.readUshort(e,t);if(t+=2,1==a){var o=r.readUshort(e,t);t+=2;var i=r.readUshort(e,t);t+=2;for(var s=0;s<i;s++)n.push(o+s),n.push(o+s),n.push(r.readUshort(e,t)),t+=2}if(2==a){var l=r.readUshort(e,t);t+=2;for(var s=0;s<l;s++)n.push(r.readUshort(e,t)),t+=2,n.push(r.readUshort(e,t)),t+=2,n.push(r.readUshort(e,t)),t+=2}return n},te._lctf.getInterval=function(e,t){for(var r=0;r<e.length;r+=3){var n=e[r],a=e[r+1];if(e[r+2],n<=t&&t<=a)return r}return -1},te._lctf.readCoverage=function(e,t){var r=te._bin,n={};n.fmt=r.readUshort(e,t),t+=2;var a=r.readUshort(e,t);return t+=2,1==n.fmt&&(n.tab=r.readUshorts(e,t,a)),2==n.fmt&&(n.tab=r.readUshorts(e,t,3*a)),n},te._lctf.coverageIndex=function(e,t){var r=e.tab;if(1==e.fmt)return r.indexOf(t);if(2==e.fmt){var n=te._lctf.getInterval(r,t);if(-1!=n)return r[n+2]+(t-r[n])}return -1},te._lctf.readFeatureList=function(e,t){var r=te._bin,n=t,a=[],o=r.readUshort(e,t);t+=2;for(var i=0;i<o;i++){var s=r.readASCII(e,t,4);t+=4;var l=r.readUshort(e,t);t+=2;var u=te._lctf.readFeatureTable(e,n+l);u.tag=s.trim(),a.push(u)}return a},te._lctf.readFeatureTable=function(e,t){var r=te._bin,n=t,a={},o=r.readUshort(e,t);t+=2,o>0&&(a.featureParams=n+o);var i=r.readUshort(e,t);t+=2,a.tab=[];for(var s=0;s<i;s++)a.tab.push(r.readUshort(e,t+2*s));return a},te._lctf.readScriptList=function(e,t){var r=te._bin,n=t,a={},o=r.readUshort(e,t);t+=2;for(var i=0;i<o;i++){var s=r.readASCII(e,t,4);t+=4;var l=r.readUshort(e,t);t+=2,a[s.trim()]=te._lctf.readScriptTable(e,n+l)}return a},te._lctf.readScriptTable=function(e,t){var r=te._bin,n=t,a={},o=r.readUshort(e,t);t+=2,a.default=te._lctf.readLangSysTable(e,n+o);var i=r.readUshort(e,t);t+=2;for(var s=0;s<i;s++){var l=r.readASCII(e,t,4);t+=4;var u=r.readUshort(e,t);t+=2,a[l.trim()]=te._lctf.readLangSysTable(e,n+u)}return a},te._lctf.readLangSysTable=function(e,t){var r=te._bin,n={};r.readUshort(e,t),t+=2,n.reqFeature=r.readUshort(e,t),t+=2;var a=r.readUshort(e,t);return t+=2,n.features=r.readUshorts(e,t,a),n},te.CFF={},te.CFF.parse=function(e,t,r){var n=te._bin;(e=new Uint8Array(e.buffer,t,r))[t=0],e[++t],e[++t],e[++t],t++;var a=[];t=te.CFF.readIndex(e,t,a);for(var o=[],i=0;i<a.length-1;i++)o.push(n.readASCII(e,t+a[i],a[i+1]-a[i]));t+=a[a.length-1];var s=[];t=te.CFF.readIndex(e,t,s);for(var l=[],i=0;i<s.length-1;i++)l.push(te.CFF.readDict(e,t+s[i],t+s[i+1]));t+=s[s.length-1];var u=l[0],c=[];t=te.CFF.readIndex(e,t,c);for(var d=[],i=0;i<c.length-1;i++)d.push(n.readASCII(e,t+c[i],c[i+1]-c[i]));if(t+=c[c.length-1],te.CFF.readSubrs(e,t,u),u.CharStrings){t=u.CharStrings;var c=[];t=te.CFF.readIndex(e,t,c);for(var f=[],i=0;i<c.length-1;i++)f.push(n.readBytes(e,t+c[i],c[i+1]-c[i]));u.CharStrings=f}if(u.ROS){t=u.FDArray;var h=[];t=te.CFF.readIndex(e,t,h),u.FDArray=[];for(var i=0;i<h.length-1;i++){var p=te.CFF.readDict(e,t+h[i],t+h[i+1]);te.CFF._readFDict(e,p,d),u.FDArray.push(p)}t+=h[h.length-1],t=u.FDSelect,u.FDSelect=[];var $=e[t];if(t++,3==$){var v=n.readUshort(e,t);t+=2;for(var i=0;i<v+1;i++)u.FDSelect.push(n.readUshort(e,t),e[t+2]),t+=3}else throw $}return u.Encoding&&(u.Encoding=te.CFF.readEncoding(e,u.Encoding,u.CharStrings.length)),u.charset&&(u.charset=te.CFF.readCharset(e,u.charset,u.CharStrings.length)),te.CFF._readFDict(e,u,d),u},te.CFF._readFDict=function(e,t,r){var n;for(var a in t.Private&&(n=t.Private[1],t.Private=te.CFF.readDict(e,n,n+t.Private[0]),t.Private.Subrs&&te.CFF.readSubrs(e,n+t.Private.Subrs,t.Private)),t)-1!=["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(a)&&(t[a]=r[t[a]-426+35])},te.CFF.readSubrs=function(e,t,r){var n=te._bin,a=[];t=te.CFF.readIndex(e,t,a);var o,i=a.length;o=i<1240?107:i<33900?1131:32768,r.Bias=o,r.Subrs=[];for(var s=0;s<a.length-1;s++)r.Subrs.push(n.readBytes(e,t+a[s],a[s+1]-a[s]))},te.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],te.CFF.glyphByUnicode=function(e,t){for(var r=0;r<e.charset.length;r++)if(e.charset[r]==t)return r;return -1},te.CFF.glyphBySE=function(e,t){return t<0||t>255?-1:te.CFF.glyphByUnicode(e,te.CFF.tableSE[t])},te.CFF.readEncoding=function(e,t,r){te._bin;var n=[".notdef"],a=e[t];if(t++,0==a){var o=e[t];t++;for(var i=0;i<o;i++)n.push(e[t+i])}else throw"error: unknown encoding format: "+a;return n},te.CFF.readCharset=function(e,t,r){var n=te._bin,a=[".notdef"],o=e[t];if(t++,0==o)for(var i=0;i<r;i++){var s=n.readUshort(e,t);t+=2,a.push(s)}else if(1==o||2==o)for(;a.length<r;){var s=n.readUshort(e,t);t+=2;var l=0;1==o?(l=e[t],t++):(l=n.readUshort(e,t),t+=2);for(var i=0;i<=l;i++)a.push(s),s++}else throw"error: format: "+o;return a},te.CFF.readIndex=function(e,t,r){var n=te._bin,a=n.readUshort(e,t)+1,o=e[t+=2];if(t++,1==o)for(var i=0;i<a;i++)r.push(e[t+i]);else if(2==o)for(var i=0;i<a;i++)r.push(n.readUshort(e,t+2*i));else if(3==o)for(var i=0;i<a;i++)r.push(16777215&n.readUint(e,t+3*i-1));else if(1!=a)throw"unsupported offset size: "+o+", count: "+a;return(t+=a*o)-1},te.CFF.getCharString=function(e,t,r){var n=te._bin,a=e[t],o=e[t+1];e[t+2],e[t+3],e[t+4];var i=1,s=null,l=null;a<=20&&(s=a,i=1),12==a&&(s=100*a+o,i=2),21<=a&&a<=27&&(s=a,i=1),28==a&&(l=n.readShort(e,t+1),i=3),29<=a&&a<=31&&(s=a,i=1),32<=a&&a<=246&&(l=a-139,i=1),247<=a&&a<=250&&(l=(a-247)*256+o+108,i=2),251<=a&&a<=254&&(l=-(256*(a-251))-o-108,i=2),255==a&&(l=n.readInt(e,t+1)/65535,i=5),r.val=null!=l?l:"o"+s,r.size=i},te.CFF.readCharString=function(e,t,r){for(var n=t+r,a=te._bin,o=[];t<n;){var i=e[t],s=e[t+1];e[t+2],e[t+3],e[t+4];var l=1,u=null,c=null;i<=20&&(u=i,l=1),12==i&&(u=100*i+s,l=2),(19==i||20==i)&&(u=i,l=2),21<=i&&i<=27&&(u=i,l=1),28==i&&(c=a.readShort(e,t+1),l=3),29<=i&&i<=31&&(u=i,l=1),32<=i&&i<=246&&(c=i-139,l=1),247<=i&&i<=250&&(c=(i-247)*256+s+108,l=2),251<=i&&i<=254&&(c=-(256*(i-251))-s-108,l=2),255==i&&(c=a.readInt(e,t+1)/65535,l=5),o.push(null!=c?c:"o"+u),t+=l}return o},te.CFF.readDict=function(e,t,r){for(var n=te._bin,a={},o=[];t<r;){var i=e[t],s=e[t+1];e[t+2],e[t+3],e[t+4];var l=1,u=null,c=null;if(28==i&&(c=n.readShort(e,t+1),l=3),29==i&&(c=n.readInt(e,t+1),l=5),32<=i&&i<=246&&(c=i-139,l=1),247<=i&&i<=250&&(c=(i-247)*256+s+108,l=2),251<=i&&i<=254&&(c=-(256*(i-251))-s-108,l=2),255==i)throw c=n.readInt(e,t+1)/65535,l=5,"unknown number";if(30==i){var d=[];for(l=1;;){var f=e[t+l];l++;var h=f>>4,p=15&f;if(15!=h&&d.push(h),15!=p&&d.push(p),15==p)break}for(var $="",v=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],m=0;m<d.length;m++)$+=v[d[m]];c=parseFloat($)}if(i<=21){var _=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"];if(u=_[i],l=1,12==i){var _=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"];u=_[s],l=2}}null!=u?(a[u]=1==o.length?o[0]:o,o=[]):o.push(c),t+=l}return a},te.cmap={},te.cmap.parse=function(e,t,r){e=new Uint8Array(e.buffer,t,r),t=0;var n=te._bin,a={};n.readUshort(e,t),t+=2;var o=n.readUshort(e,t);t+=2;var i=[];a.tables=[];for(var s=0;s<o;s++){var l=n.readUshort(e,t);t+=2;var u=n.readUshort(e,t);t+=2;var c=n.readUint(e,t);t+=4;var d="p"+l+"e"+u,f=i.indexOf(c);if(-1==f){f=a.tables.length,i.push(c);var h,p=n.readUshort(e,c);0==p?h=te.cmap.parse0(e,c):4==p?h=te.cmap.parse4(e,c):6==p?h=te.cmap.parse6(e,c):12==p?h=te.cmap.parse12(e,c):console.warn("unknown format: "+p,l,u,c),a.tables.push(h)}if(null!=a[d])throw"multiple tables for one platform+encoding";a[d]=f}return a},te.cmap.parse0=function(e,t){var r=te._bin,n={};n.format=r.readUshort(e,t),t+=2;var a=r.readUshort(e,t);t+=2,r.readUshort(e,t),t+=2,n.map=[];for(var o=0;o<a-6;o++)n.map.push(e[t+o]);return n},te.cmap.parse4=function(e,t){var r=te._bin,n=t,a={};a.format=r.readUshort(e,t),t+=2;var o=r.readUshort(e,t);t+=2,r.readUshort(e,t),t+=2;var i=r.readUshort(e,t);t+=2;var s=i/2;a.searchRange=r.readUshort(e,t),t+=2,a.entrySelector=r.readUshort(e,t),t+=2,a.rangeShift=r.readUshort(e,t),t+=2,a.endCount=r.readUshorts(e,t,s),t+=2*s,t+=2,a.startCount=r.readUshorts(e,t,s),t+=2*s,a.idDelta=[];for(var l=0;l<s;l++)a.idDelta.push(r.readShort(e,t)),t+=2;for(a.idRangeOffset=r.readUshorts(e,t,s),t+=2*s,a.glyphIdArray=[];t<n+o;)a.glyphIdArray.push(r.readUshort(e,t)),t+=2;return a},te.cmap.parse6=function(e,t){var r=te._bin,n={};n.format=r.readUshort(e,t),t+=2,r.readUshort(e,t),t+=2,r.readUshort(e,t),t+=2,n.firstCode=r.readUshort(e,t),t+=2;var a=r.readUshort(e,t);t+=2,n.glyphIdArray=[];for(var o=0;o<a;o++)n.glyphIdArray.push(r.readUshort(e,t)),t+=2;return n},te.cmap.parse12=function(e,t){var r=te._bin,n={};n.format=r.readUshort(e,t),t+=2,t+=2,r.readUint(e,t),t+=4,r.readUint(e,t),t+=4;var a=r.readUint(e,t);t+=4,n.groups=[];for(var o=0;o<a;o++){var i=t+12*o,s=r.readUint(e,i+0),l=r.readUint(e,i+4),u=r.readUint(e,i+8);n.groups.push([s,l,u])}return n},te.glyf={},te.glyf.parse=function(e,t,r,n){for(var a=[],o=0;o<n.maxp.numGlyphs;o++)a.push(null);return a},te.glyf._parseGlyf=function(e,t){var r,n=te._bin,a=e._data,o=te._tabOffset(a,"glyf",e._offset)+e.loca[t];if(e.loca[t]==e.loca[t+1])return null;var i={};if(i.noc=n.readShort(a,o),o+=2,i.xMin=n.readShort(a,o),o+=2,i.yMin=n.readShort(a,o),o+=2,i.xMax=n.readShort(a,o),o+=2,i.yMax=n.readShort(a,o),o+=2,i.xMin>=i.xMax||i.yMin>=i.yMax)return null;if(i.noc>0){i.endPts=[];for(var s=0;s<i.noc;s++)i.endPts.push(n.readUshort(a,o)),o+=2;var l=n.readUshort(a,o);if(o+=2,a.length-o<l)return null;i.instructions=n.readBytes(a,o,l),o+=l;var u=i.endPts[i.noc-1]+1;i.flags=[];for(var s=0;s<u;s++){var c=a[o];if(o++,i.flags.push(c),(8&c)!=0){var d=a[o];o++;for(var f=0;f<d;f++)i.flags.push(c),s++}}i.xs=[];for(var s=0;s<u;s++){var h=(2&i.flags[s])!=0,p=(16&i.flags[s])!=0;h?(i.xs.push(p?a[o]:-a[o]),o++):p?i.xs.push(0):(i.xs.push(n.readShort(a,o)),o+=2)}i.ys=[];for(var s=0;s<u;s++){var h=(4&i.flags[s])!=0,p=(32&i.flags[s])!=0;h?(i.ys.push(p?a[o]:-a[o]),o++):p?i.ys.push(0):(i.ys.push(n.readShort(a,o)),o+=2)}for(var $=0,v=0,s=0;s<u;s++)$+=i.xs[s],v+=i.ys[s],i.xs[s]=$,i.ys[s]=v}else{i.parts=[];do{r=n.readUshort(a,o),o+=2;var m={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(i.parts.push(m),m.glyphIndex=n.readUshort(a,o),o+=2,1&r){var _=n.readShort(a,o);o+=2;var g=n.readShort(a,o);o+=2}else{var _=n.readInt8(a,o);o++;var g=n.readInt8(a,o);o++}2&r?(m.m.tx=_,m.m.ty=g):(m.p1=_,m.p2=g),8&r?(m.m.a=m.m.d=n.readF2dot14(a,o),o+=2):64&r?(m.m.a=n.readF2dot14(a,o),o+=2,m.m.d=n.readF2dot14(a,o),o+=2):128&r&&(m.m.a=n.readF2dot14(a,o),o+=2,m.m.b=n.readF2dot14(a,o),o+=2,m.m.c=n.readF2dot14(a,o),o+=2,m.m.d=n.readF2dot14(a,o),o+=2)}while(32&r);if(256&r){var y=n.readUshort(a,o);o+=2,i.instr=[];for(var s=0;s<y;s++)i.instr.push(a[o]),o++}}return i},te.GPOS={},te.GPOS.parse=function(e,t,r,n){return te._lctf.parse(e,t,r,n,te.GPOS.subt)},te.GPOS.subt=function(e,t,r,n){var a=te._bin,o=r,i={};if(i.fmt=a.readUshort(e,r),r+=2,1==t||2==t||3==t||7==t||8==t&&i.fmt<=2){var s=a.readUshort(e,r);r+=2,i.coverage=te._lctf.readCoverage(e,s+o)}if(1==t&&1==i.fmt){var l=a.readUshort(e,r);r+=2;var u=te._lctf.numOfOnes(l);0!=l&&(i.pos=te.GPOS.readValueRecord(e,r,l))}else if(2==t&&i.fmt>=1&&i.fmt<=2){var l=a.readUshort(e,r);r+=2;var c=a.readUshort(e,r);r+=2;var u=te._lctf.numOfOnes(l),d=te._lctf.numOfOnes(c);if(1==i.fmt){i.pairsets=[];var f=a.readUshort(e,r);r+=2;for(var h=0;h<f;h++){var p=o+a.readUshort(e,r);r+=2;var $=a.readUshort(e,p);p+=2;for(var v=[],m=0;m<$;m++){var _,g,y=a.readUshort(e,p);p+=2,0!=l&&(_=te.GPOS.readValueRecord(e,p,l),p+=2*u),0!=c&&(g=te.GPOS.readValueRecord(e,p,c),p+=2*d),v.push({gid2:y,val1:_,val2:g})}i.pairsets.push(v)}}if(2==i.fmt){var b=a.readUshort(e,r);r+=2;var S=a.readUshort(e,r);r+=2;var U=a.readUshort(e,r);r+=2;var w=a.readUshort(e,r);r+=2,i.classDef1=te._lctf.readClassDef(e,o+b),i.classDef2=te._lctf.readClassDef(e,o+S),i.matrix=[];for(var h=0;h<U;h++){for(var x=[],m=0;m<w;m++){var _=null,g=null;0!=l&&(_=te.GPOS.readValueRecord(e,r,l),r+=2*u),0!=c&&(g=te.GPOS.readValueRecord(e,r,c),r+=2*d),x.push({val1:_,val2:g})}i.matrix.push(x)}}}else if(9==t&&1==i.fmt){var C=a.readUshort(e,r);r+=2;var k=a.readUint(e,r);if(r+=4,9==n.ltype)n.ltype=C;else if(n.ltype!=C)throw"invalid extension substitution";return te.GPOS.subt(e,n.ltype,o+k)}else console.warn("unsupported GPOS table LookupType",t,"format",i.fmt);return i},te.GPOS.readValueRecord=function(e,t,r){var n=te._bin,a=[];return a.push(1&r?n.readShort(e,t):0),t+=1&r?2:0,a.push(2&r?n.readShort(e,t):0),t+=2&r?2:0,a.push(4&r?n.readShort(e,t):0),t+=4&r?2:0,a.push(8&r?n.readShort(e,t):0),t+=8&r?2:0,a},te.GSUB={},te.GSUB.parse=function(e,t,r,n){return te._lctf.parse(e,t,r,n,te.GSUB.subt)},te.GSUB.subt=function(e,t,r,n){var a=te._bin,o=r,i={};if(i.fmt=a.readUshort(e,r),r+=2,1!=t&&4!=t&&5!=t&&6!=t)return null;if(1==t||4==t||5==t&&i.fmt<=2||6==t&&i.fmt<=2){var s=a.readUshort(e,r);r+=2,i.coverage=te._lctf.readCoverage(e,o+s)}if(1==t&&i.fmt>=1&&i.fmt<=2){if(1==i.fmt)i.delta=a.readShort(e,r),r+=2;else if(2==i.fmt){var l=a.readUshort(e,r);r+=2,i.newg=a.readUshorts(e,r,l),r+=2*i.newg.length}}else if(4==t){i.vals=[];var l=a.readUshort(e,r);r+=2;for(var u=0;u<l;u++){var c=a.readUshort(e,r);r+=2,i.vals.push(te.GSUB.readLigatureSet(e,o+c))}}else if(5==t&&2==i.fmt){if(2==i.fmt){var d=a.readUshort(e,r);r+=2,i.cDef=te._lctf.readClassDef(e,o+d),i.scset=[];var f=a.readUshort(e,r);r+=2;for(var u=0;u<f;u++){var h=a.readUshort(e,r);r+=2,i.scset.push(0==h?null:te.GSUB.readSubClassSet(e,o+h))}}}else if(6==t&&3==i.fmt){if(3==i.fmt){for(var u=0;u<3;u++){var l=a.readUshort(e,r);r+=2;for(var p=[],$=0;$<l;$++)p.push(te._lctf.readCoverage(e,o+a.readUshort(e,r+2*$)));r+=2*l,0==u&&(i.backCvg=p),1==u&&(i.inptCvg=p),2==u&&(i.ahedCvg=p)}var l=a.readUshort(e,r);r+=2,i.lookupRec=te.GSUB.readSubstLookupRecords(e,r,l)}}else if(7==t&&1==i.fmt){var v=a.readUshort(e,r);r+=2;var m=a.readUint(e,r);if(r+=4,9==n.ltype)n.ltype=v;else if(n.ltype!=v)throw"invalid extension substitution";return te.GSUB.subt(e,n.ltype,o+m)}else console.warn("unsupported GSUB table LookupType",t,"format",i.fmt);return i},te.GSUB.readSubClassSet=function(e,t){var r=te._bin.readUshort,n=t,a=[],o=r(e,t);t+=2;for(var i=0;i<o;i++){var s=r(e,t);t+=2,a.push(te.GSUB.readSubClassRule(e,n+s))}return a},te.GSUB.readSubClassRule=function(e,t){var r=te._bin.readUshort,n={},a=r(e,t),o=r(e,t+=2);t+=2,n.input=[];for(var i=0;i<a-1;i++)n.input.push(r(e,t)),t+=2;return n.substLookupRecords=te.GSUB.readSubstLookupRecords(e,t,o),n},te.GSUB.readSubstLookupRecords=function(e,t,r){for(var n=te._bin.readUshort,a=[],o=0;o<r;o++)a.push(n(e,t),n(e,t+2)),t+=4;return a},te.GSUB.readChainSubClassSet=function(e,t){var r=te._bin,n=t,a=[],o=r.readUshort(e,t);t+=2;for(var i=0;i<o;i++){var s=r.readUshort(e,t);t+=2,a.push(te.GSUB.readChainSubClassRule(e,n+s))}return a},te.GSUB.readChainSubClassRule=function(e,t){for(var r=te._bin,n={},a=["backtrack","input","lookahead"],o=0;o<a.length;o++){var i=r.readUshort(e,t);t+=2,1==o&&i--,n[a[o]]=r.readUshorts(e,t,i),t+=2*n[a[o]].length}var i=r.readUshort(e,t);return t+=2,n.subst=r.readUshorts(e,t,2*i),t+=2*n.subst.length,n},te.GSUB.readLigatureSet=function(e,t){var r=te._bin,n=t,a=[],o=r.readUshort(e,t);t+=2;for(var i=0;i<o;i++){var s=r.readUshort(e,t);t+=2,a.push(te.GSUB.readLigature(e,n+s))}return a},te.GSUB.readLigature=function(e,t){var r=te._bin,n={chain:[]};n.nglyph=r.readUshort(e,t),t+=2;var a=r.readUshort(e,t);t+=2;for(var o=0;o<a-1;o++)n.chain.push(r.readUshort(e,t)),t+=2;return n},te.head={},te.head.parse=function(e,t,r){var n=te._bin,a={};return n.readFixed(e,t),t+=4,a.fontRevision=n.readFixed(e,t),t+=4,n.readUint(e,t),t+=4,n.readUint(e,t),t+=4,a.flags=n.readUshort(e,t),t+=2,a.unitsPerEm=n.readUshort(e,t),t+=2,a.created=n.readUint64(e,t),t+=8,a.modified=n.readUint64(e,t),t+=8,a.xMin=n.readShort(e,t),t+=2,a.yMin=n.readShort(e,t),t+=2,a.xMax=n.readShort(e,t),t+=2,a.yMax=n.readShort(e,t),t+=2,a.macStyle=n.readUshort(e,t),t+=2,a.lowestRecPPEM=n.readUshort(e,t),t+=2,a.fontDirectionHint=n.readShort(e,t),t+=2,a.indexToLocFormat=n.readShort(e,t),t+=2,a.glyphDataFormat=n.readShort(e,t),t+=2,a},te.hhea={},te.hhea.parse=function(e,t,r){var n=te._bin,a={};return n.readFixed(e,t),t+=4,a.ascender=n.readShort(e,t),t+=2,a.descender=n.readShort(e,t),t+=2,a.lineGap=n.readShort(e,t),t+=2,a.advanceWidthMax=n.readUshort(e,t),t+=2,a.minLeftSideBearing=n.readShort(e,t),t+=2,a.minRightSideBearing=n.readShort(e,t),t+=2,a.xMaxExtent=n.readShort(e,t),t+=2,a.caretSlopeRise=n.readShort(e,t),t+=2,a.caretSlopeRun=n.readShort(e,t),t+=2,a.caretOffset=n.readShort(e,t),t+=2,t+=8,a.metricDataFormat=n.readShort(e,t),t+=2,a.numberOfHMetrics=n.readUshort(e,t),t+=2,a},te.hmtx={},te.hmtx.parse=function(e,t,r,n){var a=te._bin,o={};o.aWidth=[],o.lsBearing=[];for(var i=0,s=0,l=0;l<n.maxp.numGlyphs;l++)l<n.hhea.numberOfHMetrics&&(i=a.readUshort(e,t),t+=2,s=a.readShort(e,t),t+=2),o.aWidth.push(i),o.lsBearing.push(s);return o},te.kern={},te.kern.parse=function(e,t,r,n){var a=te._bin,o=a.readUshort(e,t);if(t+=2,1==o)return te.kern.parseV1(e,t-2,r,n);var i=a.readUshort(e,t);t+=2;for(var s={glyph1:[],rval:[]},l=0;l<i;l++){t+=2;var r=a.readUshort(e,t);t+=2;var u=a.readUshort(e,t);t+=2;var c=u>>>8;if(0==(c&=15))t=te.kern.readFormat0(e,t,s);else throw"unknown kern table format: "+c}return s},te.kern.parseV1=function(e,t,r,n){var a=te._bin;a.readFixed(e,t),t+=4;var o=a.readUint(e,t);t+=4;for(var i={glyph1:[],rval:[]},s=0;s<o;s++){a.readUint(e,t),t+=4;var l=a.readUshort(e,t);t+=2,a.readUshort(e,t),t+=2;var u=l>>>8;if(0==(u&=15))t=te.kern.readFormat0(e,t,i);else throw"unknown kern table format: "+u}return i},te.kern.readFormat0=function(e,t,r){var n=te._bin,a=-1,o=n.readUshort(e,t);t+=2,n.readUshort(e,t),t+=2,n.readUshort(e,t),t+=2,n.readUshort(e,t),t+=2;for(var i=0;i<o;i++){var s=n.readUshort(e,t);t+=2;var l=n.readUshort(e,t);t+=2;var u=n.readShort(e,t);t+=2,s!=a&&(r.glyph1.push(s),r.rval.push({glyph2:[],vals:[]}));var c=r.rval[r.rval.length-1];c.glyph2.push(l),c.vals.push(u),a=s}return t},te.loca={},te.loca.parse=function(e,t,r,n){var a=te._bin,o=[],i=n.head.indexToLocFormat,s=n.maxp.numGlyphs+1;if(0==i)for(var l=0;l<s;l++)o.push(a.readUshort(e,t+(l<<1))<<1);if(1==i)for(var l=0;l<s;l++)o.push(a.readUint(e,t+(l<<2)));return o},te.maxp={},te.maxp.parse=function(e,t,r){var n=te._bin,a={},o=n.readUint(e,t);return t+=4,a.numGlyphs=n.readUshort(e,t),t+=2,65536==o&&(a.maxPoints=n.readUshort(e,t),t+=2,a.maxContours=n.readUshort(e,t),t+=2,a.maxCompositePoints=n.readUshort(e,t),t+=2,a.maxCompositeContours=n.readUshort(e,t),t+=2,a.maxZones=n.readUshort(e,t),t+=2,a.maxTwilightPoints=n.readUshort(e,t),t+=2,a.maxStorage=n.readUshort(e,t),t+=2,a.maxFunctionDefs=n.readUshort(e,t),t+=2,a.maxInstructionDefs=n.readUshort(e,t),t+=2,a.maxStackElements=n.readUshort(e,t),t+=2,a.maxSizeOfInstructions=n.readUshort(e,t),t+=2,a.maxComponentElements=n.readUshort(e,t),t+=2,a.maxComponentDepth=n.readUshort(e,t),t+=2),a},te.name={},te.name.parse=function(e,t,r){var n,a=te._bin,o={};a.readUshort(e,t),t+=2;var i=a.readUshort(e,t);t+=2,a.readUshort(e,t);for(var s=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],l=t+=2,u=0;u<i;u++){var c,d=a.readUshort(e,t);t+=2;var f=a.readUshort(e,t);t+=2;var h=a.readUshort(e,t);t+=2;var p=a.readUshort(e,t);t+=2;var $=a.readUshort(e,t);t+=2;var v=a.readUshort(e,t);t+=2;var m=s[p],_=l+12*i+v;if(0==d)c=a.readUnicode(e,_,$/2);else if(3==d&&0==f)c=a.readUnicode(e,_,$/2);else if(0==f)c=a.readASCII(e,_,$);else if(1==f)c=a.readUnicode(e,_,$/2);else if(3==f)c=a.readUnicode(e,_,$/2);else if(1==d)c=a.readASCII(e,_,$),console.warn("reading unknown MAC encoding "+f+" as ASCII");else throw"unknown encoding "+f+", platformID: "+d;var g="p"+d+","+h.toString(16);null==o[g]&&(o[g]={}),o[g][void 0!==m?m:p]=c,o[g]._lang=h}for(var y in o)if(null!=o[y].postScriptName&&1033==o[y]._lang)return o[y];for(var y in o)if(null!=o[y].postScriptName&&0==o[y]._lang)return o[y];for(var y in o)if(null!=o[y].postScriptName&&3084==o[y]._lang)return o[y];for(var y in o)if(null!=o[y].postScriptName)return o[y];for(var y in o){n=y;break}return console.warn("returning name table with languageID "+o[n]._lang),o[n]},te["OS/2"]={},te["OS/2"].parse=function(e,t,r){var n=te._bin.readUshort(e,t);t+=2;var a={};if(0==n)te["OS/2"].version0(e,t,a);else if(1==n)te["OS/2"].version1(e,t,a);else if(2==n||3==n||4==n)te["OS/2"].version2(e,t,a);else if(5==n)te["OS/2"].version5(e,t,a);else throw"unknown OS/2 table version: "+n;return a},te["OS/2"].version0=function(e,t,r){var n=te._bin;return r.xAvgCharWidth=n.readShort(e,t),t+=2,r.usWeightClass=n.readUshort(e,t),t+=2,r.usWidthClass=n.readUshort(e,t),t+=2,r.fsType=n.readUshort(e,t),t+=2,r.ySubscriptXSize=n.readShort(e,t),t+=2,r.ySubscriptYSize=n.readShort(e,t),t+=2,r.ySubscriptXOffset=n.readShort(e,t),t+=2,r.ySubscriptYOffset=n.readShort(e,t),t+=2,r.ySuperscriptXSize=n.readShort(e,t),t+=2,r.ySuperscriptYSize=n.readShort(e,t),t+=2,r.ySuperscriptXOffset=n.readShort(e,t),t+=2,r.ySuperscriptYOffset=n.readShort(e,t),t+=2,r.yStrikeoutSize=n.readShort(e,t),t+=2,r.yStrikeoutPosition=n.readShort(e,t),t+=2,r.sFamilyClass=n.readShort(e,t),t+=2,r.panose=n.readBytes(e,t,10),t+=10,r.ulUnicodeRange1=n.readUint(e,t),t+=4,r.ulUnicodeRange2=n.readUint(e,t),t+=4,r.ulUnicodeRange3=n.readUint(e,t),t+=4,r.ulUnicodeRange4=n.readUint(e,t),t+=4,r.achVendID=[n.readInt8(e,t),n.readInt8(e,t+1),n.readInt8(e,t+2),n.readInt8(e,t+3)],t+=4,r.fsSelection=n.readUshort(e,t),t+=2,r.usFirstCharIndex=n.readUshort(e,t),t+=2,r.usLastCharIndex=n.readUshort(e,t),t+=2,r.sTypoAscender=n.readShort(e,t),t+=2,r.sTypoDescender=n.readShort(e,t),t+=2,r.sTypoLineGap=n.readShort(e,t),t+=2,r.usWinAscent=n.readUshort(e,t),t+=2,r.usWinDescent=n.readUshort(e,t),t+=2},te["OS/2"].version1=function(e,t,r){var n=te._bin;return t=te["OS/2"].version0(e,t,r),r.ulCodePageRange1=n.readUint(e,t),t+=4,r.ulCodePageRange2=n.readUint(e,t),t+=4},te["OS/2"].version2=function(e,t,r){var n=te._bin;return t=te["OS/2"].version1(e,t,r),r.sxHeight=n.readShort(e,t),t+=2,r.sCapHeight=n.readShort(e,t),t+=2,r.usDefault=n.readUshort(e,t),t+=2,r.usBreak=n.readUshort(e,t),t+=2,r.usMaxContext=n.readUshort(e,t),t+=2},te["OS/2"].version5=function(e,t,r){var n=te._bin;return t=te["OS/2"].version2(e,t,r),r.usLowerOpticalPointSize=n.readUshort(e,t),t+=2,r.usUpperOpticalPointSize=n.readUshort(e,t),t+=2},te.post={},te.post.parse=function(e,t,r){var n=te._bin,a={};return a.version=n.readFixed(e,t),t+=4,a.italicAngle=n.readFixed(e,t),t+=4,a.underlinePosition=n.readShort(e,t),t+=2,a.underlineThickness=n.readShort(e,t),t+=2,a},te.SVG={},te.SVG.parse=function(e,t,r){var n=te._bin,a={entries:[]},o=t;n.readUshort(e,t),t+=2;var i=n.readUint(e,t);t+=4,n.readUint(e,t),t+=4,t=i+o;var s=n.readUshort(e,t);t+=2;for(var l=0;l<s;l++){var u=n.readUshort(e,t);t+=2;var c=n.readUshort(e,t);t+=2;var d=n.readUint(e,t);t+=4;var f=n.readUint(e,t);t+=4;for(var h=new Uint8Array(e.buffer,o+d+i,f),p=n.readUTF8(h,0,h.length),$=u;$<=c;$++)a.entries[$]=p}return a},te.SVG.toPath=function(e){var t={cmds:[],crds:[]};if(null==e)return t;for(var r=new DOMParser().parseFromString(e,"image/svg+xml").firstChild;"svg"!=r.tagName;)r=r.nextSibling;var n=r.getAttribute("viewBox");n=n?n.trim().split(" ").map(parseFloat):[0,0,1e3,1e3],te.SVG._toPath(r.children,t);for(var a=0;a<t.crds.length;a+=2){var o=t.crds[a],i=t.crds[a+1];o-=n[0],i-=n[1],i=-i,t.crds[a]=o,t.crds[a+1]=i}return t},te.SVG._toPath=function(e,t,r){for(var n=0;n<e.length;n++){var a=e[n],o=a.tagName,i=a.getAttribute("fill");if(null==i&&(i=r),"g"==o)te.SVG._toPath(a.children,t,i);else if("path"==o){t.cmds.push(i||"#000000");var s=a.getAttribute("d"),l=te.SVG._tokens(s);te.SVG._toksToPath(l,t),t.cmds.push("X")}else"defs"==o||console.warn(o,a)}},te.SVG._tokens=function(e){for(var t=[],r=0,n=!1,a="";r<e.length;){var o=e.charCodeAt(r),i=e.charAt(r);r++;var s=48<=o&&o<=57||"."==i||"-"==i;n?"-"==i?(t.push(parseFloat(a)),a=i):s?a+=i:(t.push(parseFloat(a)),","!=i&&" "!=i&&t.push(i),n=!1):s?(a=i,n=!0):","!=i&&" "!=i&&t.push(i)}return n&&t.push(parseFloat(a)),t},te.SVG._toksToPath=function(e,t){for(var r=0,n=0,a=0,o=0,i=0,s={M:2,L:2,H:1,V:1,S:4,C:6},l=t.cmds,u=t.crds;r<e.length;){var c=e[r];if(r++,"z"==c)l.push("Z"),n=o,a=i;else for(var d=c.toUpperCase(),f=s[d],h=te.SVG._reps(e,r,f),p=0;p<h;p++){var $=0,v=0;if(c!=d&&($=n,v=a),"M"==d)n=$+e[r++],a=v+e[r++],l.push("M"),u.push(n,a),o=n,i=a;else if("L"==d)n=$+e[r++],a=v+e[r++],l.push("L"),u.push(n,a);else if("H"==d)n=$+e[r++],l.push("L"),u.push(n,a);else if("V"==d)a=v+e[r++],l.push("L"),u.push(n,a);else if("C"==d){var m=$+e[r++],_=v+e[r++],g=$+e[r++],y=v+e[r++],b=$+e[r++],S=v+e[r++];l.push("C"),u.push(m,_,g,y,b,S),n=b,a=S}else if("S"==d){var U=Math.max(u.length-4,0),m=n+n-u[U],_=a+a-u[U+1],g=$+e[r++],y=v+e[r++],b=$+e[r++],S=v+e[r++];l.push("C"),u.push(m,_,g,y,b,S),n=b,a=S}else console.warn("Unknown SVG command "+c)}}},te.SVG._reps=function(e,t,r){for(var n=t;n<e.length&&"string"!=typeof e[n];)n+=r;return(n-t)/r},null==te&&(te={}),null==te.U&&(te.U={}),te.U.codeToGlyph=function(e,t){var r=e.cmap,n=-1;if(null!=r.p0e4?n=r.p0e4:null!=r.p3e1?n=r.p3e1:null!=r.p1e0?n=r.p1e0:null!=r.p0e3&&(n=r.p0e3),-1==n)throw"no familiar platform and encoding!";var a=r.tables[n];if(0==a.format)return t>=a.map.length?0:a.map[t];if(4==a.format){for(var o=-1,i=0;i<a.endCount.length;i++)if(t<=a.endCount[i]){o=i;break}if(-1==o||a.startCount[o]>t)return 0;var s=0;return 65535&(s=0!=a.idRangeOffset[o]?a.glyphIdArray[t-a.startCount[o]+(a.idRangeOffset[o]>>1)-(a.idRangeOffset.length-o)]:t+a.idDelta[o])}if(12==a.format){if(t>a.groups[a.groups.length-1][1])return 0;for(var i=0;i<a.groups.length;i++){var l=a.groups[i];if(l[0]<=t&&t<=l[1])return l[2]+(t-l[0])}return 0}throw"unknown cmap table format "+a.format},te.U.glyphToPath=function(e,t){var r={cmds:[],crds:[]};if(e.SVG&&e.SVG.entries[t]){var n=e.SVG.entries[t];return null==n?r:("string"==typeof n&&(n=te.SVG.toPath(n),e.SVG.entries[t]=n),n)}if(e.CFF){var a={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:e.CFF.Private?e.CFF.Private.defaultWidthX:0,open:!1},o=e.CFF,i=e.CFF.Private;if(o.ROS){for(var s=0;o.FDSelect[s+2]<=t;)s+=2;i=o.FDArray[o.FDSelect[s+1]].Private}te.U._drawCFF(e.CFF.CharStrings[t],a,o,i,r)}else e.glyf&&te.U._drawGlyf(t,e,r);return r},te.U._drawGlyf=function(e,t,r){var n=t.glyf[e];null==n&&(n=t.glyf[e]=te.glyf._parseGlyf(t,e)),null!=n&&(n.noc>-1?te.U._simpleGlyph(n,r):te.U._compoGlyph(n,t,r))},te.U._simpleGlyph=function(e,t){for(var r=0;r<e.noc;r++){for(var n=0==r?0:e.endPts[r-1]+1,a=e.endPts[r],o=n;o<=a;o++){var i=o==n?a:o-1,s=o==a?n:o+1,l=1&e.flags[o],u=1&e.flags[i],c=1&e.flags[s],d=e.xs[o],f=e.ys[o];if(o==n){if(l){if(u)te.U.P.moveTo(t,e.xs[i],e.ys[i]);else{te.U.P.moveTo(t,d,f);continue}}else u?te.U.P.moveTo(t,e.xs[i],e.ys[i]):te.U.P.moveTo(t,(e.xs[i]+d)/2,(e.ys[i]+f)/2)}l?u&&te.U.P.lineTo(t,d,f):c?te.U.P.qcurveTo(t,d,f,e.xs[s],e.ys[s]):te.U.P.qcurveTo(t,d,f,(d+e.xs[s])/2,(f+e.ys[s])/2)}te.U.P.closePath(t)}},te.U._compoGlyph=function(e,t,r){for(var n=0;n<e.parts.length;n++){var a={cmds:[],crds:[]},o=e.parts[n];te.U._drawGlyf(o.glyphIndex,t,a);for(var i=o.m,s=0;s<a.crds.length;s+=2){var l=a.crds[s],u=a.crds[s+1];r.crds.push(l*i.a+u*i.b+i.tx),r.crds.push(l*i.c+u*i.d+i.ty)}for(var s=0;s<a.cmds.length;s++)r.cmds.push(a.cmds[s])}},te.U._getGlyphClass=function(e,t){var r=te._lctf.getInterval(t,e);return -1==r?0:t[r+2]},te.U.getPairAdjustment=function(e,t,r){var n=!1;if(e.GPOS)for(var a=e.GPOS,o=a.lookupList,i=a.featureList,s=[],l=0;l<i.length;l++){var u=i[l];if("kern"==u.tag){n=!0;for(var c=0;c<u.tab.length;c++)if(!s[u.tab[c]]){s[u.tab[c]]=!0;for(var d=o[u.tab[c]],f=0;f<d.tabs.length;f++)if(null!=d.tabs[f]){var h,p=d.tabs[f];if(p.coverage&&-1==(h=te._lctf.coverageIndex(p.coverage,t)))continue;if(1==d.ltype);else if(2==d.ltype){var $=null;if(1==p.fmt)for(var v=p.pairsets[h],l=0;l<v.length;l++)v[l].gid2==r&&($=v[l]);else if(2==p.fmt){var m=te.U._getGlyphClass(t,p.classDef1),_=te.U._getGlyphClass(r,p.classDef2);$=p.matrix[m][_]}if($){var g=0;return $.val1&&$.val1[2]&&(g+=$.val1[2]),$.val2&&$.val2[0]&&(g+=$.val2[0]),g}}}}}}if(e.kern&&!n){var y=e.kern.glyph1.indexOf(t);if(-1!=y){var b=e.kern.rval[y].glyph2.indexOf(r);if(-1!=b)return e.kern.rval[y].vals[b]}}return 0},te.U.stringToGlyphs=function(e,t){for(var r=[],n=0;n<t.length;n++){var a=t.codePointAt(n);a>65535&&n++,r.push(te.U.codeToGlyph(e,a))}for(var n=0;n<t.length;n++){var a=t.codePointAt(n);if(2367==a){var o=r[n-1];r[n-1]=r[n],r[n]=o}a>65535&&n++}var i=e.GSUB;if(null==i)return r;for(var s=i.lookupList,l=i.featureList,u=["rlig","liga","mset","isol","init","fina","medi","half","pres","blws"],c=[],d=0;d<l.length;d++){var f=l[d];if(-1!=u.indexOf(f.tag)){for(var h=0;h<f.tab.length;h++)if(!c[f.tab[h]]){c[f.tab[h]]=!0;for(var p=s[f.tab[h]],$=0;$<r.length;$++){var v=te.U._getWPfeature(t,$);(-1=="isol,init,fina,medi".indexOf(f.tag)||f.tag==v)&&te.U._applySubs(r,$,p,s)}}}}return r},te.U._getWPfeature=function(e,t){var r='\n	" ,.:;!?()  ،',n="آأؤإاةدذرزوٱٲٳٵٶٷڈډڊڋڌڍڎڏڐڑڒړڔڕږڗژڙۀۃۄۅۆۇۈۉۊۋۍۏےۓەۮۯܐܕܖܗܘܙܞܨܪܬܯݍݙݚݛݫݬݱݳݴݸݹࡀࡆࡇࡉࡔࡧࡩࡪࢪࢫࢬࢮࢱࢲࢹૅેૉ૊૎૏ૐ૑૒૝ૡ૤૯஁ஃ஄அஉ஌எஏ஑னப஫஬",a="ꡲ્૗",o=0==t||-1!=r.indexOf(e[t-1]),i=t==e.length-1||-1!=r.indexOf(e[t+1]);o||-1==n.indexOf(e[t-1])||(o=!0),i||-1==n.indexOf(e[t])||(i=!0),i||-1==a.indexOf(e[t+1])||(i=!0),o||-1==a.indexOf(e[t])||(o=!0);var s=null;return o?i?"isol":"init":i?"fina":"medi"},te.U._applySubs=function(e,t,r,n){for(var a=e.length-t-1,o=0;o<r.tabs.length;o++)if(null!=r.tabs[o]){var i,s=r.tabs[o];if(s.coverage&&-1==(i=te._lctf.coverageIndex(s.coverage,e[t])))continue;if(1==r.ltype)e[t],1==s.fmt?e[t]=e[t]+s.delta:e[t]=s.newg[i];else if(4==r.ltype)for(var l=s.vals[i],u=0;u<l.length;u++){var c=l[u],d=c.chain.length;if(!(d>a)){for(var f=!0,h=0,p=0;p<d;p++){for(;-1==e[t+h+(1+p)];)h++;c.chain[p]!=e[t+h+(1+p)]&&(f=!1)}if(f){e[t]=c.nglyph;for(var p=0;p<d+h;p++)e[t+p+1]=-1;break}}}else if(5==r.ltype&&2==s.fmt)for(var $=te._lctf.getInterval(s.cDef,e[t]),v=s.cDef[$+2],m=s.scset[v],_=0;_<m.length;_++){var g=m[_],y=g.input;if(!(y.length>a)){for(var f=!0,p=0;p<y.length;p++){var b=te._lctf.getInterval(s.cDef,e[t+1+p]);if(-1==$&&s.cDef[b+2]!=y[p]){f=!1;break}}if(f)for(var S=g.substLookupRecords,u=0;u<S.length;u+=2)S[u],S[u+1]}}else if(6==r.ltype&&3==s.fmt){if(!te.U._glsCovered(e,s.backCvg,t-s.backCvg.length)||!te.U._glsCovered(e,s.inptCvg,t)||!te.U._glsCovered(e,s.ahedCvg,t+s.inptCvg.length))continue;for(var U=s.lookupRec,_=0;_<U.length;_+=2){var $=U[_],w=n[U[_+1]];te.U._applySubs(e,t+$,w,n)}}}},te.U._glsCovered=function(e,t,r){for(var n=0;n<t.length;n++)if(-1==te._lctf.coverageIndex(t[n],e[r+n]))return!1;return!0},te.U.glyphsToPath=function(e,t,r){for(var n={cmds:[],crds:[]},a=0,o=0;o<t.length;o++){var i=t[o];if(-1!=i){for(var s=o<t.length-1&&-1!=t[o+1]?t[o+1]:0,l=te.U.glyphToPath(e,i),u=0;u<l.crds.length;u+=2)n.crds.push(l.crds[u]+a),n.crds.push(l.crds[u+1]);r&&n.cmds.push(r);for(var u=0;u<l.cmds.length;u++)n.cmds.push(l.cmds[u]);r&&n.cmds.push("X"),a+=e.hmtx.aWidth[i],o<t.length-1&&(a+=te.U.getPairAdjustment(e,i,s))}}return n},te.U.pathToSVG=function(e,t){null==t&&(t=5);for(var r=[],n=0,a={M:2,L:2,Q:4,C:6},o=0;o<e.cmds.length;o++){var i=e.cmds[o],s=n+(a[i]?a[i]:0);for(r.push(i);n<s;){var l=e.crds[n++];r.push(parseFloat(l.toFixed(t))+(n==s?"":" "))}}return r.join("")},te.U.pathToContext=function(e,t){for(var r=0,n=e.crds,a=0;a<e.cmds.length;a++){var o=e.cmds[a];"M"==o?(t.moveTo(n[r],n[r+1]),r+=2):"L"==o?(t.lineTo(n[r],n[r+1]),r+=2):"C"==o?(t.bezierCurveTo(n[r],n[r+1],n[r+2],n[r+3],n[r+4],n[r+5]),r+=6):"Q"==o?(t.quadraticCurveTo(n[r],n[r+1],n[r+2],n[r+3]),r+=4):"#"==o.charAt(0)?(t.beginPath(),t.fillStyle=o):"Z"==o?t.closePath():"X"==o&&t.fill()}},te.U.P={},te.U.P.moveTo=function(e,t,r){e.cmds.push("M"),e.crds.push(t,r)},te.U.P.lineTo=function(e,t,r){e.cmds.push("L"),e.crds.push(t,r)},te.U.P.curveTo=function(e,t,r,n,a,o,i){e.cmds.push("C"),e.crds.push(t,r,n,a,o,i)},te.U.P.qcurveTo=function(e,t,r,n,a){e.cmds.push("Q"),e.crds.push(t,r,n,a)},te.U.P.closePath=function(e){e.cmds.push("Z")},te.U._drawCFF=function(e,t,r,n,a){for(var o=t.stack,i=t.nStems,s=t.haveWidth,l=t.width,u=t.open,c=0,d=t.x,f=t.y,h=0,p=0,$=0,v=0,m=0,_=0,g=0,y=0,b=0,S=0,U={val:0,size:0};c<e.length;){te.CFF.getCharString(e,c,U);var w=U.val;if(c+=U.size,"o1"==w||"o18"==w)(O=o.length%2!=0)&&!s&&(l=o.shift()+n.nominalWidthX),i+=o.length>>1,o.length=0,s=!0;else if("o3"==w||"o23"==w)(O=o.length%2!=0)&&!s&&(l=o.shift()+n.nominalWidthX),i+=o.length>>1,o.length=0,s=!0;else if("o4"==w)o.length>1&&!s&&(l=o.shift()+n.nominalWidthX,s=!0),u&&te.U.P.closePath(a),f+=o.pop(),te.U.P.moveTo(a,d,f),u=!0;else if("o5"==w)for(;o.length>0;)d+=o.shift(),f+=o.shift(),te.U.P.lineTo(a,d,f);else if("o6"==w||"o7"==w)for(var x=o.length,C="o6"==w,k=0;k<x;k++){var F=o.shift();C?d+=F:f+=F,C=!C,te.U.P.lineTo(a,d,f)}else if("o8"==w||"o24"==w){for(var x=o.length,P=0;P+6<=x;)h=d+o.shift(),p=f+o.shift(),$=h+o.shift(),v=p+o.shift(),d=$+o.shift(),f=v+o.shift(),te.U.P.curveTo(a,h,p,$,v,d,f),P+=6;"o24"==w&&(d+=o.shift(),f+=o.shift(),te.U.P.lineTo(a,d,f))}else if("o11"==w)break;else if("o1234"==w||"o1235"==w||"o1236"==w||"o1237"==w)"o1234"==w&&(h=d+o.shift(),p=f,$=h+o.shift(),v=p+o.shift(),b=$+o.shift(),S=v,m=b+o.shift(),_=v,g=m+o.shift(),y=f,d=g+o.shift(),te.U.P.curveTo(a,h,p,$,v,b,S),te.U.P.curveTo(a,m,_,g,y,d,f)),"o1235"==w&&(h=d+o.shift(),p=f+o.shift(),$=h+o.shift(),v=p+o.shift(),b=$+o.shift(),S=v+o.shift(),m=b+o.shift(),_=S+o.shift(),g=m+o.shift(),y=_+o.shift(),d=g+o.shift(),f=y+o.shift(),o.shift(),te.U.P.curveTo(a,h,p,$,v,b,S),te.U.P.curveTo(a,m,_,g,y,d,f)),"o1236"==w&&(h=d+o.shift(),p=f+o.shift(),$=h+o.shift(),v=p+o.shift(),b=$+o.shift(),S=v,m=b+o.shift(),_=v,g=m+o.shift(),y=_+o.shift(),d=g+o.shift(),te.U.P.curveTo(a,h,p,$,v,b,S),te.U.P.curveTo(a,m,_,g,y,d,f)),"o1237"==w&&(h=d+o.shift(),p=f+o.shift(),$=h+o.shift(),v=p+o.shift(),b=$+o.shift(),S=v+o.shift(),m=b+o.shift(),_=S+o.shift(),Math.abs((g=m+o.shift())-d)>Math.abs((y=_+o.shift())-f)?d=g+o.shift():f=y+o.shift(),te.U.P.curveTo(a,h,p,$,v,b,S),te.U.P.curveTo(a,m,_,g,y,d,f));else if("o14"==w){if(o.length>0&&!s&&(l=o.shift()+r.nominalWidthX,s=!0),4==o.length){var L=o.shift(),T=o.shift(),B=o.shift(),V=o.shift(),I=te.CFF.glyphBySE(r,B),N=te.CFF.glyphBySE(r,V);te.U._drawCFF(r.CharStrings[I],t,r,n,a),t.x=L,t.y=T,te.U._drawCFF(r.CharStrings[N],t,r,n,a)}u&&(te.U.P.closePath(a),u=!1)}else if("o19"==w||"o20"==w)(O=o.length%2!=0)&&!s&&(l=o.shift()+n.nominalWidthX),i+=o.length>>1,o.length=0,s=!0,c+=i+7>>3;else if("o21"==w)o.length>2&&!s&&(l=o.shift()+n.nominalWidthX,s=!0),f+=o.pop(),d+=o.pop(),u&&te.U.P.closePath(a),te.U.P.moveTo(a,d,f),u=!0;else if("o22"==w)o.length>1&&!s&&(l=o.shift()+n.nominalWidthX,s=!0),d+=o.pop(),u&&te.U.P.closePath(a),te.U.P.moveTo(a,d,f),u=!0;else if("o25"==w){for(;o.length>6;)d+=o.shift(),f+=o.shift(),te.U.P.lineTo(a,d,f);h=d+o.shift(),p=f+o.shift(),$=h+o.shift(),v=p+o.shift(),d=$+o.shift(),f=v+o.shift(),te.U.P.curveTo(a,h,p,$,v,d,f)}else if("o26"==w)for(o.length%2&&(d+=o.shift());o.length>0;)h=d,p=f+o.shift(),$=h+o.shift(),v=p+o.shift(),d=$,f=v+o.shift(),te.U.P.curveTo(a,h,p,$,v,d,f);else if("o27"==w)for(o.length%2&&(f+=o.shift());o.length>0;)h=d+o.shift(),p=f,$=h+o.shift(),v=p+o.shift(),d=$+o.shift(),f=v,te.U.P.curveTo(a,h,p,$,v,d,f);else if("o10"==w||"o29"==w){var E="o10"==w?n:r;if(0==o.length)console.warn("error: empty stack");else{var A=o.pop(),G=E.Subrs[A+E.Bias];t.x=d,t.y=f,t.nStems=i,t.haveWidth=s,t.width=l,t.open=u,te.U._drawCFF(G,t,r,n,a),d=t.x,f=t.y,i=t.nStems,s=t.haveWidth,l=t.width,u=t.open}}else if("o30"==w||"o31"==w){var O,x,z=o.length,P=0,D="o31"==w;for(x=-3&z,P+=z-x;P<x;)D?(h=d+o.shift(),p=f,$=h+o.shift(),f=(v=p+o.shift())+o.shift(),x-P==5?(d=$+o.shift(),P++):d=$,D=!1):(h=d,p=f+o.shift(),$=h+o.shift(),v=p+o.shift(),d=$+o.shift(),x-P==5?(f=v+o.shift(),P++):f=v,D=!0),te.U.P.curveTo(a,h,p,$,v,d,f),P+=4}else if("o"==(w+"").charAt(0))throw console.warn("Unknown operation: "+w,e),w;else o.push(w)}t.x=d,t.y=f,t.nStems=i,t.haveWidth=s,t.width=l,t.open=u},eZ.Typr=te;var tt=void 0,tr=eZ,tn={aalt:"Access All Alternates",abvf:"Above-base Forms",abvm:"Above - base Mark Positioning",abvs:"Above - base Substitutions",afrc:"Alternative Fractions",akhn:"Akhands",blwf:"Below - base Forms",blwm:"Below - base Mark Positioning",blws:"Below - base Substitutions",calt:"Contextual Alternates",case:"Case - Sensitive Forms",ccmp:"Glyph Composition / Decomposition",cfar:"Conjunct Form After Ro",cjct:"Conjunct Forms",clig:"Contextual Ligatures",cpct:"Centered CJK Punctuation",cpsp:"Capital Spacing",cswh:"Contextual Swash",curs:"Cursive Positioning",c2pc:"Petite Capitals From Capitals",c2sc:"Small Capitals From Capitals",dist:"Distances",dlig:"Discretionary Ligatures",dnom:"Denominators",dtls:"Dotless Forms",expt:"Expert Forms",falt:"Final Glyph on Line Alternates",fin2:"Terminal Forms #2",fin3:"Terminal Forms #3",fina:"Terminal Forms",flac:"Flattened accent forms",frac:"Fractions",fwid:"Full Widths",half:"Half Forms",haln:"Halant Forms",halt:"Alternate Half Widths",hist:"Historical Forms",hkna:"Horizontal Kana Alternates",hlig:"Historical Ligatures",hngl:"Hangul",hojo:"Hojo Kanji Forms(JIS X 0212 - 1990 Kanji Forms)",hwid:"Half Widths",init:"Initial Forms",isol:"Isolated Forms",ital:"Italics",jalt:"Justification Alternates",jp78:"JIS78 Forms",jp83:"JIS83 Forms",jp90:"JIS90 Forms",jp04:"JIS2004 Forms",kern:"Kerning",lfbd:"Left Bounds",liga:"Standard Ligatures",ljmo:"Leading Jamo Forms",lnum:"Lining Figures",locl:"Localized Forms",ltra:"Left - to - right alternates",ltrm:"Left - to - right mirrored forms",mark:"Mark Positioning",med2:"Medial Forms #2",medi:"Medial Forms",mgrk:"Mathematical Greek",mkmk:"Mark to Mark Positioning",mset:"Mark Positioning via Substitution",nalt:"Alternate Annotation Forms",nlck:"NLC Kanji Forms",nukt:"Nukta Forms",numr:"Numerators",onum:"Oldstyle Figures",opbd:"Optical Bounds",ordn:"Ordinals",ornm:"Ornaments",palt:"Proportional Alternate Widths",pcap:"Petite Capitals",pkna:"Proportional Kana",pnum:"Proportional Figures",pref:"Pre - Base Forms",pres:"Pre - base Substitutions",pstf:"Post - base Forms",psts:"Post - base Substitutions",pwid:"Proportional Widths",qwid:"Quarter Widths",rand:"Randomize",rclt:"Required Contextual Alternates",rkrf:"Rakar Forms",rlig:"Required Ligatures",rphf:"Reph Forms",rtbd:"Right Bounds",rtla:"Right - to - left alternates",rtlm:"Right - to - left mirrored forms",ruby:"Ruby Notation Forms",rvrn:"Required Variation Alternates",salt:"Stylistic Alternates",sinf:"Scientific Inferiors",size:"Optical size",smcp:"Small Capitals",smpl:"Simplified Forms",ssty:"Math script style alternates",stch:"Stretching Glyph Decomposition",subs:"Subscript",sups:"Superscript",swsh:"Swash",titl:"Titling",tjmo:"Trailing Jamo Forms",tnam:"Traditional Name Forms",tnum:"Tabular Figures",trad:"Traditional Forms",twid:"Third Widths",unic:"Unicase",valt:"Alternate Vertical Metrics",vatu:"Vattu Variants",vert:"Vertical Writing",vhal:"Alternate Vertical Half Metrics",vjmo:"Vowel Jamo Forms",vkna:"Vertical Kana Alternates",vkrn:"Vertical Kerning",vpal:"Proportional Alternate Vertical Metrics",vrt2:"Vertical Alternates and Rotation",vrtr:"Vertical Alternates for Rotation",zero:"Slashed Zero"};tt=function(){function e(e){var t=tr.Typr.parse(e);if(!t.length||"object"!=typeof t[0]||"function"!=typeof t[0].hasOwnProperty)throw"unable to parse font";for(var r in t[0])this[r]=t[0][r];this.enabledGSUB={}}return e.prototype.getFamilyName=function(){return this.name&&(this.name.typoFamilyName||this.name.fontFamily)||""},e.prototype.getSubFamilyName=function(){return this.name&&(this.name.typoSubfamilyName||this.name.fontSubfamily)||""},e.prototype.glyphToPath=function(e){return tr.Typr.U.glyphToPath(this,e)},e.prototype.getPairAdjustment=function(e,t){return tr.Typr.U.getPairAdjustment(this,e,t)},e.prototype.stringToGlyphs=function(e){return tr.Typr.U.stringToGlyphs(this,e)},e.prototype.glyphsToPath=function(e){return tr.Typr.U.glyphsToPath(this,e)},e.prototype.pathToSVG=function(e,t){return tr.Typr.U.pathToSVG(e,t)},e.prototype.pathToContext=function(e,t){return tr.Typr.U.pathToContext(e,t)},e.prototype.lookupFriendlyName=function(e,t){if(void 0!==this[e]){var r=this[e].featureList[t];return this.featureFriendlyName(r)}return""},e.prototype.featureFriendlyName=function(e){if(tn[e.tag])return tn[e.tag];if(e.tag.match(/ss[0-2][0-9]/)){var t="Stylistic Set "+Number(e.tag.substr(2,2)).toString();if(e.featureParams&&0===tr.Typr._bin.readUshort(this._data,e.featureParams)){var r=tr.Typr._bin.readUshort(this._data,e.featureParams+2);if(this.name&&void 0!==this.name[r])return t+" - "+this.name[r]}return t}return e.tag.match(/cv[0-9][0-9]/)?"Character Variant "+Number(e.tag.substr(2,2)).toString():""},e.prototype.enableGSUB=function(e){if(this.GSUB){var t=this.GSUB.featureList[e];if(t)for(var r=0;r<t.tab.length;++r)this.enabledGSUB[t.tab[r]]=(this.enabledGSUB[t.tab[r]]||0)+1}},e.prototype.disableGSUB=function(e){if(this.GSUB){var t=this.GSUB.featureList[e];if(t)for(var r=0;r<t.tab.length;++r)this.enabledGSUB[t.tab[r]]>1?--this.enabledGSUB[t.tab[r]]:delete this.enabledGSUB[t.tab[r]]}},e.prototype.codeToGlyph=function(e){var t=tr.Typr.U.codeToGlyph(this,e);if(this.GSUB){var r=[t];for(var n in this.enabledGSUB){var a=this.GSUB.lookupList[n];tr.Typr.U._applySubs(r,0,a,this.GSUB.lookupList)}if(1===r.length)return r[0]}return t},e}();let ta=e=>new Promise(t=>setTimeout(t,1e3*e)),to={单选题:"0",多选题:"1",填空题:"2",判断题:"3",简答题:"4",名词解释:"5",论述题:"6",计算题:"7"};class ti{constructor(){s(this,"_document",document),s(this,"_window",N),s(this,"addLog"),s(this,"addQuestion"),s(this,"questions",[]),s(this,"correctNum",0),s(this,"parseHtml",()=>{throw Error("请使用继承类的重写方法")}),s(this,"fillQuestion",e=>{throw Error("请使用继承类的重写方法")}),s(this,"removeHtml",e=>null==e?"":e.replace(/<((?!img|sub|sup|br)[^>]+)>/g,"").replace(/&nbsp;/g," ").replace(/\s+/g," ").replace(/<br\s*\/?>/g,"\n").replace(/<img.*?src="(.*?)".*?>/g,'<img src="$1"/>').trim());let e=D(),t=q();this.addLog=e.addLog,this.addQuestion=t.addQuestion}}let ts=e=>({code:-1,data:{answer:[],num:"",usenum:""},msg:e}),tl=async e=>{var t;let r=N,n=A(),a={"Content-Type":"application/json",referer:e.refer,u:r.uid||r.getCookie("UID")||r.getCookie("_uid")||"",t:Math.floor(new Date().getTime()/1e3).toString()},o=JSON.stringify({question:e.title,options:Object.keys(e.options),type:to[e.type],questionData:e.element.outerHTML,workType:e.workType,id:(null==(t=e.refer.match(/courseId=(\d+)/))?void 0:t[1])||"",key:n.queryApis[0].token});return await ta(n.otherParams.params[0].value),new Promise(e=>{I({url:"http://www.tiku.me/search",method:"POST",headers:a,data:o,timeout:5e3,onload(t){try{let r=JSON.parse(t.responseText);e(r)}catch(n){e(ts("解析出错"))}},onerror:()=>e(ts("请求出错")),ontimeout:()=>e(ts("请求超时"))})})};class tu extends ti{constructor(e,t){super(),s(this,"type"),s(this,"init",async()=>{if(this.questions=[],this.parseHtml(),this.questions.length)for(let[e,t]of(this.addLog(`成功解析到${this.questions.length}个题目`,"primary"),this.questions.entries())){let r=await tl(t);200===r.code?(t.answer=r.data.answer,this.fillQuestion(t),this.addLog(`第${e+1}道题搜索成功`,"success"),this.addLog(`剩余次数:${r.data.num}`,"primary"),this.correctNum+=1):-1===r.code&&(this.addLog(`第${e+1}道题搜索失败，点击上方答题查看原因`,"danger"),t.answer[0]=r.msg+'<a style="font-weight: bold">，或可以关注公众号“高校工具箱”查题</a>'),this.addQuestion(t)}else this.addLog("未解析到题目","danger");return Promise.resolve(this.correctNum/this.questions.length*100)}),s(this,"parseHtml",()=>{if(!this._document)return[];if(["zj","zj_new"].includes(this.type)){let e=this._document.querySelectorAll(".TiMu");this.addQuestions(e)}else if(["zy","ks"].includes(this.type)){let t=this._document.querySelectorAll(".questionLi");this.addQuestions(t)}}),s(this,"fillQuestion",e=>{var t,r;if(this._window){if("单选题"===e.type||"多选题"===e.type)e.answer.forEach(t=>{for(let r in e.options)if(r===this.removeHtml(t)){if(["zj"].includes(this.type)){let n=e.options[r].querySelector("input");if(null==n?void 0:n.getAttribute("checked"))return;null==n||n.click()}else if(["zj_new","zy"].includes(this.type)){let a=e.options[r];if("true"===a.getAttribute("aria-checked"))return;null==a||a.click()}else if(["ks"].includes(this.type)){let o=e.options[r];if(o.querySelector(".check_answer"))return;null==o||o.click()}}});else if("填空题"===e.type){let n=e.element.querySelectorAll("textarea");if(0===n.length)return;n.forEach((t,r)=>{try{let n=this._window.UE.getEditor(t.name);n.setContent(e.answer[r])}catch(a){t.value=""}})}else if("判断题"===e.type){let a="true";e.answer[0].match(/(^|,)(正确|是|对|√|T|ri|right|true)(,|$)/)?a="true":e.answer[0].match(/(^|,)(错误|否|错|×|F|wr|wrong|false)(,|$)/)&&(a="false");let o={true:"对",false:"错"};for(let i in e.options)if(["zj"].includes(this.type)){let s=e.options[i].querySelector(`input[value='${a}']`);if(null==s?void 0:s.getAttribute("checked"))return;null==s||s.click()}else if(["zj_new","zy"].includes(this.type)){if(null==(t=e.options[i].getAttribute("aria-label"))?void 0:t.includes(`${o[a]}选择`)){if("true"===e.options[i].getAttribute("aria-checked"))return;null==(r=e.options[i])||r.click()}}else if(["ks"].includes(this.type)){let l=e.options[i].querySelector(`span[data='${a}']`);if(null==l?void 0:l.querySelector(".check_answer"))return;null==l||l.click()}}else if("简答题"===e.type){let u=e.element.querySelector("textarea");if(!u)return;let c=this._window.UE.getEditor(u.name);c.setContent(e.answer[0])}}}),this.type=e,t&&(this._document=t.contentDocument,this._window=t.contentWindow)}extractOptions(e,t){let r={};return e.forEach(e=>{var n;let a=this.removeHtml((null==(n=e.querySelector(t))?void 0:n.innerHTML)||"");r[a]=e}),r}addQuestions(e){e.forEach(e=>{var t,r,n;let a="",o="",i,s={};if(["zy","ks"].includes(this.type)){let l=(null==(t=null==e?void 0:e.querySelector("h3"))?void 0:t.innerHTML)||"",u=(null==(r=e.querySelector(".colorShallow"))?void 0:r.outerHTML)||"";["zy"].includes(this.type)?o=(null==e?void 0:e.getAttribute("typename"))||"":["ks"].includes(this.type)&&(o=this.removeHtml(u).slice(1,4)||""),a=this.removeHtml(l.split(u||"")[1]||""),i=e.querySelectorAll(".answerBg"),s=this.extractOptions(i,".answer_p")}else["zj","zj_new"].includes(this.type)&&(o=(a=this.removeHtml((null==(n=e.querySelector(".fontLabel"))?void 0:n.innerHTML)||"")).slice(1,4)||"",i=e.querySelectorAll('[class*="before-after"]'),s=this.extractOptions(i,".fl.after"),a=a.replace(`【${o}】`,""));this.questions.push({element:e,type:o,title:a,options:s,answer:[],workType:["zj_new"].includes(this.type)?"zj":this.type,refer:this._window.location.href})})}}let tc=()=>{let e=D(),t=A(),a=e=>{let t=document.documentElement,r=t.querySelector("iframe");if(!r){console.warn("No iframe found.");return}"WATCH"===e&&i(t),r.addEventListener("load",function(){i(t)})},o=0,i=n=>{let a=++o;eJ.getAllNestedIframes(n).subscribe(i=>{var s,l;r.from(i).pipe((s=e=>d(e),ey(l)?eX(s,l,1):eX(s,1))).subscribe({async complete(){if(a===o){if(e.addLog(`本页任务点已全部完成，正前往下一章节`,"success"),t.platformParams.cx.parts[0].params[1].value){let r=n.querySelector("#prevNextFocusNext");(null==r?void 0:r.getAttribute("onclick"))?(await ta(t.otherParams.params[0].value),document.querySelector(".jb_btn.jb_btn_92.fr.fs14.nextChapter").click()):e.addLog(`当前是最后一个任务点`,"success")}else e.addLog(`已经关闭自动下一章节，在设置里可更改`,"danger")}}})})},s=async(r,n)=>new Promise(a=>{e.addLog(`发现一个${r}，正在解析`,"warning"),e.addLog(`正在尝试播放${r}，请稍等5s`,"primary");let o=!1,i=setInterval(async()=>{let s=n.documentElement.querySelector(r);if(s&&!o){e.addLog("播放成功","success"),await s.pause(),s.muted=!0,await s.play();let l=async()=>{await ta(t.otherParams.params[0].value),await s.play()};s.addEventListener("pause",l),s.addEventListener("ended",()=>{e.addLog(`${r}已播放完成`,"success"),s.removeEventListener("pause",l),a()}),o=!0,clearInterval(i)}},2500)}),l=async(r,a,o)=>(e.addLog("发现一个作业，正在解析","warning"),new Promise(async i=>{if(!a)return i();if(a.documentElement.innerText.includes("已完成")||a.documentElement.innerText.includes("待批阅"))return e.addLog("作业已经完成，跳过","success"),i();(function e(t){var r,a,o;let i=t.querySelectorAll("style"),s;for(let l=0;l<i.length;l++)if(null==(r=i[l].textContent)?void 0:r.includes("font-cxsecret")){s=i[l];break}if(!s)return;let u=null==(o=null==(a=s.textContent)?void 0:a.match(/base64,([\w\W]+?)'/))?void 0:o[1];if(!u)return;let c=function e(t){let r=window.atob(t),n=new Uint8Array(r.length);for(let a=0;a<r.length;++a)n[a]=r.charCodeAt(a);return n}(u),d=new tt(c),f=JSON.parse(L("ttf")),h={};for(let p=19968;p<40870;p++){let $=d.codeToGlyph(p);if(!$)continue;let v=d.glyphToPath($),m=n(JSON.stringify(v)).slice(24);h[p]=f[m]}let _=t.querySelectorAll(".font-cxsecret");for(let g=0;g<_.length;g++){let y=_[g],b=y.innerHTML;for(let S in h){let U=String.fromCharCode(h[S]),w=RegExp(String.fromCharCode(Number(S)),"g");b=b.replace(w,U)}y.innerHTML=b,y.classList.remove("font-cxsecret")}})(a),e.addLog(`题目列表获取成功`,"primary");let s;s=r.src.includes("mooc2")?"zj_new":"zj";let l=await new tu(s,r).init();return o.alert=()=>{},t.platformParams.cx.parts[0].params[0].value?(e.addLog("自动提交已开启，尝试提交","primary"),l<Number(t.otherParams.params[1].value)?(e.addLog(`正确率小于${t.otherParams.params[1].value}%，暂存`,"danger"),await o.noSubmit()):(e.addLog(`正确率大于${t.otherParams.params[1].value}%，提交`,"success"),await o.btnBlueSubmit(),await ta(t.otherParams.params[0].value/2),await o.submitCheckTimes(),e.addLog("提交成功","success"))):(e.addLog("未开启自动提交，暂存","primary"),await o.noSubmit()),e.addLog("作业已完成","success"),i()})),u=async t=>{let r=t.document.querySelector("#panView").contentWindow;return e.addLog("发现一个PPT，正在解析","warning"),await r.scrollTo({top:r.document.body.scrollHeight,behavior:"smooth"}),e.addLog("阅读完成","success"),Promise.resolve()},c=async e=>new Promise(t=>{let r=setInterval(async()=>{var n;e.contentDocument&&(null==(n=e.contentDocument)?void 0:n.readyState)=="complete"&&(t(),clearInterval(r))},500)}),d=async r=>{var n,a;let o=r.src,i=r.contentDocument,d=r.contentWindow;if(!i||!d||o.includes("javascript:"))return Promise.resolve();await c(r);let f=(null==(n=r.parentElement)?void 0:n.className)||"";if(f.includes("ans-job-finished"))e.addLog("发现一个已完成任务点","success");else{if(o.includes("api/work"))return l(r,i,d);if(t.platformParams.cx.parts[0].params[2].value)e.addLog("只答题，不做其他已开启，可在设置里调整","primary");else{let h=null==(a=r.parentElement)?void 0:a.querySelector(".ans-job-icon");if(h){if(o.includes("video"))return s("video",i);if(o.includes("audio"))return s("audio",i);if(["ppt","doc","pptx","docx","pdf"].some(e=>o.includes("modules/"+e)))return u(d)}}}return Promise.resolve()};(()=>{let t=window.location.href;t.includes("&mooc2=1")||(window.location.href=t+"&mooc2=1"),e.addLog(`检测到用户进入到章节学习页面`,"primary"),e.addLog(`正在解析任务点，请稍等5-10秒（如果长时间没有反应，请刷新页面）`,"warning")})(),a("WATCH"),(()=>{let e=()=>{a("INIT")};new eK(["schoolCourseInfo"],e)})()},td=async()=>{let e=D();A(),e.addLog(`进入新版作业页面，开始准备答题`,"primary"),e.addLog(`正在解析题目, 请等待5s`,"warning"),await new tu("zy").init()},tf=async()=>{let e=D(),t=A();e.addLog(`进入新版考试页面，开始准备答题`,"primary"),e.addLog(`正在解析题目, 请等待5s`,"warning"),await new tu("ks").init(),t.platformParams.cx.parts[1].params[0].value?(e.addLog("自动切换已开启，正在前往下一题","success"),await ta(t.otherParams.params[0].value),document.querySelector(".jb_btn.jb_btn_92.fs14").click()):e.addLog("已经关闭自动切换，在设置里可更改","danger")};class th extends ti{constructor(){super(),s(this,"init",async()=>{var e;if(this.questions=[],this.parseHtml(),this.questions.length)for(let[t,r]of(this.addLog(`成功解析到${this.questions.length}个题目`,"primary"),this.questions.entries())){let n=await tl(r);200===n.code?(r.answer=n.data.answer,this.fillQuestion(r),this.addLog(`第${t+1}道题搜索成功`,"success"),this.addLog(`剩余次数:${n.data.num}`,"primary")):-1===n.code&&(this.addLog(`第${t+1}道题搜索失败，点击上方答题查看原因`,"danger"),r.answer[0]=n.msg+'<a style="font-weight: bold">，或可以关注公众号“高校工具箱”查题</a>'),this.addQuestion(r),await (null==(e=this._document)?void 0:e.querySelectorAll(".switch-btn-box > button")[1]).click()}else this.addLog("未解析到题目，正在重试","danger")}),s(this,"parseHtml",()=>{if(!this._document)return[];let e=this._document.querySelectorAll(".examPaper_subject");this.addQuestions(e)}),s(this,"fillQuestion",e=>{if(this._window){if("单选题"===e.type||"多选题"===e.type)e.answer.forEach(t=>{for(let r in e.options)r===this.removeHtml(t)&&e.options[r].click()});else if("判断题"===e.type){let t="对";for(let r in e.answer[0].match(/(^|,)(正确|是|对|√|T|ri|right|true)(,|$)/)?t="对":e.answer[0].match(/(^|,)(错误|否|错|×|F|wr|wrong|false)(,|$)/)&&(t="错"),e.options)r===t&&e.options[r].click()}}})}extractOptions(e,t){let r={};return e.forEach(e=>{var n;let a=this.removeHtml((null==(n=e.querySelector(t))?void 0:n.innerHTML)||"");r[a]=e}),r}addQuestions(e){e.forEach(e=>{var t,r;let n=(null==e?void 0:e.querySelector(".subject_describe div,.smallStem_describe p")).__Ivue__._data.shadowDom.textContent,a=(null==(r=null==(t=null==e?void 0:e.querySelector(".subject_type span"))?void 0:t.textContent)?void 0:r.slice(1,4))||"",o=this.extractOptions(null==e?void 0:e.querySelectorAll(".label"),".node_detail");this.questions.push({element:e,type:a,title:n,options:o,answer:[],workType:"zhs",refer:this._window.location.href})})}}let tp=()=>{console.log("hookError");let e=N.setInterval,t=N.setTimeout;N.setInterval=function(...t){let r=Error("");return r.stack&&-1!==r.stack.indexOf("checkoutNotTrustScript")?-1:e.call(this,...t)},N.setTimeout=function(...e){let r=Error("");return r.stack&&-1!==r.stack.indexOf("checkoutNotTrustScript")?-1:t.call(this,...e)}},t$=async()=>{tp();let e=D();A(),e.addLog(`进入答题页面，开始准备答题`,"primary"),e.addLog(`正在解析题目, 请等待5s`,"warning"),new eK(["gateway/t/v1/student"],async()=>{await new th().init()})},tv=e.defineComponent({name:"Index",emits:["customEvent"],setup(t,{emit:r}){var n;let a=e.ref("310px"),o=e.ref(!1);null==(n=document.querySelector("a.experience:not([onclick])"))||n.click();let i=A(),s=D(),l=q(),u=window.location.href;"1"===i.menuIndex?a.value="630px":a.value="310px",e.watch(()=>i.menuIndex,e=>{"1"===e?a.value="630px":a.value="310px"},{deep:!0}),s.addLog("脚本加载成功，正在解析网页","primary"),s.addLog("请不要多个脚本同时使用，会有脚本冲突问题","warning"),s.addLog("如果脚本出现异常，请用谷歌、火狐等浏览器","warning");let c=[{keyword:"/mycourse/studentstudy",logic:tc},{keyword:"/mooc2/work/dowork",logic:td},{keyword:"/exam-ans/exam",logic:tf},{keyword:"/exam/preview",logic:tf},{keyword:"mycourse/stu?courseid",logic(){s.addLog("该页面无任务，请进入章节或答题页面使用","error")}},{keyword:"/stuExamWeb.html",logic:t$},];(e=>{for(let{keyword:t,logic:r}of c)if(e.includes(t)){r(),o.value=!0;return}o.value=!1})(u),r("customEvent",o.value);let f=[{label:"首页",icon:y,component:j,props:{"log-list":s.logList}},{label:"答题",icon:d,component:er,props:{"question-list":l.questionList}},{label:"设置",icon:U,component:J,props:{"global-config":i}},{label:"代码",icon:C,component:es},{label:"说明",icon:C,component:eg},];return(t,r)=>{let n=e.resolveComponent("el-tab-pane"),o=e.resolveComponent("el-tabs");return e.openBlock(),e.createElementBlock("div",{style:e.normalizeStyle({width:a.value}),class:"card_content"},[e.createVNode(o,{modelValue:e.unref(i).menuIndex,"onUpdate:modelValue":r[0]||(r[0]=t=>e.unref(i).menuIndex=t),class:"demo-tabs"},{default:e.withCtx(()=>[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(f,t=>e.createVNode(n,{key:t.label,label:t.label},{default:e.withCtx(()=>[t.component?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.component),e.normalizeProps(e.mergeProps({key:0},t.props)),null,16)):e.createCommentVNode("",!0)]),_:2},1032,["label"])),64)),]),_:1},8,["modelValue"]),],4)}}}),t0=R(tv,[["__scopeId","data-v-c0593cc2"]]),tm=e.defineComponent({name:"ZoomButtons",emits:["toggleZoom"],setup(t,{emit:r}){let n=e=>{r("toggleZoom",e)};return(t,r)=>{let a=e.resolveComponent("el-icon");return e.openBlock(),e.createElementBlock("div",{onMousedown:r[2]||(r[2]=e.withModifiers(()=>{},["stop"]))},[e.createVNode(a,{onClick:r[0]||(r[0]=e=>n(!0)),size:"small",style:{cursor:"pointer"}},{default:e.withCtx(()=>[e.createVNode(e.unref(m))]),_:1}),e.createVNode(a,{onClick:r[1]||(r[1]=e=>n(!1)),size:"small",style:{cursor:"pointer","margin-left":"8px"}},{default:e.withCtx(()=>[e.createVNode(e.unref(p))]),_:1}),],32)}}}),t_={class:"overlay"},tg={class:"title"},ty=e.defineComponent({name:"layout",setup(t){let r=e.ref(!1),n=A();e.watch(n,e=>{V("config",JSON.stringify(e))},{deep:!0});let a=e.ref(!1),o=e.ref(0),i=e.ref(0),s=e.ref({left:n.position.x,top:n.position.y}),l=e=>{a.value=!0,o.value=e.clientX-e.target.getBoundingClientRect().left,i.value=e.clientY-e.target.getBoundingClientRect().top,document.addEventListener("mousemove",u),document.addEventListener("mouseup",c)},u=e=>{if(!a.value)return;let t=e.clientX-o.value,r=e.clientY-i.value;s.value={left:`${t-11}px`,top:`${r-11}px`},n.position.x=t-11+"px",n.position.y=r-11+"px",t<0&&(s.value.left="0px",n.position.x="0px"),r<0&&(s.value.top="0px",n.position.y="0px"),t>window.innerWidth-334&&(s.value.left=`${window.innerWidth-334}px`,n.position.x=`${window.innerWidth-334}px`),r>window.innerHeight-35&&(s.value.top=`${window.innerHeight-35}px`,n.position.y=`${window.innerHeight-35}px`)},c=()=>{a.value=!1,document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",c)};return(t,o)=>{let i=e.resolveComponent("el-icon"),u=e.resolveComponent("el-tooltip"),c=e.resolveComponent("el-card");return e.withDirectives((e.openBlock(),e.createElementBlock("div",{style:e.normalizeStyle(s.value),class:"main-page"},[e.withDirectives(e.createElementVNode("div",t_,null,512),[[e.vShow,a.value]]),e.createVNode(c,{style:{border:"0"},"close-on-click-modal":!1,"lock-scroll":!1,modal:!1,"show-close":!1,"modal-class":"modal"},{header:e.withCtx(()=>[e.createElementVNode("div",{class:"card-header",onMousedown:l},[e.withDirectives(e.createElementVNode("div",tg,[e.createElementVNode("span",null,e.toDisplayString(e.unref(n).platformParams[e.unref(n).platformName].name),1),r.value&&!e.unref(n).isMinus?(e.openBlock(),e.createBlock(u,{key:0,teleported:"",effect:"dark",placement:"top-start",content:"<span>注意事项：<br/>请尽量使用新版，不要使用旧版。<br/></span>","raw-content":""},{default:e.withCtx(()=>[e.createVNode(i,{style:{"margin-left":"5px"},size:"small"},{default:e.withCtx(()=>[e.createVNode(e.unref(P))]),_:1}),]),_:1})):e.createCommentVNode("",!0),],512),[[e.vShow,!e.unref(n).isMinus]]),e.createVNode(tm,{onToggleZoom:o[0]||(o[0]=t=>e.unref(n).isMinus=t)}),],32),]),default:e.withCtx(()=>[e.withDirectives(e.createVNode(t0,{onCustomEvent:o[1]||(o[1]=e=>r.value=e)},null,512),[[e.vShow,!e.unref(n).isMinus]]),]),_:1}),],4)),[[e.vShow,r.value]])}}}),tb=R(ty,[["__scopeId","data-v-911a285c"]]),t2=e.defineComponent({name:"App",setup(t){let r=A(),n=window.location.href;return n.includes("chaoxing")?r.platformName="cx":n.includes("zhihuishu")&&(r.platformName="zhs"),(t,r)=>(e.openBlock(),e.createBlock(tb))}});(e=>{let t=GM_getResourceText(e),r=document.createElement("style");return r.innerText=t,document.head.append(r),t})("ElementPlus");let tS=N.location.href;if(tS.includes("zhihuishu.com")){let tU;tU=N.Function.prototype.call,N.Function.prototype.call=function(...e){var t,r;let n=tU.apply(this,e);if((null==(r=null==(t=e[0])?void 0:t.a)?void 0:r.version)==="2.5.0"){let a=e[1].exports.a.install;e[1].exports.a.install=function(...e){return e[0].mixin({mounted:function(){this.$el.__Ivue__=this}}),a.apply(this,e)}}return n}}let tw=setInterval(()=>{if("complete"===document.readyState){clearInterval(tw);let r=e.createApp(t2),n=t.createPinia();r.use(n),r.use(a),r.mount((()=>{let e=document.createElement("div");return document.body.appendChild(e),e})())}},100)}(Vue,Pinia,rxjs,md5,ElementPlus);
